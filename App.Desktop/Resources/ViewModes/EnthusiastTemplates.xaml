<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib"
                    xmlns:dashboard="clr-namespace:Lazarus.Desktop.Views.Dashboard">

    <!-- Datasets View - Enthusiast Mode -->
    <DataTemplate x:Key="EnthusiastDatasetsViewModelTemplate">
        <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header / Controls -->
            <DockPanel Grid.Row="0" Margin="12,12,12,8">
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Left">
                    <TextBlock Text="📚" FontSize="24" Margin="0,0,8,0" Foreground="{DynamicResource TextPrimaryBrush}"/>
                    <TextBlock Text="Datasets Library" Style="{DynamicResource HeadingLargeStyle}" Foreground="{DynamicResource TextPrimaryBrush}"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                    <Button Content="Upload" Style="{DynamicResource PrimaryButtonStyle}" Command="{Binding ImportDatasetCommand}" Margin="0,0,8,0"/>
                    <Button Content="New" Style="{DynamicResource SecondaryButtonStyle}" Command="{Binding CreateDatasetCommand}" Margin="0,0,8,0"/>
                    <Button Content="Refresh" Style="{DynamicResource SecondaryButtonStyle}" Command="{Binding RefreshDatasetsCommand}"/>
                </StackPanel>
            </DockPanel>

            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="3*"/>
                </Grid.ColumnDefinitions>

                <!-- Datasets with metadata and filtering -->
                <Border Background="{DynamicResource TertiaryDarkBrush}" 
                        BorderBrush="{DynamicResource BorderBrush}" 
                        BorderThickness="1"
                        CornerRadius="6"
                        Padding="12"
                        Margin="0,0,8,0">
                    <DockPanel>
                        <TextBox DockPanel.Dock="Top" 
                                 Background="{DynamicResource PrimaryDarkBrush}"
                                 Foreground="{DynamicResource TextPrimaryBrush}"
                                 BorderBrush="{DynamicResource BorderBrush}"
                                 BorderThickness="1"
                                 Padding="8,6"
                                 Margin="0,0,0,8"
                                 Tag="Search datasets..."/>
                        <ListView ItemsSource="{Binding Datasets}" 
                                  SelectedItem="{Binding SelectedDataset}" 
                                  Background="{DynamicResource PrimaryDarkBrush}" 
                                  Foreground="{DynamicResource TextPrimaryBrush}"
                                  BorderThickness="0">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}"/>
                                    <GridViewColumn Header="Type" DisplayMemberBinding="{Binding Type}"/>
                                    <GridViewColumn Header="Docs" DisplayMemberBinding="{Binding DocumentCount}"/>
                                    <GridViewColumn Header="Size" DisplayMemberBinding="{Binding SizeText}"/>
                                    <GridViewColumn Header="Status" DisplayMemberBinding="{Binding StatusText}"/>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </DockPanel>
                </Border>

                <!-- Detailed panel: preview + tools -->
                <Border Grid.Column="1" 
                        Background="{DynamicResource TertiaryDarkBrush}" 
                        BorderBrush="{DynamicResource BorderBrush}" 
                        BorderThickness="1"
                        CornerRadius="6"
                        Padding="12"
                        Margin="8,0,0,0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <TextBlock Text="Dataset Details" 
                                   Style="{DynamicResource HeadingSmallStyle}" 
                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                   Margin="0,0,0,8"/>
                        <ScrollViewer Grid.Row="1">
                            <StackPanel>
                                <TextBlock Text="{Binding SelectedDataset.Name}" 
                                           Style="{DynamicResource HeadingMediumStyle}"
                                           Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <TextBlock Text="{Binding SelectedDataset.Description}" 
                                           TextWrapping="Wrap" 
                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                           Margin="0,4,0,8"/>
                                <WrapPanel>
                                    <TextBlock Text="Type:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                    <TextBlock Text="{Binding SelectedDataset.Type}" Foreground="{DynamicResource TextPrimaryBrush}" Margin="4,0,0,0"/>
                                    <TextBlock Text="   Size:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" Margin="12,0,0,0"/>
                                    <TextBlock Text="{Binding SelectedDataset.SizeText}" Foreground="{DynamicResource TextPrimaryBrush}" Margin="4,0,0,0"/>
                                </WrapPanel>
                                <Separator Margin="0,8,0,8"/>
                                <TextBlock Text="Quick Tools" 
                                           Style="{DynamicResource HeadingSmallStyle}"
                                           Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <WrapPanel Margin="0,6,0,0">
                                    <Button Content="Convert Format" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,6,6"/>
                                    <Button Content="Validate" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,6,6"/>
                                    <Button Content="Split Train/Val/Test" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,6,6"/>
                                    <Button Content="Analyze" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,6,6"/>
                                </WrapPanel>
                            </StackPanel>
                        </ScrollViewer>
                        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                            <Button Content="Prepare for Training" Style="{DynamicResource PrimaryButtonStyle}"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </DataTemplate>
    
    <!-- Compatibility aliases in case runtime type name differs -->
    <DataTemplate x:Key="EnthusiastDatasetsViewTemplate">
        <ContentPresenter ContentTemplate="{StaticResource EnthusiastDatasetsViewModelTemplate}"/>
    </DataTemplate>
    <DataTemplate x:Key="EnthusiastDatasetViewModelTemplate">
        <ContentPresenter ContentTemplate="{StaticResource EnthusiastDatasetsViewModelTemplate}"/>
    </DataTemplate>

    <!-- Generic keys so selector fallback (viewModelTypeTemplate) resolves -->
    <DataTemplate x:Key="DatasetsViewModelTemplate">
        <ContentPresenter ContentTemplate="{StaticResource EnthusiastDatasetsViewModelTemplate}"/>
    </DataTemplate>
    <DataTemplate x:Key="DatasetViewModelTemplate">
        <ContentPresenter ContentTemplate="{StaticResource EnthusiastDatasetsViewModelTemplate}"/>
    </DataTemplate>
    
    <!-- ENTHUSIAST TIER: "Informed Professional Density" -->
    
    <!-- Jobs View Template - Detailed job monitoring + queue management -->
    <DataTemplate x:Key="EnthusiastJobsViewModelTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="400" MinWidth="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300" MinWidth="200"/>
            </Grid.ColumnDefinitions>
            
            <!-- Left Panel: Job Queue Management -->
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="8,0,0,8" Padding="16">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                        <TextBlock Text="📋" FontSize="20" Margin="0,0,8,0" Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <TextBlock Text="Job Queue" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextPrimaryBrush}"/>
                    </StackPanel>
                    
                    <!-- Queue Controls -->
                    <Grid Margin="0,0,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Button Grid.Column="0" Content="+ New Job" 
                                Style="{DynamicResource PrimaryButtonStyle}"
                                Margin="0,0,8,0"/>
                        <Button Grid.Column="1" Content="Clear Completed" 
                                Style="{DynamicResource SecondaryButtonStyle}"/>
                    </Grid>
                    
                    <!-- Queued Jobs -->
                    <TextBlock Text="Queued (🕰️ Waiting)" 
                               Style="{DynamicResource BodyTextBoldStyle}"
                               Foreground="{DynamicResource TextPrimaryBrush}"
                               Margin="0,0,0,8"/>
                    <ScrollViewer MaxHeight="200" Margin="0,0,0,16">
                        <ItemsControl ItemsSource="{Binding QueuedJobs}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                            CornerRadius="6" Padding="12" Margin="0,0,0,8"
                                            BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <!-- Dataset Header -->
                                            <Grid Grid.Row="0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <TextBlock Grid.Column="0" Text="{Binding TypeIcon}" 
                                                           FontSize="14" Margin="0,0,8,0" VerticalAlignment="Top"/>
                                                
                                                <StackPanel Grid.Column="1">
                                                    <TextBlock Text="{Binding Name}" 
                                                               Style="{DynamicResource BodyTextBoldStyle}"/>
                                                    <TextBlock Text="{Binding Description}" 
                                                               Style="{DynamicResource BodyTextSmallStyle}"
                                                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                </StackPanel>
                                                
                                                <TextBlock Grid.Column="2" Text="{Binding StatusText}" 
                                                           Style="{DynamicResource BodyTextSmallStyle}"
                                                           Foreground="{DynamicResource AccentRedBrush}"/>
                                            </Grid>
                                            
                                            <!-- Dataset Metrics -->
                                            <Grid Grid.Row="1" Margin="0,8,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="Documents" 
                                                               Style="{DynamicResource BodyTextSmallStyle}"
                                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="{Binding DocumentCount}" 
                                                               Style="{DynamicResource BodyTextBoldStyle}"/>
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Column="1">
                                                    <TextBlock Text="Size" 
                                                               Style="{DynamicResource BodyTextSmallStyle}"
                                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="{Binding SizeText}" 
                                                               Style="{DynamicResource BodyTextBoldStyle}"/>
                                                </StackPanel>
                                            </Grid>
                                            
                                            <!-- Progress for Processing -->
                                            <ProgressBar Grid.Row="2" 
                                                         Visibility="{Binding IsProcessing, Converter={StaticResource BoolToVisibility}}"
                                                         IsIndeterminate="True" Height="4" Margin="0,8,0,0"
                                                         Background="{DynamicResource PrimaryDarkBrush}"
                                                         Foreground="{DynamicResource AccentRedBrush}"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    
                    <!-- Quick Stats -->
                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="6" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Datasets" 
                                           Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="{Binding Datasets.Count}" 
                                           Style="{DynamicResource HeadingSmallStyle}"
                                           Foreground="{DynamicResource AccentRedBrush}"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1">
                                <TextBlock Text="Sources" 
                                           Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="{Binding RagSources.Count}" 
                                           Style="{DynamicResource HeadingSmallStyle}"
                                           Foreground="{DynamicResource AccentRedBrush}"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </StackPanel>
            </Border>
            
            <!-- Center Panel: RAG Sources & Configuration -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                <ScrollViewer>
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="📂" FontSize="20" Margin="0,0,8,0"/>
                            <TextBlock Text="Data Sources" Style="{DynamicResource HeadingMediumStyle}"/>
                        </StackPanel>
                        
                        <!-- Source Management -->
                        <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                CornerRadius="8" Padding="16" Margin="0,0,0,16">
                            <StackPanel>
                                <!-- Add Source Controls -->
                                <Grid Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBlock Grid.Column="0" Text="Manage Document Sources" 
                                               Style="{DynamicResource BodyTextBoldStyle}"/>
                                    <Button Grid.Column="1" Content="+ Folder" 
                                            Command="{Binding AddFolderSourceCommand}"
                                            Style="{DynamicResource SecondaryButtonStyle}"
                                            Margin="0,0,8,0"/>
                                    <Button Grid.Column="2" Content="+ Files" 
                                            Command="{Binding AddFileSourceCommand}"
                                            Style="{DynamicResource SecondaryButtonStyle}"/>
                                </Grid>
                                
                                <!-- Source List -->
                                <ItemsControl ItemsSource="{Binding RagSources}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                                    CornerRadius="6" Padding="12" Margin="0,0,0,8">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    
                                                    <TextBlock Grid.Column="0" Text="{Binding TypeIcon}" 
                                                               FontSize="16" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                                    
                                                    <StackPanel Grid.Column="1">
                                                        <TextBlock Text="{Binding Name}" 
                                                                   Style="{DynamicResource BodyTextBoldStyle}"/>
                                                        <TextBlock Text="{Binding Path}" 
                                                                   Style="{DynamicResource BodyTextSmallStyle}"
                                                                   Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                        <TextBlock Text="{Binding FileCount, StringFormat='{}{0} files'}" 
                                                                   Style="{DynamicResource BodyTextSmallStyle}"
                                                                   Foreground="{DynamicResource TextMutedBrush}"/>
                                                    </StackPanel>
                                                    
                                                    <Button Grid.Column="2" Content="🔄" 
                                                            Style="{DynamicResource MinimalButtonStyle}"
                                                            ToolTip="Scan Source" Margin="0,0,4,0"/>
                                                    <Button Grid.Column="3" Content="❌" 
                                                            Style="{DynamicResource MinimalButtonStyle}"
                                                            ToolTip="Remove Source"/>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                                
                                <!-- Empty Sources State -->
                                <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                        CornerRadius="6" Padding="24"
                                        Visibility="{Binding HasRagSources, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="📂" FontSize="32" HorizontalAlignment="Center" 
                                                   Foreground="{DynamicResource TextMutedBrush}" Margin="0,0,0,8"/>
                                        <TextBlock Text="No Sources Added" 
                                                   Style="{DynamicResource HeadingSmallStyle}"
                                                   HorizontalAlignment="Center" Margin="0,0,0,4"/>
                                        <TextBlock Text="Add folders or files to create searchable sources" 
                                                   Style="{DynamicResource BodyTextStyle}"
                                                   Foreground="{DynamicResource TextSecondaryBrush}"
                                                   HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>
                        
                        <!-- Processing Queue -->
                        <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                CornerRadius="8" Padding="16"
                                Visibility="{Binding HasProcessingItems, Converter={StaticResource BoolToVisibility}}">
                            <StackPanel>
                                <TextBlock Text="⏳ Processing Queue" 
                                           Style="{DynamicResource BodyTextBoldStyle}"
                                           Margin="0,0,0,8"/>
                                <TextBlock Text="Indexing documents for search..." 
                                           Style="{DynamicResource BodyTextStyle}"
                                           Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <ProgressBar IsIndeterminate="True" Height="6" 
                                             Background="{DynamicResource TertiaryDarkBrush}"
                                             Foreground="{DynamicResource AccentRedBrush}" Margin="0,8,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Border>
            
            <!-- Right Panel: Index Status & Configuration -->
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="0,8,8,0" Padding="16">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                        <TextBlock Text="🧠" FontSize="20" Margin="0,0,8,0"/>
                        <TextBlock Text="Indexes" Style="{DynamicResource HeadingMediumStyle}"/>
                    </StackPanel>
                    
                    <!-- Embedding Configuration -->
                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="6" Padding="12" Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="Embedding Model" 
                                       Style="{DynamicResource BodyTextBoldStyle}"
                                       Margin="0,0,0,8"/>
                            <ComboBox SelectedValue="sentence-transformers/all-MiniLM-L6-v2"
                                      Style="{DynamicResource CompactComboBoxStyle}">
                                <ComboBoxItem>sentence-transformers/all-MiniLM-L6-v2</ComboBoxItem>
                                <ComboBoxItem>text-embedding-ada-002</ComboBoxItem>
                                <ComboBoxItem>intfloat/e5-base-v2</ComboBoxItem>
                            </ComboBox>
                        </StackPanel>
                    </Border>
                    
                    <!-- Active Indexes -->
                    <TextBlock Text="Active Indexes" 
                               Style="{DynamicResource BodyTextBoldStyle}"
                               Margin="0,0,0,8"/>
                    <ScrollViewer MaxHeight="200" Margin="0,0,0,16">
                        <ItemsControl ItemsSource="{Binding EmbeddingIndexes}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                            CornerRadius="6" Padding="12" Margin="0,0,0,6">
                                        <StackPanel>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <TextBlock Grid.Column="0" Text="{Binding Name}" 
                                                           Style="{DynamicResource BodyTextBoldStyle}"/>
                                                <TextBlock Grid.Column="1" Text="{Binding StatusText}" 
                                                           Style="{DynamicResource BodyTextSmallStyle}"
                                                           Foreground="{DynamicResource SuccessBrush}"/>
                                            </Grid>
                                            
                                            <Grid Margin="0,4,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="Vectors" 
                                                               Style="{DynamicResource BodyTextSmallStyle}"
                                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="{Binding VectorCount}" 
                                                               Style="{DynamicResource BodyTextSmallStyle}"/>
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Column="1">
                                                    <TextBlock Text="Size" 
                                                               Style="{DynamicResource BodyTextSmallStyle}"
                                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="{Binding SizeText}" 
                                                               Style="{DynamicResource BodyTextSmallStyle}"/>
                                                </StackPanel>
                                            </Grid>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    
                    <!-- Index Actions -->
                    <StackPanel>
                        <Button Content="+ Create Index" 
                                Command="{Binding CreateEmbeddingIndexCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Margin="0,0,0,8"/>
                        <Button Content="Rebuild All" 
                                Command="{Binding RebuildIndexesCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"/>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- Model Selection Template - Professional Analysis -->
    <DataTemplate x:Key="ModelSelectionTemplate">
        <Border Margin="0,6" Padding="14" 
                Background="{DynamicResource SecondaryDarkBrush}"
                CornerRadius="6" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Model Info -->
                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                    <Grid Margin="0,0,0,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="{Binding Name}" 
                                   Style="{DynamicResource HeadingSmallStyle}"
                                   Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <Border Grid.Column="1" Background="{DynamicResource AccentPurpleBrush}"
                                Padding="6,2" CornerRadius="10">
                            <TextBlock Text="{Binding ModelType}" 
                                       Style="{DynamicResource CaptionTextStyle}"
                                       Foreground="{DynamicResource TextPrimaryBrush}" FontSize="9"/>
                        </Border>
                    </Grid>
                    
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                        <TextBlock Text="Parameters: " 
                                   Style="{DynamicResource CaptionTextStyle}"
                                   Foreground="{DynamicResource TextMutedBrush}"/>
                        <TextBlock Text="{Binding ParameterCount}" 
                                   Style="{DynamicResource CaptionTextStyle}"
                                   Foreground="{DynamicResource AccentRedBrush}" FontWeight="SemiBold"/>
                        <TextBlock Text=" • Context: " 
                                   Style="{DynamicResource CaptionTextStyle}"
                                   Foreground="{DynamicResource TextMutedBrush}" Margin="8,0,0,0"/>
                        <TextBlock Text="{Binding ContextLength}" 
                                   Style="{DynamicResource CaptionTextStyle}"
                                   Foreground="{DynamicResource AccentRedBrush}" FontWeight="SemiBold"/>
                    </StackPanel>
                    
                    <TextBlock Text="{Binding Capabilities}" 
                               Style="{DynamicResource CaptionTextStyle}"
                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                </StackPanel>
                
                <!-- Performance Metrics -->
                <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="12,0">
                    <TextBlock Text="Performance" 
                               Style="{DynamicResource CaptionTextStyle}"
                               FontWeight="SemiBold" HorizontalAlignment="Center"
                               Foreground="{DynamicResource TextMutedBrush}" FontSize="10"/>
                    <ProgressBar Value="{Binding PerformanceScore}" Maximum="100" 
                                 Width="60" Height="4" Margin="0,4,0,2"
                                 Background="{DynamicResource TertiaryDarkBrush}"
                                 Foreground="{DynamicResource AccentGreenBrush}"/>
                    <TextBlock Text="{Binding PerformanceScore, StringFormat={}{0:F0}%}" 
                               Style="{DynamicResource CodeTextStyle}"
                               HorizontalAlignment="Center" FontSize="10"
                               Foreground="{DynamicResource AccentGreenBrush}"/>
                </StackPanel>
                
                <!-- Action Button -->
                <Button Grid.Column="2" Content="Select" 
                        Style="{DynamicResource PrimaryButtonStyle}"
                        Padding="14,6" VerticalAlignment="Center"
                        Command="{Binding SelectCommand}"/>
            </Grid>
        </Border>
    </DataTemplate>
    
    <!-- Parameter Control Template - Professional Controls -->
    <DataTemplate x:Key="ParameterControlTemplate">
        <GroupBox Header="{Binding Name}" Style="{DynamicResource ParameterGroupStyle}"
                  Margin="0,6">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Control Area -->
                <StackPanel Grid.Column="0" Margin="0,0,12,0">
                    <TextBlock Text="{Binding Description}" 
                               Style="{DynamicResource CaptionTextStyle}"
                               Foreground="{DynamicResource TextSecondaryBrush}"
                               TextWrapping="Wrap" Margin="0,0,0,8"/>
                    
                    <Slider Value="{Binding Value}" 
                            Minimum="{Binding Minimum}" 
                            Maximum="{Binding Maximum}"
                            TickFrequency="{Binding TickFrequency}"
                            TickPlacement="BottomRight"
                            IsSnapToTickEnabled="True"/>
                    
                    <!-- Range Labels -->
                    <Grid Margin="0,4,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="{Binding Minimum, StringFormat=F2}" 
                                   Style="{DynamicResource CodeTextStyle}" FontSize="9"
                                   Foreground="{DynamicResource TextMutedBrush}"/>
                        <TextBlock Grid.Column="1" Text="{Binding RecommendedValue, StringFormat={}Rec: {0:F2}}" 
                                   Style="{DynamicResource CodeTextStyle}" FontSize="9"
                                   HorizontalAlignment="Center"
                                   Foreground="{DynamicResource AccentPurpleBrush}"/>
                        <TextBlock Grid.Column="2" Text="{Binding Maximum, StringFormat=F2}" 
                                   Style="{DynamicResource CodeTextStyle}" FontSize="9"
                                   HorizontalAlignment="Right"
                                   Foreground="{DynamicResource TextMutedBrush}"/>
                    </Grid>
                </StackPanel>
                
                <!-- Value Display -->
                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                    <TextBox Text="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                             Style="{DynamicResource DarkTextBoxStyle}"
                             Width="80" FontFamily="Consolas"
                             HorizontalContentAlignment="Center"/>
                    <TextBlock Text="Current" 
                               Style="{DynamicResource CaptionTextStyle}"
                               HorizontalAlignment="Center" FontSize="9"
                               Foreground="{DynamicResource TextMutedBrush}" Margin="0,2,0,0"/>
                </StackPanel>
            </Grid>
        </GroupBox>
    </DataTemplate>
    
    <!-- Status Display Template - Professional Metrics -->
    <DataTemplate x:Key="StatusDisplayTemplate">
        <Border Padding="12" 
                Background="{DynamicResource SecondaryDarkBrush}"
                CornerRadius="4" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Status Indicator -->
                <Border Grid.Column="0" Width="24" Height="24" 
                        Background="{DynamicResource AccentGreenBrush}"
                        CornerRadius="12" Margin="0,0,12,0" VerticalAlignment="Center">
                    <TextBlock Text="{Binding StatusIcon}" FontSize="12" 
                               HorizontalAlignment="Center" VerticalAlignment="Center"
                               Foreground="{DynamicResource TextPrimaryBrush}"/>
                </Border>
                
                <!-- Status Info -->
                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                    <TextBlock Text="{Binding Status}" 
                               Style="{DynamicResource BodyTextStyle}"
                               FontWeight="SemiBold" 
                               Foreground="{DynamicResource TextPrimaryBrush}"/>
                    <TextBlock Text="{Binding Details}" 
                               Style="{DynamicResource CaptionTextStyle}"
                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                    
                    <!-- Progress with Percentage -->
                    <Grid Margin="0,4,0,0" Visibility="{Binding ShowProgress, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <ProgressBar Value="{Binding Progress}" Maximum="100" 
                                     Height="6" Background="{DynamicResource TertiaryDarkBrush}"
                                     Foreground="{DynamicResource AccentPurpleBrush}"/>
                        <TextBlock Text="{Binding Progress, StringFormat={}{0:F1}%}" 
                                   Style="{DynamicResource CaptionTextStyle}"
                                   HorizontalAlignment="Center" VerticalAlignment="Center"
                                   FontSize="9" Foreground="{DynamicResource TextPrimaryBrush}"/>
                    </Grid>
                </StackPanel>
                
                <!-- Timestamp -->
                <TextBlock Grid.Column="2" Text="{Binding Timestamp, StringFormat=HH:mm:ss}" 
                           Style="{DynamicResource CodeTextStyle}"
                           VerticalAlignment="Center" FontSize="10"
                           Foreground="{DynamicResource TextMutedBrush}"/>
            </Grid>
        </Border>
    </DataTemplate>
    
    <!-- Error Display Template - Professional Troubleshooting -->
    <DataTemplate x:Key="ErrorDisplayTemplate">
        <Border Padding="12" 
                Background="{DynamicResource ErrorBackgroundBrush}"
                CornerRadius="4" BorderBrush="{DynamicResource ErrorBrush}" BorderThickness="1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Error Header -->
                <Grid Grid.Row="0" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Grid.Column="0" Text="⚠" FontSize="16" 
                               Foreground="{DynamicResource ErrorBrush}"
                               VerticalAlignment="Center" Margin="0,0,8,0"/>
                    
                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="{Binding ErrorType}" 
                                   Style="{DynamicResource BodyTextStyle}"
                                   FontWeight="SemiBold" 
                                   Foreground="{DynamicResource ErrorBrush}"/>
                        <TextBlock Text="{Binding Component}" 
                                   Style="{DynamicResource CaptionTextStyle}"
                                   Foreground="{DynamicResource TextMutedBrush}"/>
                    </StackPanel>
                    
                    <TextBlock Grid.Column="2" Text="{Binding ErrorCode}" 
                               Style="{DynamicResource CodeTextStyle}"
                               Foreground="{DynamicResource TextMutedBrush}" FontSize="10"
                               VerticalAlignment="Center"/>
                </Grid>
                
                <!-- Error Details -->
                <TextBlock Grid.Row="1" Text="{Binding Message}" 
                           Style="{DynamicResource CaptionTextStyle}"
                           Foreground="{DynamicResource TextSecondaryBrush}"
                           TextWrapping="Wrap" Margin="0,0,0,8"/>
                
                <!-- Actions -->
                <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="Retry" 
                            Style="{DynamicResource PrimaryButtonStyle}"
                            Padding="10,4" Margin="0,0,6,0"
                            Command="{Binding RetryCommand}"/>
                    <Button Content="Details" 
                            Style="{DynamicResource GhostButtonStyle}"
                            Padding="10,4"
                            Command="{Binding ShowDetailsCommand}"/>
                </StackPanel>
            </Grid>
        </Border>
    </DataTemplate>
    
    <!-- ENHANCED ENTHUSIAST ChatMessageTemplate - Collapsible Panels + Contextual Guidance -->
    <DataTemplate x:Key="ChatMessageTemplate">
        <Border Margin="10,6" 
                Padding="18" 
                MaxWidth="650"
                Background="{DynamicResource SecondaryDarkBrush}"
                CornerRadius="12"
                BorderBrush="{DynamicResource BorderBrush}" 
                BorderThickness="1">
            
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Professional Message Header -->
                <Grid Grid.Row="0" Margin="0,0,0,12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Enhanced Role Badge with Status -->
                    <Border Grid.Column="0"
                            Background="{DynamicResource AccentRedBrush}"
                            Padding="10,5"
                            CornerRadius="12"
                            Margin="0,0,12,0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{Binding Role}" 
                                       Style="{DynamicResource CaptionTextStyle}"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimaryBrush}"
                                       VerticalAlignment="Center"/>
                            <TextBlock Text="●" 
                                       Foreground="{DynamicResource SuccessBrush}"
                                       FontSize="8"
                                       VerticalAlignment="Center"
                                       Margin="6,0,0,0"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Context Actions -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="0,0,8,0">
                        <Button Content="📋" 
                                ToolTip="Copy message"
                                Style="{DynamicResource GhostButtonStyle}"
                                Padding="6"
                                FontSize="12"
                                Command="{Binding CopyCommand}"/>
                        <Button Content="🔄" 
                                ToolTip="Regenerate response"
                                Style="{DynamicResource GhostButtonStyle}"
                                Padding="6"
                                FontSize="12"
                                Command="{Binding RegenerateCommand}"/>
                    </StackPanel>
                    
                    <!-- Timestamp with Status -->
                    <TextBlock Grid.Column="3" 
                               Text="{Binding Timestamp, StringFormat=HH:mm:ss}" 
                               Style="{DynamicResource CodeTextStyle}"
                               Foreground="{DynamicResource TextMutedBrush}" 
                               FontSize="11"
                               VerticalAlignment="Center"/>
                </Grid>
                
                <!-- Message Content with Enhanced Readability -->
                <ScrollViewer Grid.Row="1" 
                              MaxHeight="300"
                              VerticalScrollBarVisibility="Auto"
                              Margin="0,0,0,8">
                    <TextBlock Text="{Binding Text}" 
                               Style="{DynamicResource BodyTextStyle}"
                               Foreground="{DynamicResource TextPrimaryBrush}"
                               TextWrapping="Wrap"
                               LineHeight="24"
                               FontSize="13"/>
                </ScrollViewer>
                
                <!-- Collapsible Metadata Panel -->
                <Expander Grid.Row="2" 
                          Header="Message Details" 
                          IsExpanded="False"
                          Margin="0,4,0,0">
                    <Expander.HeaderTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="{Binding}" 
                                           Style="{DynamicResource CaptionTextStyle}"
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text=" (Click to expand)" 
                                           Style="{DynamicResource CaptionTextStyle}"
                                           Foreground="{DynamicResource TextMutedBrush}"
                                           FontStyle="Italic"/>
                            </StackPanel>
                        </DataTemplate>
                    </Expander.HeaderTemplate>
                    
                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                            Padding="12" 
                            CornerRadius="6"
                            Margin="0,4,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Message Metadata -->
                            <StackPanel Grid.Column="0" Margin="0,0,8,0">
                                <TextBlock Text="Message Info" 
                                           Style="{DynamicResource CaptionTextStyle}"
                                           FontWeight="SemiBold"
                                           Margin="0,0,0,4"/>
                                <TextBlock Text="{Binding Text.Length, StringFormat={}Length: {0} chars}" 
                                           Style="{DynamicResource CodeTextStyle}"
                                           FontSize="11"
                                           Margin="0,0,0,2"/>
                                <TextBlock Text="{Binding WordCount, StringFormat={}Words: {0}}" 
                                           Style="{DynamicResource CodeTextStyle}"
                                           FontSize="11"
                                           Margin="0,0,0,2"/>
                            </StackPanel>
                            
                            <!-- Conversation Context -->
                            <StackPanel Grid.Column="1">
                                <TextBlock Text="Context" 
                                           Style="{DynamicResource CaptionTextStyle}"
                                           FontWeight="SemiBold"
                                           Margin="0,0,0,4"/>
                                <TextBlock Text="{Binding MessageIndex, StringFormat={}Message #{0}}" 
                                           Style="{DynamicResource CodeTextStyle}"
                                           FontSize="11"
                                           Margin="0,0,0,2"/>
                                <TextBlock Text="{Binding ConversationLength, StringFormat={}Total: {0} messages}" 
                                           Style="{DynamicResource CodeTextStyle}"
                                           FontSize="11"
                                           Margin="0,0,0,2"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Expander>
                
                <!-- Contextual Guidance Footer -->
                <Border Grid.Row="3" 
                        Background="{DynamicResource AccentRedBrush}"
                        Padding="8,4"
                        CornerRadius="4"
                        Margin="0,6,0,0"
                        Opacity="0.8">
                    <TextBlock Text="💡 Tip: Use the details panel to track conversation flow and message statistics" 
                               Style="{DynamicResource CaptionTextStyle}"
                               Foreground="{DynamicResource TextPrimaryBrush}"
                               FontSize="10"
                               TextWrapping="Wrap"/>
                </Border>
            </Grid>
        </Border>
    </DataTemplate>
    
    <!-- ENTHUSIAST LoRACardTemplate - polished, with compact metadata and weight -->
    <DataTemplate x:Key="LoRACardTemplate">
        <Border Margin="6"
                MinWidth="300" MaxWidth="360"
                Padding="16"
                Background="{DynamicResource SecondaryDarkBrush}"
                CornerRadius="10"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="1">
            
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- LoRA Name and Category -->
                <Grid Grid.Row="0" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" 
                               Text="{Binding Name}"
                               Style="{DynamicResource HeadingSmallStyle}"
                               Foreground="{DynamicResource TextPrimaryBrush}"/>
                    <Border Grid.Column="1" 
                            Background="{DynamicResource AccentPurpleBrush}"
                            Padding="6,2" 
                            CornerRadius="10">
                        <TextBlock Text="{Binding Category}" 
                                   Style="{DynamicResource CaptionTextStyle}"
                                   Foreground="{DynamicResource AccentTextBrush}"/>
                    </Border>
                </Grid>
                
                <!-- Description -->
                <TextBlock Grid.Row="1" 
                           Text="{Binding Description}"
                           Style="{DynamicResource BodyTextStyle}"
                           Foreground="{DynamicResource TextSecondaryBrush}"
                           TextWrapping="Wrap"
                           MaxHeight="50"
                           Margin="0,0,0,8"/>
                           
                <!-- Metadata Row -->
                <Grid Grid.Row="2" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" 
                               Text="{Binding BaseModel}" 
                               Style="{DynamicResource CaptionTextStyle}"
                               Foreground="{DynamicResource TextMutedBrush}"/>
                    <TextBlock Grid.Column="1" 
                               Text="{Binding FileSize, StringFormat={}{0:F1} MB}" 
                               Style="{DynamicResource CaptionTextStyle}"
                               Foreground="{DynamicResource TextMutedBrush}"/>
                </Grid>
                
                <!-- Weight Control Row -->
                <Grid Grid.Row="3" Margin="0,6,0,12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" 
                               Text="Weight:" 
                               Style="{DynamicResource CaptionTextStyle}"
                               VerticalAlignment="Center"
                               Margin="0,0,8,0"/>
                    <Slider Grid.Column="1" 
                            Minimum="0.0" 
                            Maximum="2.0" 
                            Value="{Binding RecommendedWeight}" 
                            TickFrequency="0.1"
                            IsSnapToTickEnabled="True"/>
                    <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="4" Padding="6,2">
                        <TextBlock Text="{Binding RecommendedWeight, StringFormat={}{0:F1}}" Style="{DynamicResource CaptionTextStyle}"/>
                    </Border>
                </Grid>
                
                <!-- Apply Button -->
                <Button Grid.Row="4" 
                        Content="Apply"
                        Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.ApplyLoRACommand}"
                        CommandParameter="{Binding}"
                        Style="{DynamicResource PrimaryButtonStyle}"
                        HorizontalAlignment="Stretch"/>
            </Grid>
        </Border>
    </DataTemplate>

    <!-- ControlNet Card Template (scoped for Enthusiast dictionary) -->
    <DataTemplate x:Key="ControlNetCardTemplate">
        <Border MinWidth="260"
                MaxWidth="320"
                Margin="0,0,12,12"
                Padding="14"
                Style="{StaticResource DarkCardStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Grid Grid.Row="0" Margin="0,0,0,6">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="{Binding Name}" Style="{DynamicResource HeadingSmallStyle}"/>
                    <Border Grid.Column="1" Background="{DynamicResource AccentRedBrush}" CornerRadius="8" Padding="6,2">
                        <TextBlock Text="{Binding Type}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource ButtonTextBrush}"/>
                    </Border>
                </Grid>

                <TextBlock Grid.Row="1" Text="{Binding Description}" Style="{DynamicResource BodyTextStyle}" TextWrapping="Wrap" MaxHeight="48" Margin="0,0,0,8"/>

                <Grid Grid.Row="2" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="Weight" Style="{DynamicResource CaptionTextStyle}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <Slider Grid.Column="1" Minimum="0" Maximum="2" Value="{Binding Weight}"/>
                    <TextBlock Grid.Column="2" Text="{Binding DefaultWeight, StringFormat=F1}" Style="{DynamicResource CaptionTextStyle}"/>
                </Grid>

                <Button Grid.Row="3" Content="Apply"
                        Command="{Binding DataContext.ApplyControlNetCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                        CommandParameter="{Binding}">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource PrimaryButtonStyle}">
                            <Setter Property="Content" Value="Apply"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsLoaded}" Value="True">
                                    <Setter Property="Content" Value="Applied"/>
                                    <Setter Property="Background" Value="{DynamicResource SuccessBrush}"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </Grid>
        </Border>
    </DataTemplate>

    <!-- ENTHUSIAST ControlNets ViewModel template -->
    <DataTemplate x:Key="EnthusiastControlNetsViewModelTemplate">
        <Grid Background="{DynamicResource PrimaryDarkBrush}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" Style="{StaticResource DarkBorderStyle}" Margin="16,16,8,16">
                <StackPanel>
                    <TextBlock Text="ControlNet Models" Style="{DynamicResource HeadingMediumStyle}"/>
                    <StackPanel Orientation="Horizontal" Margin="0,8,0,12">
                        <ComboBox ItemsSource="{Binding PreprocessorTypes}" SelectedItem="{Binding PreprocessorType}" Style="{DynamicResource DarkComboBoxStyle}" MinWidth="160"/>
                        <TextBlock Text="·" Margin="8,0" VerticalAlignment="Center"/>
                        <TextBlock Text="Image:" Style="{DynamicResource CaptionTextStyle}" VerticalAlignment="Center"/>
                        <TextBox Text="{Binding InputImagePath}" Style="{DynamicResource DarkTextBoxStyle}" IsReadOnly="True" Width="200" Margin="6,0,0,0"/>
                        <Button Content="Browse" Command="{Binding SelectInputImageCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="6,0,0,0"/>
                    </StackPanel>
                    <ScrollViewer Height="Auto">
                        <ItemsControl ItemsSource="{Binding AvailableControlNets}" ItemTemplate="{StaticResource ControlNetCardTemplate}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                        </ItemsControl>
                    </ScrollViewer>
                </StackPanel>
            </Border>

            <Border Grid.Column="1" Style="{StaticResource DarkBorderStyle}" Margin="8,16,16,16">
                <ScrollViewer>
                    <ItemsControl ItemsSource="{Binding AppliedControlNets}"/>
                </ScrollViewer>
            </Border>
        </Grid>
    </DataTemplate>

    <!-- Chat Status Template - Professional Context -->
    <DataTemplate x:Key="ChatStatusTemplate">
        <Border Padding="32" 
                Background="{DynamicResource PrimaryDarkBrush}"
                CornerRadius="8"
                BorderBrush="{DynamicResource AccentPurpleBrush}"
                BorderThickness="1">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" MaxWidth="600">
                <TextBlock Text="⚡ Power Up Your AI Workspace"
                           Style="{DynamicResource HeadingSmallStyle}"
                           FontSize="22" FontWeight="Bold"
                           HorizontalAlignment="Center"
                           Foreground="{DynamicResource AccentPurpleBrush}"
                           Margin="0,0,0,16"/>
                           
                <TextBlock Text="Select a foundation model to begin advanced AI operations. Choose from GGUF, SafeTensors, or connect to remote instances."
                           Style="{DynamicResource BodyTextStyle}"
                           FontSize="14" TextWrapping="Wrap"
                           HorizontalAlignment="Center"
                           TextAlignment="Center"
                           Foreground="{DynamicResource TextSecondaryBrush}"
                           Margin="0,0,0,24"/>
                           
                <!-- Professional Action Grid -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Local Model Setup -->
                    <Border Grid.Column="0" 
                            Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="6" 
                            Padding="20"
                            Margin="0,0,8,0">
                        <StackPanel>
                            <TextBlock Text="🔥 Local Models" 
                                       FontSize="16" FontWeight="SemiBold"
                                       Foreground="{DynamicResource AccentRedBrush}"
                                       HorizontalAlignment="Center"
                                       Margin="0,0,0,8"/>
                            <TextBlock Text="Load GGUF/SafeTensor models from your collection"
                                       Style="{DynamicResource CaptionTextStyle}"
                                       TextAlignment="Center"
                                       TextWrapping="Wrap"
                                       Margin="0,0,0,12"/>
                            <Border Background="{DynamicResource AccentRedBrush}" 
                                    CornerRadius="4">
                                <Button Content="Browse Models" 
                                        Background="Transparent"
                                        Foreground="White"
                                        BorderThickness="0"
                                        Padding="16,8"/>
                            </Border>
                        </StackPanel>
                    </Border>
                    
                    <!-- Remote Connection -->
                    <Border Grid.Column="1" 
                            Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="6" 
                            Padding="20"
                            Margin="8,0,0,0">
                        <StackPanel>
                            <TextBlock Text="🌐 Remote API" 
                                       FontSize="16" FontWeight="SemiBold"
                                       Foreground="{DynamicResource AccentPurpleBrush}"
                                       HorizontalAlignment="Center"
                                       Margin="0,0,0,8"/>
                            <TextBlock Text="Connect to OpenAI, Anthropic, or custom endpoints"
                                       Style="{DynamicResource CaptionTextStyle}"
                                       TextAlignment="Center"
                                       TextWrapping="Wrap"
                                       Margin="0,0,0,12"/>
                            <Border Background="{DynamicResource AccentPurpleBrush}" 
                                    CornerRadius="4">
                                <Button Content="Configure API" 
                                        Background="Transparent"
                                        Foreground="White"
                                        BorderThickness="0"
                                        Padding="16,8"/>
                            </Border>
                        </StackPanel>
                    </Border>
                </Grid>
                
                <!-- Professional Status -->
                <TextBlock Text="Ready for production-grade AI workflows"
                           FontSize="12"
                           FontStyle="Italic"
                           Foreground="{DynamicResource TextMutedBrush}"
                           HorizontalAlignment="Center"
                           Margin="0,20,0,0"/>
            </StackPanel>
        </Border>
    </DataTemplate>

    <!-- Float Parameter Template - Professional Balance -->
    <DataTemplate x:Key="FloatParameterTemplate">
        <Border Margin="0,6" Padding="12" 
                Background="{DynamicResource TertiaryDarkBrush}"
                CornerRadius="4" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Parameter Header -->
                <Grid Grid.Row="0" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="{Binding Name}" 
                                   Style="{DynamicResource BodyTextStyle}"
                                   FontWeight="SemiBold" FontSize="13"/>
                        <TextBlock Text="{Binding RecommendedRange}" 
                                   Style="{DynamicResource CaptionTextStyle}"
                                   FontSize="10" Opacity="0.8"/>
                    </StackPanel>
                    
                    <TextBlock Grid.Column="1" Text="{Binding Value, StringFormat=F3}" 
                               Style="{DynamicResource BodyTextStyle}"
                               FontFamily="Consolas" FontSize="11"
                               Foreground="{DynamicResource AccentRedBrush}"
                               VerticalAlignment="Center"/>
                </Grid>
                
                <!-- Control -->
                <Slider Grid.Row="1"
                        Value="{Binding Value}" 
                        Minimum="{Binding Minimum}" 
                        Maximum="{Binding Maximum}"
                        TickFrequency="{Binding TickFrequency}"
                        Height="24"/>
            </Grid>
        </Border>
    </DataTemplate>

    <!-- Integer Parameter Template - Professional -->
    <DataTemplate x:Key="IntParameterTemplate">
        <Border Margin="0,6" Padding="12" 
                Background="{DynamicResource TertiaryDarkBrush}"
                CornerRadius="4" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="60"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" Text="{Binding Name}" 
                           Style="{DynamicResource BodyTextStyle}"
                           FontWeight="SemiBold" FontSize="13" VerticalAlignment="Center"/>
                           
                <Slider Grid.Column="1"
                        Value="{Binding Value}" 
                        Minimum="{Binding Minimum}" 
                        Maximum="{Binding Maximum}"
                        IsSnapToTickEnabled="True"
                        TickFrequency="1"
                        Width="120" Height="24"
                        VerticalAlignment="Center" Margin="12,0"/>
                        
                <TextBox Grid.Column="2" 
                         Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}" 
                         Style="{DynamicResource CodeTextBoxStyle}"
                         FontSize="10" Padding="4" TextAlignment="Right"/>
            </Grid>
        </Border>
    </DataTemplate>

    <!-- Boolean Parameter Template - Professional Toggle -->
    <DataTemplate x:Key="BoolParameterTemplate">
        <Border Margin="0,6" Padding="12" 
                Background="{DynamicResource TertiaryDarkBrush}"
                CornerRadius="4" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <TextBlock Text="{Binding Name}" 
                               Style="{DynamicResource BodyTextStyle}"
                               FontWeight="SemiBold" FontSize="13"/>
                    <TextBlock Text="{Binding ImpactDescription}" 
                               Style="{DynamicResource CaptionTextStyle}"
                               FontSize="10" TextWrapping="Wrap"
                               Margin="0,2,0,0"/>
                </StackPanel>
                
                <CheckBox Grid.Column="1"
                          IsChecked="{Binding Value}"
                          VerticalAlignment="Center"
                          Margin="12,0,0,0"/>
            </Grid>
        </Border>
    </DataTemplate>

    <!-- Generation Progress Template - Professional Status -->
    <DataTemplate x:Key="GenerationProgressTemplate">
        <Border Padding="16" 
                Background="{DynamicResource SecondaryDarkBrush}"
                CornerRadius="6" BorderBrush="{DynamicResource AccentPurpleBrush}" BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" Text="⚙️" FontSize="16" 
                           VerticalAlignment="Center" Margin="0,0,12,0"/>
                           
                <StackPanel Grid.Column="1">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="{Binding OperationType}" 
                                   Style="{DynamicResource BodyTextStyle}"
                                   FontWeight="SemiBold" FontSize="14"/>
                        <TextBlock Grid.Column="1" Text="{Binding Progress, StringFormat={}{0:F0}%}" 
                                   Style="{DynamicResource BodyTextStyle}"
                                   FontSize="12" Foreground="{DynamicResource AccentGreenBrush}"/>
                    </Grid>
                    
                    <ProgressBar Value="{Binding Progress}" 
                                 Height="6" 
                                 Background="{DynamicResource TertiaryDarkBrush}"
                                 Foreground="{DynamicResource AccentPurpleBrush}"
                                 Margin="0,4,0,0"/>
                </StackPanel>
                
                <TextBlock Grid.Column="2" Text="{Binding EstimatedTimeRemaining}" 
                           Style="{DynamicResource CaptionTextStyle}"
                           FontSize="10" VerticalAlignment="Center"
                           Margin="12,0,0,0"/>
            </Grid>
        </Border>
    </DataTemplate>

    <!-- Voice Synthesis Templates - Enthusiast Professional -->
    <DataTemplate x:Key="TTSConfigurationTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="340"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>
            
            <!-- Voice Configuration Panel -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="12">
                    <!-- Voice & Engine Selection -->
                    <Expander Header="🎤 Voice &amp; Engine" IsExpanded="True" Margin="0,0,0,16">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4" Padding="12" Margin="0,8,0,0">
                            <StackPanel>
                                <Grid Margin="0,0,0,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <ComboBox Grid.Column="0" 
                                              SelectedItem="{Binding SelectedVoice}" 
                                              ItemsSource="{Binding AvailableVoices}">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding Gender, Converter={StaticResource GenderToIcon}}" FontSize="14" Margin="0,0,8,0"/>
                                                    <StackPanel Margin="0,0,8,0">
                                                        <TextBlock Text="{Binding DisplayName}" FontWeight="SemiBold"/>
                                                        <TextBlock Text="{Binding Language}" 
                                                                   FontSize="10" 
                                                                   Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                    </StackPanel>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                    <Button Grid.Column="1" Content="▶" 
                                            Command="{Binding PreviewVoiceCommand}" 
                                            Width="30" Margin="8,0,0,0" 
                                            Background="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                
                                <TextBlock Text="{Binding SelectedVoice.Description}" 
                                           TextWrapping="Wrap" 
                                           FontSize="11" 
                                           Foreground="{DynamicResource TextSecondaryBrush}" 
                                           MaxHeight="40"/>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Speech Parameters -->
                    <Expander Header="⚡ Speech Parameters" IsExpanded="True" Margin="0,0,0,16">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4" Padding="12" Margin="0,8,0,0">
                            <StackPanel>
                                <!-- Speech Rate -->
                                <StackPanel Margin="0,0,0,12">
                                    <Grid Margin="0,0,0,4">
                                        <TextBlock Text="Speech Rate" FontWeight="SemiBold" FontSize="11"/>
                                        <TextBlock Text="{Binding SpeechRate, StringFormat={}x{0:F1}}" 
                                                   HorizontalAlignment="Right" 
                                                   FontSize="11" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding SpeechRate}" 
                                            Minimum="0.25" Maximum="3.0" 
                                            TickFrequency="0.25" 
                                            IsSnapToTickEnabled="True"/>
                                </StackPanel>
                                
                                <!-- Voice Pitch -->
                                <StackPanel Margin="0,0,0,12">
                                    <Grid Margin="0,0,0,4">
                                        <TextBlock Text="Voice Pitch" FontWeight="SemiBold" FontSize="11"/>
                                        <TextBlock Text="{Binding VoicePitch, StringFormat={}{0:+0.0;-0.0;0.0} semitones}" 
                                                   HorizontalAlignment="Right" 
                                                   FontSize="11" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding VoicePitch}" 
                                            Minimum="-12.0" Maximum="12.0" 
                                            TickFrequency="1.0" 
                                            IsSnapToTickEnabled="True"/>
                                </StackPanel>
                                
                                <!-- Volume Level -->
                                <StackPanel>
                                    <Grid Margin="0,0,0,4">
                                        <TextBlock Text="Output Volume" FontWeight="SemiBold" FontSize="11"/>
                                        <TextBlock Text="{Binding OutputVolume, StringFormat={}{0}%}" 
                                                   HorizontalAlignment="Right" 
                                                   FontSize="11" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding OutputVolume}" 
                                            Minimum="0" Maximum="150" 
                                            TickFrequency="10" 
                                            IsSnapToTickEnabled="True"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Advanced Processing -->
                    <Expander Header="🎛️ Audio Processing" IsExpanded="False">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4" Padding="12" Margin="0,8,0,0">
                            <StackPanel >
                                <CheckBox Content="Apply noise gate" 
                                          IsChecked="{Binding UseNoiseGate}"/>
                                <CheckBox Content="Normalize audio levels" 
                                          IsChecked="{Binding NormalizeAudio}"/>
                                <CheckBox Content="Enhanced clarity filter" 
                                          IsChecked="{Binding EnhanceClarity}"/>
                                
                                <StackPanel Margin="0,8,0,0">
                                    <TextBlock Text="Output Format:" FontSize="11" FontWeight="SemiBold" Margin="0,0,0,4"/>
                                    <ComboBox SelectedItem="{Binding OutputFormat}" 
                                              ItemsSource="{Binding AvailableFormats}"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
            
            <!-- Main Text Input & Waveform Display -->
            <Grid Grid.Column="1" Margin="12">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="120"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Text Input Area -->
                <Border Grid.Row="0" Background="{DynamicResource SecondaryDarkBrush}" 
                        CornerRadius="6" Padding="16">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" 
                                    Margin="0,0,0,12">
                            <TextBlock Text="📝 Text to Synthesize" 
                                       FontSize="14" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding TextStats}" 
                                       FontSize="11" 
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                        </StackPanel>
                        
                        <TextBox Grid.Row="1" 
                                 Text="{Binding TextToSpeak, UpdateSourceTrigger=PropertyChanged}" 
                                 TextWrapping="Wrap" 
                                 AcceptsReturn="True" 
                                 VerticalScrollBarVisibility="Auto" 
                                 Background="Transparent" 
                                 BorderThickness="0" 
                                 FontSize="13" 
                                 Padding="4"/>
                    </Grid>
                </Border>
                
                <!-- Live Waveform Preview -->
                <Border Grid.Row="1" Background="{DynamicResource TertiaryDarkBrush}" 
                        CornerRadius="6" Margin="0,12,0,0" Padding="12">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" 
                                    Margin="0,0,0,8">
                            <TextBlock Text="🎵 Waveform Preview" 
                                       FontSize="12" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding AudioDuration, StringFormat={}Duration: {0:mm\\:ss}}" 
                                       FontSize="10" 
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                        </StackPanel>
                        
                        <!-- Placeholder for waveform visualization -->
                        <Border Grid.Row="1" Background="{DynamicResource PrimaryDarkBrush}" 
                                CornerRadius="3">
                            <TextBlock Text="🌊 Audio waveform will appear here during synthesis" 
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center" 
                                       FontSize="11" 
                                       Foreground="{DynamicResource TextMutedBrush}"/>
                        </Border>
                    </Grid>
                </Border>
                
                <!-- Generate Controls -->
                <StackPanel Grid.Row="2" Orientation="Horizontal" 
                           HorizontalAlignment="Center" 
                            Margin="0,12,0,0">
                    <Button Content="🎵 Generate Speech" 
                            Command="{Binding GenerateSpeechCommand}" 
                            Background="{DynamicResource AccentRedBrush}" 
                            Padding="20,8" FontWeight="SemiBold"/>
                    <Button Content="⏸️ Stop" 
                            Command="{Binding StopSpeechCommand}" 
                            Background="{DynamicResource ErrorBrush}" 
                            Padding="16,8"/>
                    <Button Content="💾 Save Audio" 
                            Command="{Binding SaveAudioCommand}" 
                            Background="{DynamicResource SuccessBrush}" 
                            Padding="16,8"/>
                </StackPanel>
            </Grid>
            
            <!-- Voice Library & History -->
            <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
                <StackPanel  Margin="12">
                    <!-- Quick Voice Library -->
                    <Expander Header="🎭 Voice Library" IsExpanded="True">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4" Padding="8" Margin="0,8,0,0">
                            <ItemsControl ItemsSource="{Binding FavoriteVoices}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Button Content="{Binding DisplayName}" 
                                                Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.SelectVoiceCommand}" 
                                                CommandParameter="{Binding}" 
                                                Margin="0,2" 
                                                HorizontalAlignment="Stretch" 
                                                Background="Transparent" 
                                                BorderBrush="{DynamicResource BorderBrush}" 
                                                FontSize="11"/>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Border>
                    </Expander>
                    
                    <!-- Recent Generations -->
                    <Expander Header="📚 Recent Audio" IsExpanded="True">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4" Padding="8" Margin="0,8,0,0">
                            <ItemsControl ItemsSource="{Binding RecentGenerations}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                                CornerRadius="3" Padding="8" Margin="0,2">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="{Binding TextPreview}" 
                                                               FontSize="10" 
                                                               TextTrimming="CharacterEllipsis" 
                                                               MaxHeight="20"/>
                                                    <TextBlock Text="{Binding Timestamp, StringFormat={}Generated: {0:MM/dd HH:mm}}" 
                                                               FontSize="9" 
                                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                                </StackPanel>
                                                
                                                <Button Grid.Column="1" Content="▶" 
                                                        Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.PlayAudioCommand}" 
                                                        CommandParameter="{Binding}" 
                                                        Width="24" Height="24" 
                                                        Background="{DynamicResource AccentRedBrush}" 
                                                        FontSize="10"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </DataTemplate>
    
    <DataTemplate x:Key="VoiceCloningTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="320"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="280"/>
            </Grid.ColumnDefinitions>
            
            <!-- Clone Configuration -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                <StackPanel  Margin="12">
                    <!-- Sample Upload -->
                    <Expander Header="🎤 Voice Sample" IsExpanded="True">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4" Padding="12" Margin="0,8,0,0">
                            <StackPanel >
                                <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                        BorderBrush="{DynamicResource BorderBrush}" 
                                        BorderThickness="2" 
                                        CornerRadius="4" 
                                        Padding="20" 
                                        AllowDrop="True">
                                    <StackPanel HorizontalAlignment="Center" >
                                        <TextBlock Text="📁" FontSize="24" HorizontalAlignment="Center"/>
                                        <TextBlock Text="Drop audio sample here" 
                                                   FontSize="12" 
                                                   HorizontalAlignment="Center"/>
                                        <TextBlock Text="WAV, MP3, FLAC (10s minimum)" 
                                                   FontSize="10" 
                                                   Foreground="{DynamicResource TextSecondaryBrush}" 
                                                   HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                
                                <Button Content="🔍 Browse Files" 
                                        Command="{Binding BrowseAudioCommand}" 
                                        HorizontalAlignment="Stretch"/>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Training Parameters -->
                    <Expander Header="⚙️ Training Settings" IsExpanded="True">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4" Padding="12" Margin="0,8,0,0">
                            <StackPanel >
                                <StackPanel>
                                    <TextBlock Text="Voice Clone Name" 
                                               FontSize="11" FontWeight="SemiBold" 
                                               Margin="0,0,0,4"/>
                                    <TextBox Text="{Binding VoiceCloneName, UpdateSourceTrigger=PropertyChanged}"/>
                                </StackPanel>
                                
                                <StackPanel>
                                    <Grid Margin="0,0,0,4">
                                        <TextBlock Text="Training Quality" FontWeight="SemiBold" FontSize="11"/>
                                        <TextBlock Text="{Binding TrainingQuality}" 
                                                   HorizontalAlignment="Right" 
                                                   FontSize="11" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <ComboBox SelectedItem="{Binding TrainingQuality}" 
                                              ItemsSource="{Binding QualityLevels}"/>
                                    <TextBlock Text="Higher quality = longer training time" 
                                               FontSize="10" 
                                               Foreground="{DynamicResource TextSecondaryBrush}" 
                                               Margin="0,4,0,0"/>
                                </StackPanel>
                                
                                <CheckBox Content="Enable voice enhancement preprocessing" 
                                          IsChecked="{Binding EnablePreprocessing}"/>
                                <CheckBox Content="Train with emotion variations" 
                                          IsChecked="{Binding TrainEmotions}"/>
                            </StackPanel>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
            
            <!-- Training Progress & Preview -->
            <Grid Grid.Column="1" Margin="12">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="120"/>
                </Grid.RowDefinitions>
                
                <!-- Sample Analysis -->
                <Border Grid.Row="0" Background="{DynamicResource SecondaryDarkBrush}" 
                        CornerRadius="6" Padding="16">
                    <StackPanel >
                        <StackPanel Orientation="Horizontal" >
                            <TextBlock Text="🧬 Voice Analysis" 
                                       FontSize="16" FontWeight="SemiBold"/>
                            <Border Background="{Binding SampleQualityColor}" 
                                    Padding="6,2" CornerRadius="10">
                                <TextBlock Text="{Binding SampleQuality}" 
                                           FontSize="10" 
                                           Foreground="White"/>
                            </Border>
                        </StackPanel>
                        
                        <!-- Audio Characteristics -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0" >
                                <TextBlock Text="Sample Characteristics:" 
                                           FontSize="12" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding SampleDuration, StringFormat={}Duration: {0:mm\\:ss}}" 
                                           FontSize="11"/>
                                <TextBlock Text="{Binding SampleRate, StringFormat={}Sample Rate: {0} Hz}" 
                                           FontSize="11"/>
                                <TextBlock Text="{Binding BitDepth, StringFormat={}Bit Depth: {0}}" 
                                           FontSize="11"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" >
                                <TextBlock Text="Voice Characteristics:" 
                                           FontSize="12" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding DetectedGender, StringFormat={}Gender: {0}}" 
                                           FontSize="11"/>
                                <TextBlock Text="{Binding EstimatedAge, StringFormat={}Age Range: {0}}" 
                                           FontSize="11"/>
                                <TextBlock Text="{Binding VoiceType, StringFormat={}Voice Type: {0}}" 
                                           FontSize="11"/>
                            </StackPanel>
                        </Grid>
                        
                        <!-- Preview Original -->
                        <StackPanel Orientation="Horizontal" 
                                   HorizontalAlignment="Center" >
                            <Button Content="▶ Play Sample" 
                                    Command="{Binding PlaySampleCommand}" 
                                    Background="{DynamicResource AccentRedBrush}"/>
                            <Button Content="🎯 Start Training" 
                                    Command="{Binding StartTrainingCommand}" 
                                    Background="{DynamicResource SuccessBrush}" 
                                    FontWeight="SemiBold"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
                
                <!-- Training Progress -->
                <Border Grid.Row="1" Background="{DynamicResource TertiaryDarkBrush}" 
                        CornerRadius="6" Padding="12" Margin="0,12,0,0"
                        Visibility="{Binding IsTraining, Converter={StaticResource BoolToVisibility}}">
                    <StackPanel >
                        <StackPanel Orientation="Horizontal" >
                            <TextBlock Text="🚀 Training Voice Clone..." 
                                       FontSize="12" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding TrainingProgress, StringFormat={}{0:P0}}" 
                                       FontSize="12" 
                                       Foreground="{DynamicResource AccentRedBrush}"/>
                        </StackPanel>
                        
                        <ProgressBar Value="{Binding TrainingProgress}" 
                                     Height="8" 
                                     Background="{DynamicResource PrimaryDarkBrush}" 
                                     Foreground="{DynamicResource AccentRedBrush}"/>
                        
                        <TextBlock Text="{Binding EstimatedTimeRemaining, StringFormat={}Estimated time remaining: {0}}" 
                                   FontSize="10" 
                                   Foreground="{DynamicResource TextSecondaryBrush}"/>
                    </StackPanel>
                </Border>
                
                <!-- Training Log -->
                <Border Grid.Row="2" Background="{DynamicResource TertiaryDarkBrush}" 
                        CornerRadius="6" Margin="0,12,0,0">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="8">
                        <TextBlock Text="{Binding TrainingLog}" 
                                   FontFamily="Consolas" 
                                   FontSize="10" 
                                   Foreground="{DynamicResource TextMutedBrush}"/>
                    </ScrollViewer>
                </Border>
            </Grid>
            
            <!-- Clone Library -->
            <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
                <StackPanel  Margin="12">
                    <Expander Header="🎭 My Voice Clones" IsExpanded="True">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4" Padding="8" Margin="0,8,0,0">
                            <ItemsControl ItemsSource="{Binding VoiceClones}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                                CornerRadius="3" Padding="10" Margin="0,2">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                
                                                <StackPanel Grid.Row="0" Orientation="Horizontal">
                                                    <TextBlock Text="{Binding Name}" 
                                                               FontSize="12" FontWeight="SemiBold"/>
                                                    <Border Background="{Binding StatusColor}" 
                                                            Padding="4,1" CornerRadius="8" 
                                                            Margin="8,0,0,0">
                                                        <TextBlock Text="{Binding Status}" 
                                                                   FontSize="8" 
                                                                   Foreground="White"/>
                                                    </Border>
                                                </StackPanel>
                                                
                                                <TextBlock Grid.Row="1" 
                                                           Text="{Binding CreatedDate, StringFormat={}Created: {0:MM/dd/yyyy}}" 
                                                           FontSize="10" 
                                                           Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                
                                                <StackPanel Grid.Row="2" Orientation="Horizontal" 
                                                            Margin="0,6,0,0">
                                                    <Button Content="▶" 
                                                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.TestCloneCommand}" 
                                                            CommandParameter="{Binding}" 
                                                            Width="24" Height="20" 
                                                            FontSize="10"/>
                                                    <Button Content="📝" 
                                                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.UseCloneCommand}" 
                                                            CommandParameter="{Binding}" 
                                                            Width="24" Height="20" 
                                                            FontSize="10"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </DataTemplate>
    
    <DataTemplate x:Key="RealTimeSynthesisTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="280"/>
            </Grid.ColumnDefinitions>
            
            <!-- Real-Time Controls -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                <StackPanel  Margin="12">
                    <!-- Live Session -->
                    <Expander Header="⚡ Live Session" IsExpanded="True">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4" Padding="12" Margin="0,8,0,0">
                            <StackPanel >
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" >
                                    <TextBlock Text="🎙️" FontSize="18"/>
                                    <TextBlock Text="{Binding CurrentVoice.DisplayName}" 
                                               FontSize="14" FontWeight="SemiBold"/>
                                </StackPanel>
                                
                                <!-- Main Talk Button -->
                                <Button Content="{Binding IsSpeaking, Converter={StaticResource SpeakingToText}}" 
                                        Command="{Binding ToggleSpeechCommand}" 
                                        Background="{Binding IsSpeaking, Converter={StaticResource SpeakingToBrush}}" 
                                        FontSize="16" FontWeight="Bold" 
                                        Padding="20,12" 
                                        HorizontalAlignment="Stretch"/>
                                
                                <!-- Quick Controls -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Button Grid.Column="0" Content="⏸️" 
                                            Command="{Binding PauseSpeechCommand}" 
                                            Margin="0,0,4,0"/>
                                    <Button Grid.Column="1" Content="⏹️" 
                                            Command="{Binding StopSpeechCommand}" 
                                            Margin="4,0,0,0"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Live Parameters -->
                    <Expander Header="🎛️ Live Adjustments" IsExpanded="True">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4" Padding="12" Margin="0,8,0,0">
                            <StackPanel >
                                <!-- Speed -->
                                <StackPanel>
                                    <Grid Margin="0,0,0,4">
                                        <TextBlock Text="Speed" FontWeight="SemiBold" FontSize="11"/>
                                        <TextBlock Text="{Binding LiveSpeed, StringFormat={}x{0:F1}}" 
                                                   HorizontalAlignment="Right" 
                                                   FontSize="11" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding LiveSpeed}" 
                                            Minimum="0.5" Maximum="2.5" 
                                            TickFrequency="0.1"/>
                                </StackPanel>
                                
                                <!-- Pitch -->
                                <StackPanel>
                                    <Grid Margin="0,0,0,4">
                                        <TextBlock Text="Pitch" FontWeight="SemiBold" FontSize="11"/>
                                        <TextBlock Text="{Binding LivePitch, StringFormat={}{0:+0;-0;0} st}" 
                                                   HorizontalAlignment="Right" 
                                                   FontSize="11" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding LivePitch}" 
                                            Minimum="-6" Maximum="6" 
                                            TickFrequency="0.5"/>
                                </StackPanel>
                                
                                <!-- Volume -->
                                <StackPanel>
                                    <Grid Margin="0,0,0,4">
                                        <TextBlock Text="Volume" FontWeight="SemiBold" FontSize="11"/>
                                        <TextBlock Text="{Binding LiveVolume, StringFormat={}{0}%}" 
                                                   HorizontalAlignment="Right" 
                                                   FontSize="11" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding LiveVolume}" 
                                            Minimum="0" Maximum="100" 
                                            TickFrequency="5"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
            
            <!-- Live Text Input & Visualization -->
            <Grid Grid.Column="1" Margin="12">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="120"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Live Text Area -->
                <Border Grid.Row="0" Background="{DynamicResource SecondaryDarkBrush}" 
                        CornerRadius="6" Padding="16">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0" Text="💬 Live Speech Input" 
                                   FontSize="14" FontWeight="SemiBold" 
                                   Margin="0,0,0,12"/>
                        
                        <TextBox Grid.Row="1" 
                                 Text="{Binding LiveText, UpdateSourceTrigger=PropertyChanged}" 
                                 TextWrapping="Wrap" 
                                 AcceptsReturn="True" 
                                 VerticalScrollBarVisibility="Auto" 
                                 Background="Transparent" 
                                 BorderThickness="0" 
                                 FontSize="13" 
                                 Padding="4"/>
                    </Grid>
                </Border>
                
                <!-- Live Audio Visualization -->
                <Border Grid.Row="1" Background="{DynamicResource TertiaryDarkBrush}" 
                        CornerRadius="6" Margin="0,12,0,0" Padding="12">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" 
                                    Margin="0,0,0,8">
                            <TextBlock Text="🎵 Live Audio Monitor" 
                                       FontSize="12" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding CurrentPosition, StringFormat={}Position: {0:mm\\:ss}}" 
                                       FontSize="10" 
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                        </StackPanel>
                        
                        <!-- Live waveform placeholder -->
                        <Border Grid.Row="1" Background="{DynamicResource PrimaryDarkBrush}" 
                                CornerRadius="3">
                            <TextBlock Text="🌊 Live audio visualization" 
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center" 
                                       FontSize="11" 
                                       Foreground="{DynamicResource TextMutedBrush}"/>
                        </Border>
                    </Grid>
                </Border>
                
                <!-- Session Controls -->
                <StackPanel Grid.Row="2" Orientation="Horizontal" 
                           HorizontalAlignment="Center" 
                            Margin="0,12,0,0">
                    <Button Content="🎤 Start Session" 
                            Command="{Binding StartSessionCommand}" 
                            Background="{DynamicResource AccentRedBrush}" 
                            Padding="16,8" FontWeight="SemiBold"/>
                    <Button Content="💾 Save Session" 
                            Command="{Binding SaveSessionCommand}" 
                            Background="{DynamicResource SuccessBrush}" 
                            Padding="14,8"/>
                    <Button Content="🔄 Reset" 
                            Command="{Binding ResetSessionCommand}" 
                            Padding="14,8"/>
                </StackPanel>
            </Grid>
            
            <!-- Session History -->
            <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
                <StackPanel  Margin="12">
                    <Expander Header="📝 Session Log" IsExpanded="True">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4" Padding="8" Margin="0,8,0,0">
                            <ItemsControl ItemsSource="{Binding SessionHistory}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                                CornerRadius="3" Padding="8" Margin="0,2">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="{Binding TextPreview}" 
                                                               FontSize="10" 
                                                               TextTrimming="CharacterEllipsis" 
                                                               MaxHeight="20"/>
                                                    <TextBlock Text="{Binding Duration, StringFormat={}Duration: {0:mm\\:ss}}" 
                                                               FontSize="9" 
                                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                                </StackPanel>
                                                
                                                <Button Grid.Column="1" Content="▶" 
                                                        Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.ReplayCommand}" 
                                                        CommandParameter="{Binding}" 
                                                        Width="24" Height="24" 
                                                        FontSize="10"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </DataTemplate>
    
    <DataTemplate x:Key="AudioProcessingTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="260"/>
            </Grid.ColumnDefinitions>
            
            <!-- Processing Parameters -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                <StackPanel  Margin="12">
                    <!-- Audio Enhancement -->
                    <Expander Header="✨ Audio Enhancement" IsExpanded="True">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4" Padding="12" Margin="0,8,0,0">
                            <StackPanel >
                                <CheckBox Content="Noise reduction" 
                                          IsChecked="{Binding EnableNoiseReduction}"/>
                                <CheckBox Content="Audio normalization" 
                                          IsChecked="{Binding EnableNormalization}"/>
                                <CheckBox Content="Voice enhancement" 
                                          IsChecked="{Binding EnableVoiceEnhancement}"/>
                                <CheckBox Content="Echo removal" 
                                          IsChecked="{Binding EnableEchoRemoval}"/>
                                
                                <!-- Enhancement Strength -->
                                <StackPanel>
                                    <Grid Margin="0,0,0,4">
                                        <TextBlock Text="Enhancement Strength" FontWeight="SemiBold" FontSize="11"/>
                                        <TextBlock Text="{Binding EnhancementStrength, StringFormat={}{0}%}" 
                                                   HorizontalAlignment="Right" 
                                                   FontSize="11" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding EnhancementStrength}" 
                                            Minimum="0" Maximum="100" 
                                            TickFrequency="10"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Output Settings -->
                    <Expander Header="💾 Output Settings" IsExpanded="True">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4" Padding="12" Margin="0,8,0,0">
                            <StackPanel >
                                <StackPanel>
                                    <TextBlock Text="Output Format:" FontSize="11" FontWeight="SemiBold" Margin="0,0,0,4"/>
                                    <ComboBox SelectedItem="{Binding OutputFormat}" 
                                              ItemsSource="{Binding AvailableFormats}"/>
                                </StackPanel>
                                
                                <StackPanel>
                                    <TextBlock Text="Quality Level:" FontSize="11" FontWeight="SemiBold" Margin="0,0,0,4"/>
                                    <ComboBox SelectedItem="{Binding QualityLevel}" 
                                              ItemsSource="{Binding QualityLevels}"/>
                                </StackPanel>
                                
                                <StackPanel>
                                    <Grid Margin="0,0,0,4">
                                        <TextBlock Text="Output Volume" FontWeight="SemiBold" FontSize="11"/>
                                        <TextBlock Text="{Binding OutputVolume, StringFormat={}{0}%}" 
                                                   HorizontalAlignment="Right" 
                                                   FontSize="11" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding OutputVolume}" 
                                            Minimum="0" Maximum="150" 
                                            TickFrequency="10"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
            
            <!-- Audio Processing Interface -->
            <Grid Grid.Column="1" Margin="12">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="120"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- File Input -->
                <Border Grid.Row="0" Background="{DynamicResource SecondaryDarkBrush}" 
                        CornerRadius="6" Padding="16" Margin="0,0,0,12">
                    <StackPanel >
                        <TextBlock Text="🎵 Audio File Processing" 
                                   FontSize="16" FontWeight="SemiBold"/>
                        
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                BorderBrush="{DynamicResource BorderBrush}" 
                                BorderThickness="2" 
                                CornerRadius="4" 
                                Padding="30" 
                                AllowDrop="True">
                            <StackPanel HorizontalAlignment="Center" >
                                <TextBlock Text="📁" FontSize="32" HorizontalAlignment="Center"/>
                                <TextBlock Text="Drop audio files here for processing" 
                                           FontSize="13" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Supported: WAV, MP3, FLAC, OGG, M4A" 
                                           FontSize="11" 
                                           Foreground="{DynamicResource TextSecondaryBrush}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        
                        <StackPanel Orientation="Horizontal" 
                                   HorizontalAlignment="Center" >
                            <Button Content="🔍 Browse Files" 
                                    Command="{Binding BrowseFilesCommand}" 
                                    Padding="16,6"/>
                            <Button Content="🎤 Record New" 
                                    Command="{Binding RecordNewCommand}" 
                                    Background="{DynamicResource AccentRedBrush}" 
                                    Padding="16,6"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
                
                <!-- Before/After Comparison -->
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Before -->
                    <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="6" Padding="12" Margin="0,0,6,0">
                        <StackPanel >
                            <StackPanel Orientation="Horizontal" >
                                <TextBlock Text="📥 Original" FontSize="12" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding OriginalFileSize}" 
                                           FontSize="10" 
                                           Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </StackPanel>
                            
                            <!-- Waveform placeholder -->
                            <Border Background="{DynamicResource PrimaryDarkBrush}" 
                                    Height="60" CornerRadius="3">
                                <TextBlock Text="Original waveform" 
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center" 
                                           FontSize="10" 
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                            </Border>
                            
                            <Button Content="▶ Play Original" 
                                    Command="{Binding PlayOriginalCommand}" 
                                    HorizontalAlignment="Stretch" 
                                    Padding="8,4" FontSize="10"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- After -->
                    <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="6" Padding="12" Margin="6,0,0,0">
                        <StackPanel >
                            <StackPanel Orientation="Horizontal" >
                                <TextBlock Text="✨ Processed" FontSize="12" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding ProcessedFileSize}" 
                                           FontSize="10" 
                                           Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </StackPanel>
                            
                            <!-- Waveform placeholder -->
                            <Border Background="{DynamicResource PrimaryDarkBrush}" 
                                    Height="60" CornerRadius="3">
                                <TextBlock Text="Enhanced waveform" 
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center" 
                                           FontSize="10" 
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                            </Border>
                            
                            <Button Content="▶ Play Enhanced" 
                                    Command="{Binding PlayProcessedCommand}" 
                                    HorizontalAlignment="Stretch" 
                                    Background="{DynamicResource AccentRedBrush}" 
                                    Padding="8,4" FontSize="10"/>
                        </StackPanel>
                    </Border>
                </Grid>
                
                <!-- Processing Progress -->
                <Border Grid.Row="2" Background="{DynamicResource SecondaryDarkBrush}" 
                        CornerRadius="6" Padding="12" Margin="0,12,0,0"
                        Visibility="{Binding IsProcessing, Converter={StaticResource BoolToVisibility}}">
                    <StackPanel >
                        <StackPanel Orientation="Horizontal" >
                            <TextBlock Text="🔄 Processing Audio..." 
                                       FontSize="12" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding ProcessingProgress, StringFormat={}{0:P0}}" 
                                       FontSize="12" 
                                       Foreground="{DynamicResource AccentRedBrush}"/>
                        </StackPanel>
                        
                        <ProgressBar Value="{Binding ProcessingProgress}" 
                                     Height="8" 
                                     Background="{DynamicResource PrimaryDarkBrush}" 
                                     Foreground="{DynamicResource AccentRedBrush}"/>
                        
                        <TextBlock Text="{Binding CurrentProcessingStep}" 
                                   FontSize="10" 
                                   Foreground="{DynamicResource TextSecondaryBrush}"/>
                    </StackPanel>
                </Border>
                
                <!-- Action Buttons -->
                <StackPanel Grid.Row="3" Orientation="Horizontal" 
                           HorizontalAlignment="Center" 
                            Margin="0,12,0,0">
                    <Button Content="🎯 Process Audio" 
                            Command="{Binding ProcessAudioCommand}" 
                            Background="{DynamicResource AccentRedBrush}" 
                            Padding="20,8" FontWeight="SemiBold"/>
                    <Button Content="💾 Save Processed" 
                            Command="{Binding SaveProcessedCommand}" 
                            Background="{DynamicResource SuccessBrush}" 
                            Padding="16,8"/>
                    <Button Content="🔄 Reset" 
                            Command="{Binding ResetCommand}" 
                            Padding="16,8"/>
                </StackPanel>
            </Grid>
            
            <!-- Processing History -->
            <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
                <StackPanel  Margin="12">
                    <Expander Header="📚 Recent Processing" IsExpanded="True">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4" Padding="8" Margin="0,8,0,0">
                            <ItemsControl ItemsSource="{Binding ProcessingHistory}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                                CornerRadius="3" Padding="8" Margin="0,2">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                
                                                <TextBlock Grid.Row="0" Text="{Binding FileName}" 
                                                           FontSize="11" FontWeight="SemiBold" 
                                                           TextTrimming="CharacterEllipsis"/>
                                                
                                                <StackPanel Grid.Row="1" Orientation="Horizontal" >
                                                    <TextBlock Text="{Binding ProcessingType}" 
                                                               FontSize="9" 
                                                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                    <TextBlock Text="{Binding ProcessingDate, StringFormat={}{0:MM/dd HH:mm}}" 
                                                               FontSize="9" 
                                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Row="2" Orientation="Horizontal" 
                                                            Margin="0,4,0,0">
                                                    <Button Content="▶" 
                                                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.PlayHistoryCommand}" 
                                                            CommandParameter="{Binding}" 
                                                            Width="20" Height="18" 
                                                            FontSize="8"/>
                                                    <Button Content="💾" 
                                                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.SaveHistoryCommand}" 
                                                            CommandParameter="{Binding}" 
                                                            Width="20" Height="18" 
                                                            FontSize="8"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </DataTemplate>
    
         <!-- Text to Image View - Enthusiast Mode -->
     <DataTemplate x:Key="EnthusiastText2ImageViewModelTemplate">
         <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
             <Grid.ColumnDefinitions>
                 <ColumnDefinition Width="350"/>
                 <ColumnDefinition Width="*"/>
                 <ColumnDefinition Width="300"/>
             </Grid.ColumnDefinitions>

             <!-- Left Panel: Controls -->
             <Border Grid.Column="0" 
                     Background="{DynamicResource TertiaryDarkBrush}" 
                     CornerRadius="8,0,0,8" 
                     Padding="16">
                 <ScrollViewer VerticalScrollBarVisibility="Auto">
                     <StackPanel>
                         <TextBlock Text="🎨 Image Generation" 
                                    Style="{DynamicResource HeadingMediumStyle}"
                                    Foreground="{DynamicResource AccentRedBrush}"
                                    Margin="0,0,0,16"/>

                         <!-- Prompt Input -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Prompt" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                             <TextBox Text="{Binding Prompt, UpdateSourceTrigger=PropertyChanged}"
                                      Style="{DynamicResource DarkTextBoxStyle}"
                                      MinHeight="80"
                                      TextWrapping="Wrap"
                                      AcceptsReturn="True"
                                      Tag="Describe your image..."/>
                         </StackPanel>

                         <!-- Negative Prompt -->
                         <StackPanel Margin="0,0,0,16">
                             <CheckBox Content="Use Negative Prompt" 
                                       IsChecked="{Binding UseNegativePrompt}" 
                                       Style="{DynamicResource DarkCheckBoxStyle}"
                                       Margin="0,0,0,6"/>
                             <TextBox Text="{Binding NegativePrompt, UpdateSourceTrigger=PropertyChanged}"
                                      Style="{DynamicResource DarkTextBoxStyle}"
                                      MinHeight="60"
                                      TextWrapping="Wrap"
                                      Tag="What to avoid..."
                                      Visibility="{Binding UseNegativePrompt, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                         </StackPanel>

                         <!-- Essential Parameters -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                             <StackPanel>
                                 <TextBlock Text="Generation Settings" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,12"/>
                                 
                                 <!-- Steps -->
                                 <Grid Margin="0,0,0,12">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="60"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Quality (Steps)" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <TextBox Grid.Column="1" Text="{Binding Steps, UpdateSourceTrigger=PropertyChanged}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>
                                 <Slider Value="{Binding Steps}" Minimum="15" Maximum="50" TickFrequency="5" Margin="0,0,0,12"/>

                                 <!-- CFG Scale -->
                                 <Grid Margin="0,0,0,12">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="60"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Guidance (CFG)" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <TextBox Grid.Column="1" Text="{Binding CfgScale, UpdateSourceTrigger=PropertyChanged, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>
                                 <Slider Value="{Binding CfgScale}" Minimum="1" Maximum="20" TickFrequency="0.5" Margin="0,0,0,12"/>

                                 <!-- Size -->
                                 <TextBlock Text="Image Size" Margin="0,0,0,6" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                 <ComboBox ItemsSource="{Binding SizePresets}" 
                                           SelectedItem="{Binding SelectedSize}" 
                                           Style="{DynamicResource DarkComboBoxStyle}"/>
                             </StackPanel>
                         </Border>

                         <!-- Model Selection -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Model" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                             <ComboBox ItemsSource="{Binding AvailableModels}" 
                                       SelectedItem="{Binding SelectedModel}" 
                                       Style="{DynamicResource DarkComboBoxStyle}"/>
                         </StackPanel>

                         <!-- Generate Button -->
                         <Button Content="🎨 Generate Image" 
                                 Command="{Binding GenerateCommand}" 
                                 Style="{DynamicResource PrimaryButtonStyle}" 
                                 Padding="0,12" 
                                 FontSize="14" 
                                 FontWeight="SemiBold"
                                 IsEnabled="{Binding CanGenerate}"/>
                     </StackPanel>
                 </ScrollViewer>
             </Border>

             <!-- Center Panel: Preview -->
             <Border Grid.Column="1" 
                     Background="{DynamicResource PrimaryDarkBrush}" 
                     Padding="20" 
                     BorderBrush="{DynamicResource BorderBrush}" 
                     BorderThickness="0,1,0,1">
                 <Grid>
                     <!-- Generated Image -->
                     <Border Background="{DynamicResource TertiaryDarkBrush}" 
                             CornerRadius="8" 
                             BorderBrush="{DynamicResource BorderBrush}" 
                             BorderThickness="1"
                             Visibility="{Binding HasGeneratedImage, Converter={StaticResource BooleanToVisibilityConverter}}">
                         <Image Source="{Binding GeneratedImageSource}" Stretch="Uniform"/>
                     </Border>

                     <!-- Empty State -->
                     <StackPanel HorizontalAlignment="Center" 
                                 VerticalAlignment="Center"
                                 Visibility="{Binding HasGeneratedImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                         <TextBlock Text="🖼️" FontSize="80" HorizontalAlignment="Center" Margin="0,0,0,20" Opacity="0.3"/>
                         <TextBlock Text="Image Preview" 
                                    Style="{DynamicResource HeadingLargeStyle}" 
                                    Foreground="{DynamicResource TextMutedBrush}" 
                                    HorizontalAlignment="Center"/>
                         <TextBlock Text="Generated images will appear here" 
                                    Style="{DynamicResource BodyTextStyle}" 
                                    Foreground="{DynamicResource TextMutedBrush}" 
                                    HorizontalAlignment="Center" 
                                    Margin="0,8,0,0"/>
                     </StackPanel>

                     <!-- Generation Progress Overlay -->
                     <Border Background="{DynamicResource SecondaryDarkBrush}" 
                             CornerRadius="8" 
                             Padding="24" 
                             HorizontalAlignment="Center" 
                             VerticalAlignment="Center"
                             Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToVisibilityConverter}}">
                         <StackPanel HorizontalAlignment="Center" MinWidth="300">
                             <TextBlock Text="🎨 Generating..." 
                                        Style="{DynamicResource HeadingMediumStyle}" 
                                        Foreground="{DynamicResource AccentRedBrush}" 
                                        HorizontalAlignment="Center" 
                                        Margin="0,0,0,12"/>
                             <ProgressBar Value="{Binding GenerationProgress}" 
                                          Height="8" 
                                          Background="{DynamicResource TertiaryDarkBrush}" 
                                          Foreground="{DynamicResource AccentRedBrush}"
                                          Margin="0,0,0,8"/>
                             <TextBlock Text="{Binding GenerationStatus}" 
                                        Style="{DynamicResource BodyTextStyle}" 
                                        Foreground="{DynamicResource TextSecondaryBrush}" 
                                        HorizontalAlignment="Center"/>
                             <Button Content="Cancel" 
                                     Command="{Binding CancelCommand}" 
                                     Style="{DynamicResource SecondaryButtonStyle}" 
                                     Margin="0,12,0,0"/>
                         </StackPanel>
                     </Border>

                     <!-- Image Actions -->
                     <StackPanel VerticalAlignment="Bottom" 
                                 HorizontalAlignment="Right" 
                                 Orientation="Horizontal" 
                                 Margin="16"
                                 Visibility="{Binding HasGeneratedImage, Converter={StaticResource BooleanToVisibilityConverter}}">
                         <Button Content="💾" 
                                 Command="{Binding SaveImageCommand}" 
                                 Style="{DynamicResource GhostButtonStyle}" 
                                 ToolTip="Save Image" 
                                 Margin="0,0,8,0"/>
                         <Button Content="📤" 
                                 Command="{Binding ExportImageCommand}" 
                                 Style="{DynamicResource GhostButtonStyle}" 
                                 ToolTip="Export"/>
                     </StackPanel>
                 </Grid>
             </Border>

             <!-- Right Panel: History & Gallery -->
             <Border Grid.Column="2" 
                     Background="{DynamicResource TertiaryDarkBrush}" 
                     CornerRadius="0,8,8,0" 
                     Padding="16">
                 <StackPanel>
                     <TextBlock Text="📚 History &amp; Gallery" 
                                Style="{DynamicResource HeadingSmallStyle}"
                                Foreground="{DynamicResource AccentRedBrush}"
                                Margin="0,0,0,16"/>

                     <!-- Generation Queue Status -->
                     <Border Background="{DynamicResource SecondaryDarkBrush}" 
                             CornerRadius="6" 
                             Padding="12" 
                             Margin="0,0,0,16"
                             Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToVisibilityConverter}}">
                         <StackPanel>
                             <TextBlock Text="Generation Queue" 
                                        Style="{DynamicResource BodyTextStyle}" 
                                        FontWeight="SemiBold" 
                                        Foreground="{DynamicResource TextPrimaryBrush}" 
                                        Margin="0,0,0,6"/>
                             <TextBlock Text="1 image in progress" 
                                        Style="{DynamicResource CaptionTextStyle}" 
                                        Foreground="{DynamicResource TextSecondaryBrush}"/>
                             <ProgressBar IsIndeterminate="True" 
                                          Height="4" 
                                          Background="{DynamicResource TertiaryDarkBrush}" 
                                          Foreground="{DynamicResource AccentRedBrush}" 
                                          Margin="0,6,0,0"/>
                         </StackPanel>
                     </Border>

                     <!-- Recent History -->
                     <TextBlock Text="Recent Generations" 
                                Style="{DynamicResource BodyTextStyle}" 
                                FontWeight="SemiBold" 
                                Foreground="{DynamicResource TextPrimaryBrush}" 
                                Margin="0,0,0,8"/>
                     
                     <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="400">
                         <ItemsControl ItemsSource="{Binding GenerationHistory}">
                             <ItemsControl.ItemTemplate>
                                 <DataTemplate>
                                     <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                             CornerRadius="6" 
                                             Padding="12" 
                                             Margin="0,0,0,8"
                                             BorderBrush="{DynamicResource BorderBrush}"
                                             BorderThickness="1">
                                         <Border.InputBindings>
                                             <MouseBinding Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.LoadPresetCommand}" 
                                                           CommandParameter="{Binding}" 
                                                           MouseAction="LeftClick"/>
                                         </Border.InputBindings>
                                         <StackPanel>
                                             <TextBlock Text="{Binding PromptPreview}" 
                                                        Style="{DynamicResource BodyTextStyle}" 
                                                        FontWeight="SemiBold" 
                                                        Foreground="{DynamicResource TextPrimaryBrush}" 
                                                        TextWrapping="Wrap" 
                                                        MaxHeight="40"/>
                                             <Grid Margin="0,6,0,0">
                                                 <Grid.ColumnDefinitions>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="*"/>
                                                 </Grid.ColumnDefinitions>
                                                 <TextBlock Grid.Column="0" 
                                                            Text="{Binding SizeText}" 
                                                            Style="{DynamicResource CaptionTextStyle}" 
                                                            Foreground="{DynamicResource TextMutedBrush}"/>
                                                 <TextBlock Grid.Column="1" 
                                                            Text="{Binding TimeAgo}" 
                                                            Style="{DynamicResource CaptionTextStyle}" 
                                                            Foreground="{DynamicResource TextMutedBrush}" 
                                                            HorizontalAlignment="Right"/>
                                             </Grid>
                                             <TextBlock Text="{Binding ParametersText}" 
                                                        Style="{DynamicResource CaptionTextStyle}" 
                                                        Foreground="{DynamicResource TextSecondaryBrush}" 
                                                        FontFamily="Consolas" 
                                                        FontSize="10" 
                                                        Margin="0,2,0,0"/>
                                         </StackPanel>
                                     </Border>
                                 </DataTemplate>
                             </ItemsControl.ItemTemplate>
                         </ItemsControl>
                     </ScrollViewer>

                     <!-- Quick Actions -->
                     <StackPanel Margin="0,16,0,0">
                         <Button Content="⭐ Add to Favorites" 
                                 Command="{Binding AddToFavoritesCommand}" 
                                 Style="{DynamicResource SecondaryButtonStyle}" 
                                 Margin="0,0,0,8"/>
                         <Button Content="🗑️ Clear History" 
                                 Command="{Binding ClearHistoryCommand}" 
                                 Style="{DynamicResource SecondaryButtonStyle}"/>
                     </StackPanel>
                 </StackPanel>
             </Border>

             <!-- Center Panel: Preview -->
             <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="20">
                 <Grid>
                     <!-- Generated Image -->
                     <Border Background="{DynamicResource TertiaryDarkBrush}" 
                             CornerRadius="8" 
                             BorderBrush="{DynamicResource BorderBrush}" 
                             BorderThickness="1"
                             Visibility="{Binding HasGeneratedImage, Converter={StaticResource BooleanToVisibilityConverter}}">
                         <Image Source="{Binding GeneratedImageSource}" Stretch="Uniform"/>
                     </Border>

                     <!-- Empty State -->
                     <StackPanel HorizontalAlignment="Center" 
                                 VerticalAlignment="Center"
                                 Visibility="{Binding HasGeneratedImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                         <TextBlock Text="🎨" FontSize="80" HorizontalAlignment="Center" Margin="0,0,0,20" Opacity="0.3"/>
                         <TextBlock Text="Image Canvas" 
                                    Style="{DynamicResource HeadingLargeStyle}" 
                                    Foreground="{DynamicResource TextMutedBrush}" 
                                    HorizontalAlignment="Center"/>
                         <TextBlock Text="Your generated image will appear here" 
                                    Style="{DynamicResource BodyTextStyle}" 
                                    Foreground="{DynamicResource TextMutedBrush}" 
                                    HorizontalAlignment="Center" 
                                    Margin="0,8,0,0"/>
                     </StackPanel>

                     <!-- Generation Progress -->
                     <Border Background="{DynamicResource SecondaryDarkBrush}" 
                             CornerRadius="8" 
                             Padding="24" 
                             HorizontalAlignment="Center" 
                             VerticalAlignment="Center"
                             Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToVisibilityConverter}}">
                         <StackPanel HorizontalAlignment="Center" MinWidth="350">
                             <TextBlock Text="🎨 Generating Image..." 
                                        Style="{DynamicResource HeadingMediumStyle}" 
                                        Foreground="{DynamicResource AccentRedBrush}" 
                                        HorizontalAlignment="Center" 
                                        Margin="0,0,0,12"/>
                             <Grid Margin="0,0,0,8">
                                 <ProgressBar Value="{Binding GenerationProgress}" 
                                              Height="8" 
                                              Background="{DynamicResource TertiaryDarkBrush}" 
                                              Foreground="{DynamicResource AccentRedBrush}"/>
                                 <TextBlock Text="{Binding GenerationProgress, StringFormat='{}{0:F0}%'}" 
                                            Style="{DynamicResource CaptionTextStyle}" 
                                            Foreground="{DynamicResource TextPrimaryBrush}" 
                                            HorizontalAlignment="Center" 
                                            VerticalAlignment="Center" 
                                            FontWeight="SemiBold"/>
                             </Grid>
                             <TextBlock Text="{Binding GenerationStatus}" 
                                        Style="{DynamicResource BodyTextStyle}" 
                                        Foreground="{DynamicResource TextSecondaryBrush}" 
                                        HorizontalAlignment="Center" 
                                        Margin="0,0,0,12"/>
                             <Button Content="Cancel Generation" 
                                     Command="{Binding CancelCommand}" 
                                     Style="{DynamicResource SecondaryButtonStyle}"/>
                         </StackPanel>
                     </Border>

                     <!-- Image Actions Overlay -->
                     <StackPanel VerticalAlignment="Top" 
                                 HorizontalAlignment="Right" 
                                 Orientation="Horizontal" 
                                 Margin="16"
                                 Visibility="{Binding HasGeneratedImage, Converter={StaticResource BooleanToVisibilityConverter}}">
                         <Button Content="💾" 
                                 Command="{Binding SaveImageCommand}" 
                                 Style="{DynamicResource GhostButtonStyle}" 
                                 ToolTip="Save Image" 
                                 Margin="0,0,4,0"/>
                         <Button Content="📤" 
                                 Command="{Binding ExportImageCommand}" 
                                 Style="{DynamicResource GhostButtonStyle}" 
                                 ToolTip="Export" 
                                 Margin="0,0,4,0"/>
                         <Button Content="🔄" 
                                 Command="{Binding UseAsInitImageCommand}" 
                                 Style="{DynamicResource GhostButtonStyle}" 
                                 ToolTip="Use as Init Image"/>
                     </StackPanel>
                 </Grid>
             </Border>

             <!-- Right Panel: Gallery & Favorites -->
             <Border Grid.Column="2" 
                     Background="{DynamicResource TertiaryDarkBrush}" 
                     CornerRadius="0,8,8,0" 
                     Padding="16">
                 <StackPanel>
                     <TextBlock Text="🖼️ Gallery" 
                                Style="{DynamicResource HeadingSmallStyle}"
                                Foreground="{DynamicResource AccentRedBrush}"
                                Margin="0,0,0,16"/>

                     <!-- Image Gallery -->
                     <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="300" Margin="0,0,0,16">
                         <ItemsControl ItemsSource="{Binding ImageGallery}">
                             <ItemsControl.ItemTemplate>
                                 <DataTemplate>
                                     <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                             CornerRadius="6" 
                                             Padding="8" 
                                             Margin="0,0,0,8">
                                         <Grid>
                                             <Grid.RowDefinitions>
                                                 <RowDefinition Height="Auto"/>
                                                 <RowDefinition Height="Auto"/>
                                             </Grid.RowDefinitions>
                                             
                                             <!-- Thumbnail -->
                                             <Border Grid.Row="0" 
                                                     Background="{DynamicResource PrimaryDarkBrush}" 
                                                     Height="80" 
                                                     CornerRadius="4" 
                                                     Margin="0,0,0,6">
                                                 <Image Source="{Binding Source}" Stretch="UniformToFill"/>
                                             </Border>
                                             
                                             <!-- Info -->
                                             <StackPanel Grid.Row="1">
                                                 <TextBlock Text="{Binding TimeAgo}" 
                                                            Style="{DynamicResource CaptionTextStyle}" 
                                                            Foreground="{DynamicResource TextMutedBrush}" 
                                                            FontSize="10"/>
                                                 <TextBlock Text="{Binding Parameters}" 
                                                            Style="{DynamicResource CaptionTextStyle}" 
                                                            Foreground="{DynamicResource TextSecondaryBrush}" 
                                                            FontFamily="Consolas" 
                                                            FontSize="9"/>
                                             </StackPanel>
                                         </Grid>
                                     </Border>
                                 </DataTemplate>
                             </ItemsControl.ItemTemplate>
                         </ItemsControl>
                     </ScrollViewer>

                     <!-- Favorite Prompts -->
                     <TextBlock Text="⭐ Favorite Prompts" 
                                Style="{DynamicResource BodyTextStyle}" 
                                FontWeight="SemiBold" 
                                Foreground="{DynamicResource TextPrimaryBrush}" 
                                Margin="0,0,0,8"/>
                     
                     <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="200">
                         <ItemsControl ItemsSource="{Binding FavoritePrompts}">
                             <ItemsControl.ItemTemplate>
                                 <DataTemplate>
                                     <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                             CornerRadius="4" 
                                             Padding="8" 
                                             Margin="0,0,0,4">
                                         <Border.InputBindings>
                                             <MouseBinding Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.CopyPromptCommand}" 
                                                           CommandParameter="{Binding}" 
                                                           MouseAction="LeftClick"/>
                                         </Border.InputBindings>
                                         <TextBlock Text="{Binding}" 
                                                    Style="{DynamicResource CaptionTextStyle}" 
                                                    Foreground="{DynamicResource TextSecondaryBrush}" 
                                                    TextWrapping="Wrap" 
                                                    MaxHeight="30"/>
                                     </Border>
                                 </DataTemplate>
                             </ItemsControl.ItemTemplate>
                         </ItemsControl>
                     </ScrollViewer>
                 </StackPanel>
             </Border>
         </Grid>
     </DataTemplate>

     <!-- Image to Image View - Enthusiast Mode -->
     <DataTemplate x:Key="EnthusiastImage2ImageViewModelTemplate">
         <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
             <Grid.ColumnDefinitions>
                 <ColumnDefinition Width="320"/>
                 <ColumnDefinition Width="*"/>
                 <ColumnDefinition Width="280"/>
             </Grid.ColumnDefinitions>

             <!-- Left Panel: Controls & Upload -->
             <Border Grid.Column="0" 
                     Background="{DynamicResource TertiaryDarkBrush}" 
                     CornerRadius="8,0,0,8" 
                     Padding="16">
                 <ScrollViewer VerticalScrollBarVisibility="Auto">
                     <StackPanel>
                         <TextBlock Text="🔄 Image Transformation" 
                                    Style="{DynamicResource HeadingMediumStyle}"
                                    Foreground="{DynamicResource AccentRedBrush}"
                                    Margin="0,0,0,16"/>

                         <!-- Image Upload -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Source Image" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                             <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                     BorderBrush="{DynamicResource BorderBrush}" 
                                     BorderThickness="2" 
                                     CornerRadius="6" 
                                     Padding="16" 
                                     MinHeight="120"
                                     AllowDrop="True">
                                 <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                     <StackPanel Visibility="{Binding HasSourceImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                         <TextBlock Text="📁" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                         <TextBlock Text="Drop image or browse" 
                                                    Style="{DynamicResource BodyTextStyle}" 
                                                    Foreground="{DynamicResource TextSecondaryBrush}" 
                                                    HorizontalAlignment="Center" 
                                                    Margin="0,0,0,8"/>
                                         <Button Content="Browse" 
                                                 Command="{Binding LoadImageCommand}" 
                                                 Style="{DynamicResource SecondaryButtonStyle}" 
                                                 Padding="12,6"/>
                                     </StackPanel>
                                     
                                     <StackPanel Visibility="{Binding HasSourceImage, Converter={StaticResource BooleanToVisibilityConverter}}">
                                         <Image Source="{Binding SourceImageSource}" MaxHeight="80" Stretch="Uniform" Margin="0,0,0,6"/>
                                         <TextBlock Text="{Binding SourceImageInfo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                                     </StackPanel>
                                 </StackPanel>
                             </Border>
                             
                             <!-- Image Tools -->
                             <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,8,0,0" Visibility="{Binding HasSourceImage, Converter={StaticResource BooleanToVisibilityConverter}}">
                                 <Button Content="✂️" Command="{Binding CropImageCommand}" Style="{DynamicResource GhostButtonStyle}" ToolTip="Crop" Margin="0,0,4,0"/>
                                 <Button Content="🔄" Command="{Binding RotateImageCommand}" Style="{DynamicResource GhostButtonStyle}" ToolTip="Rotate" Margin="0,0,4,0"/>
                                 <Button Content="📏" Command="{Binding ResizeImageCommand}" Style="{DynamicResource GhostButtonStyle}" ToolTip="Resize" Margin="0,0,4,0"/>
                                 <Button Content="🗑️" Command="{Binding ClearImageCommand}" Style="{DynamicResource GhostButtonStyle}" ToolTip="Clear"/>
                             </StackPanel>
                         </StackPanel>

                         <!-- Edit Mode Selection -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Edit Mode" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                             <ComboBox ItemsSource="{Binding EditModes}" 
                                       SelectedItem="{Binding SelectedEditMode}" 
                                       Style="{DynamicResource DarkComboBoxStyle}"/>
                             
                             <!-- Inpainting Options -->
                             <StackPanel Margin="0,8,0,0" Visibility="{Binding UseInpainting, Converter={StaticResource BooleanToVisibilityConverter}}">
                                 <CheckBox Content="Enable Inpainting" IsChecked="{Binding UseInpainting}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,4"/>
                                 <CheckBox Content="Enable Outpainting" IsChecked="{Binding UseOutpainting}" Style="{DynamicResource DarkCheckBoxStyle}"/>
                             </StackPanel>
                         </StackPanel>

                         <!-- Prompt Input -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Transformation Prompt" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                             <TextBox Text="{Binding Prompt, UpdateSourceTrigger=PropertyChanged}"
                                      Style="{DynamicResource DarkTextBoxStyle}"
                                      MinHeight="60"
                                      TextWrapping="Wrap"
                                      AcceptsReturn="True"
                                      Tag="Describe how to transform the image..."/>
                         </StackPanel>

                         <!-- Parameters -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                             <StackPanel>
                                 <TextBlock Text="Transformation Settings" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,12"/>
                                 
                                 <!-- Strength -->
                                 <Grid Margin="0,0,0,8">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="60"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Strength" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <TextBox Grid.Column="1" Text="{Binding Strength, UpdateSourceTrigger=PropertyChanged, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>
                                 <Slider Value="{Binding Strength}" Minimum="0.1" Maximum="1.0" TickFrequency="0.05" Margin="0,0,0,8"/>

                                 <!-- Steps -->
                                 <Grid Margin="0,0,0,8">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="60"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Quality (Steps)" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <TextBox Grid.Column="1" Text="{Binding Steps, UpdateSourceTrigger=PropertyChanged}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>
                                 <Slider Value="{Binding Steps}" Minimum="15" Maximum="50" TickFrequency="5" Margin="0,0,0,8"/>

                                 <!-- CFG Scale -->
                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="60"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Guidance (CFG)" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <TextBox Grid.Column="1" Text="{Binding CfgScale, UpdateSourceTrigger=PropertyChanged, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>
                                 <Slider Value="{Binding CfgScale}" Minimum="1" Maximum="20" TickFrequency="0.5"/>
                             </StackPanel>
                         </Border>

                         <!-- Generate Button -->
                         <Button Content="🎨 Transform" 
                                 Command="{Binding GenerateCommand}" 
                                 Style="{DynamicResource PrimaryButtonStyle}" 
                                 Padding="0,12" 
                                 FontSize="14" 
                                 FontWeight="SemiBold"
                                 IsEnabled="{Binding CanGenerate}"/>
                     </StackPanel>
                 </ScrollViewer>
             </Border>

             <!-- Center Panel: Before/After Comparison -->
             <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                 <Grid>
                     <Grid.RowDefinitions>
                         <RowDefinition Height="Auto"/>
                         <RowDefinition Height="*"/>
                         <RowDefinition Height="Auto"/>
                     </Grid.RowDefinitions>

                     <!-- Comparison Header -->
                     <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,12">
                         <TextBlock Text="📷 Before" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,40,0"/>
                         <Button Content="↔️" Style="{DynamicResource GhostButtonStyle}" Command="{Binding SwapImagesCommand}" ToolTip="Swap Images" Margin="0,0,40,0"/>
                         <TextBlock Text="✨ After" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource AccentRedBrush}"/>
                     </StackPanel>

                     <!-- Before/After Comparison -->
                     <Grid Grid.Row="1">
                         <Grid.ColumnDefinitions>
                             <ColumnDefinition Width="*"/>
                             <ColumnDefinition Width="*"/>
                         </Grid.ColumnDefinitions>

                         <!-- Before (Source) -->
                         <Border Grid.Column="0" 
                                 Background="{DynamicResource TertiaryDarkBrush}" 
                                 CornerRadius="8" 
                                 BorderBrush="{DynamicResource BorderBrush}" 
                                 BorderThickness="1" 
                                 Margin="0,0,8,0">
                             <Grid>
                                 <Image Source="{Binding SourceImageSource}" 
                                        Stretch="Uniform"
                                        Visibility="{Binding HasSourceImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                 <StackPanel HorizontalAlignment="Center" 
                                             VerticalAlignment="Center"
                                             Visibility="{Binding HasSourceImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                     <TextBlock Text="📷" FontSize="48" HorizontalAlignment="Center" Opacity="0.3"/>
                                     <TextBlock Text="Original" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                 </StackPanel>
                             </Grid>
                         </Border>

                         <!-- After (Result) -->
                         <Border Grid.Column="1" 
                                 Background="{DynamicResource TertiaryDarkBrush}" 
                                 CornerRadius="8" 
                                 BorderBrush="{DynamicResource BorderBrush}" 
                                 BorderThickness="1" 
                                 Margin="8,0,0,0">
                             <Grid>
                                 <Image Source="{Binding GeneratedImageSource}" 
                                        Stretch="Uniform"
                                        Visibility="{Binding HasGeneratedImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                 <StackPanel HorizontalAlignment="Center" 
                                             VerticalAlignment="Center"
                                             Visibility="{Binding HasGeneratedImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                     <TextBlock Text="✨" FontSize="48" HorizontalAlignment="Center" Opacity="0.3"/>
                                     <TextBlock Text="Result" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                 </StackPanel>

                                 <!-- Generation Progress -->
                                 <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                         CornerRadius="8" 
                                         Padding="16" 
                                         HorizontalAlignment="Center" 
                                         VerticalAlignment="Center"
                                         Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToVisibilityConverter}}">
                                     <StackPanel HorizontalAlignment="Center">
                                         <TextBlock Text="🔄 Processing..." 
                                                    Style="{DynamicResource HeadingSmallStyle}" 
                                                    Foreground="{DynamicResource AccentRedBrush}" 
                                                    HorizontalAlignment="Center" 
                                                    Margin="0,0,0,8"/>
                                         <ProgressBar Value="{Binding GenerationProgress}" 
                                                      Width="200" 
                                                      Height="6" 
                                                      Background="{DynamicResource TertiaryDarkBrush}" 
                                                      Foreground="{DynamicResource AccentRedBrush}"/>
                                         <TextBlock Text="{Binding GenerationProgress, StringFormat='{}{0:F0}%'}" 
                                                    Style="{DynamicResource CaptionTextStyle}" 
                                                    Foreground="{DynamicResource TextPrimaryBrush}" 
                                                    HorizontalAlignment="Center" 
                                                    Margin="0,4,0,0"/>
                                     </StackPanel>
                                 </Border>
                             </Grid>
                         </Border>
                     </Grid>

                     <!-- Action Bar -->
                     <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,12,0,0">
                         <Button Content="💾 Save Result" 
                                 Command="{Binding SaveResultCommand}" 
                                 Style="{DynamicResource SecondaryButtonStyle}" 
                                 Margin="0,0,8,0"
                                 Visibility="{Binding HasGeneratedImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                         <Button Content="📤 Export" 
                                 Command="{Binding ExportResultCommand}" 
                                 Style="{DynamicResource SecondaryButtonStyle}" 
                                 Margin="0,0,8,0"
                                 Visibility="{Binding HasGeneratedImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                         <Button Content="⏹ Cancel" 
                                 Command="{Binding CancelCommand}" 
                                 Style="{DynamicResource SecondaryButtonStyle}"
                                 Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                     </StackPanel>
                 </Grid>
             </Border>

             <!-- Right Panel: History & Favorites -->
             <Border Grid.Column="2" 
                     Background="{DynamicResource TertiaryDarkBrush}" 
                     CornerRadius="0,8,8,0" 
                     Padding="16">
                 <StackPanel>
                     <TextBlock Text="📚 History &amp; Results" 
                                Style="{DynamicResource HeadingSmallStyle}"
                                Foreground="{DynamicResource AccentRedBrush}"
                                Margin="0,0,0,16"/>

                     <!-- Generation Status -->
                     <Border Background="{DynamicResource SecondaryDarkBrush}" 
                             CornerRadius="6" 
                             Padding="12" 
                             Margin="0,0,0,16">
                         <StackPanel>
                             <TextBlock Text="Status" 
                                        Style="{DynamicResource BodyTextStyle}" 
                                        FontWeight="SemiBold" 
                                        Foreground="{DynamicResource TextPrimaryBrush}" 
                                        Margin="0,0,0,6"/>
                             <TextBlock Text="{Binding GenerationStatus}" 
                                        Style="{DynamicResource CaptionTextStyle}" 
                                        Foreground="{DynamicResource TextSecondaryBrush}" 
                                        TextWrapping="Wrap"/>
                         </StackPanel>
                     </Border>

                     <!-- Recent History -->
                     <TextBlock Text="Recent Transformations" 
                                Style="{DynamicResource BodyTextStyle}" 
                                FontWeight="SemiBold" 
                                Foreground="{DynamicResource TextPrimaryBrush}" 
                                Margin="0,0,0,8"/>
                     
                     <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="300" Margin="0,0,0,16">
                         <ItemsControl ItemsSource="{Binding GenerationHistory}">
                             <ItemsControl.ItemTemplate>
                                 <DataTemplate>
                                     <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                             CornerRadius="6" 
                                             Padding="10" 
                                             Margin="0,0,0,6"
                                             BorderBrush="{DynamicResource BorderBrush}"
                                             BorderThickness="1">
                                         <StackPanel>
                                             <Grid>
                                                 <Grid.ColumnDefinitions>
                                                     <ColumnDefinition Width="Auto"/>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="Auto"/>
                                                 </Grid.ColumnDefinitions>
                                                 <TextBlock Grid.Column="0" Text="{Binding EditModeIcon}" FontSize="16" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                                 <TextBlock Grid.Column="1" Text="{Binding PromptPreview}" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" TextWrapping="Wrap" MaxHeight="30"/>
                                                 <TextBlock Grid.Column="2" Text="{Binding TimeAgo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" VerticalAlignment="Top"/>
                                             </Grid>
                                             <TextBlock Text="{Binding ParametersText}" 
                                                        Style="{DynamicResource CaptionTextStyle}" 
                                                        Foreground="{DynamicResource TextSecondaryBrush}" 
                                                        FontFamily="Consolas" 
                                                        FontSize="10" 
                                                        Margin="0,4,0,0"/>
                                         </StackPanel>
                                     </Border>
                                 </DataTemplate>
                             </ItemsControl.ItemTemplate>
                         </ItemsControl>
                     </ScrollViewer>

                     <!-- Quick Actions -->
                     <StackPanel>
                         <Button Content="⭐ Add to Favorites" 
                                 Command="{Binding AddToFavoritesCommand}" 
                                 Style="{DynamicResource SecondaryButtonStyle}" 
                                 Margin="0,0,0,6"/>
                         <Button Content="🗑️ Clear History" 
                                 Command="{Binding ClearHistoryCommand}" 
                                 Style="{DynamicResource SecondaryButtonStyle}"/>
                     </StackPanel>
                 </StackPanel>
             </Border>
         </Grid>
     </DataTemplate>

     <!-- Inpainting View - Enthusiast Mode -->
     <DataTemplate x:Key="EnthusiastInpaintingViewModelTemplate">
         <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
             <Grid.ColumnDefinitions>
                 <ColumnDefinition Width="300"/>
                 <ColumnDefinition Width="*"/>
                 <ColumnDefinition Width="280"/>
             </Grid.ColumnDefinitions>

             <!-- Left Panel: Tools & Controls -->
             <Border Grid.Column="0" 
                     Background="{DynamicResource TertiaryDarkBrush}" 
                     CornerRadius="8,0,0,8" 
                     Padding="16">
                 <ScrollViewer VerticalScrollBarVisibility="Auto">
                     <StackPanel>
                         <TextBlock Text="🖌️ Inpainting Studio" 
                                    Style="{DynamicResource HeadingMediumStyle}"
                                    Foreground="{DynamicResource AccentRedBrush}"
                                    Margin="0,0,0,16"/>

                         <!-- Image Upload -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Source Image" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                             <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                     BorderBrush="{DynamicResource BorderBrush}" 
                                     BorderThickness="2" 
                                     CornerRadius="6" 
                                     Padding="12" 
                                     MinHeight="100"
                                     AllowDrop="True">
                                 <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                     <StackPanel Visibility="{Binding HasSourceImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                         <TextBlock Text="📁" FontSize="20" HorizontalAlignment="Center" Margin="0,0,0,6"/>
                                         <Button Content="Load Image" Command="{Binding LoadImageCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                                     </StackPanel>
                                     <StackPanel Visibility="{Binding HasSourceImage, Converter={StaticResource BooleanToVisibilityConverter}}">
                                         <Image Source="{Binding SourceImageSource}" MaxHeight="60" Stretch="Uniform" Margin="0,0,0,4"/>
                                         <TextBlock Text="{Binding SourceImageInfo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" FontSize="10"/>
                                     </StackPanel>
                                 </StackPanel>
                             </Border>
                         </StackPanel>

                         <!-- Brush Tools -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                             <StackPanel>
                                 <TextBlock Text="Brush Tools" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                 
                                 <!-- Brush Mode -->
                                 <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                     <Button Content="🖌️" Command="{Binding SetBrushModeCommand}" CommandParameter="Paint" Style="{DynamicResource GhostButtonStyle}" ToolTip="Paint" Margin="0,0,4,0"/>
                                     <Button Content="🧽" Command="{Binding SetBrushModeCommand}" CommandParameter="Erase" Style="{DynamicResource GhostButtonStyle}" ToolTip="Erase" Margin="0,0,4,0"/>
                                     <Button Content="🔍" Command="{Binding SetBrushModeCommand}" CommandParameter="Blur" Style="{DynamicResource GhostButtonStyle}" ToolTip="Blur" Margin="0,0,4,0"/>
                                     <Button Content="🗑️" Command="{Binding ClearMaskCommand}" Style="{DynamicResource GhostButtonStyle}" ToolTip="Clear All"/>
                                 </StackPanel>

                                 <!-- Brush Size -->
                                 <Grid Margin="0,0,0,8">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="50"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Brush Size" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <TextBox Grid.Column="1" Text="{Binding BrushSize, UpdateSourceTrigger=PropertyChanged, StringFormat=F0}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>
                                 <Slider Value="{Binding BrushSize}" Minimum="1" Maximum="100" TickFrequency="1" Margin="0,0,0,8"/>

                                 <!-- Brush Hardness -->
                                 <Grid Margin="0,0,0,8">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="50"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Hardness" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <TextBox Grid.Column="1" Text="{Binding BrushHardness, UpdateSourceTrigger=PropertyChanged, StringFormat=P0}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>
                                 <Slider Value="{Binding BrushHardness}" Minimum="0" Maximum="1" TickFrequency="0.1"/>
                             </StackPanel>
                         </Border>

                         <!-- Inpainting Parameters -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                             <StackPanel>
                                 <TextBlock Text="Inpainting Settings" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                 
                                 <!-- Strength -->
                                 <Grid Margin="0,0,0,6">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="50"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Strength" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <TextBox Grid.Column="1" Text="{Binding Strength, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>
                                 <Slider Value="{Binding Strength}" Minimum="0.1" Maximum="1.0" TickFrequency="0.05" Margin="0,0,0,6"/>

                                 <!-- Steps -->
                                 <Grid Margin="0,0,0,6">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="50"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Steps" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <TextBox Grid.Column="1" Text="{Binding Steps}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>
                                 <Slider Value="{Binding Steps}" Minimum="15" Maximum="50" TickFrequency="5" Margin="0,0,0,6"/>

                                 <!-- CFG Scale -->
                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="50"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Guidance" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <TextBox Grid.Column="1" Text="{Binding CfgScale, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>
                                 <Slider Value="{Binding CfgScale}" Minimum="1" Maximum="20" TickFrequency="0.5"/>
                             </StackPanel>
                         </Border>

                         <!-- Prompt -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Inpainting Prompt" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                             <TextBox Text="{Binding Prompt, UpdateSourceTrigger=PropertyChanged}"
                                      Style="{DynamicResource DarkTextBoxStyle}"
                                      MinHeight="60"
                                      TextWrapping="Wrap"
                                      AcceptsReturn="True"
                                      Tag="Describe what should fill the masked area..."/>
                         </StackPanel>

                         <!-- Options -->
                         <StackPanel Margin="0,0,0,16">
                             <CheckBox Content="Enable Outpainting" IsChecked="{Binding EnableOutpainting}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,4"/>
                             <CheckBox Content="Show Mask Overlay" IsChecked="{Binding ShowMaskOverlay}" Style="{DynamicResource DarkCheckBoxStyle}"/>
                         </StackPanel>

                         <!-- Generate Button -->
                         <Button Content="🎨 Generate" 
                                 Command="{Binding GenerateCommand}" 
                                 Style="{DynamicResource PrimaryButtonStyle}" 
                                 Padding="0,12" 
                                 FontSize="14" 
                                 FontWeight="SemiBold"
                                 IsEnabled="{Binding CanGenerate}"/>
                     </StackPanel>
                 </ScrollViewer>
             </Border>

             <!-- Center Panel: Canvas -->
             <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                 <Grid>
                     <Grid.RowDefinitions>
                         <RowDefinition Height="Auto"/>
                         <RowDefinition Height="*"/>
                         <RowDefinition Height="Auto"/>
                     </Grid.RowDefinitions>

                     <!-- Canvas Header -->
                     <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,12">
                         <TextBlock Text="🖌️ Paint to mask areas" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" VerticalAlignment="Center" Margin="0,0,16,0"/>
                         <Button Content="↶" Command="{Binding UndoMaskCommand}" Style="{DynamicResource GhostButtonStyle}" ToolTip="Undo" Margin="0,0,4,0"/>
                         <Button Content="↷" Command="{Binding RedoMaskCommand}" Style="{DynamicResource GhostButtonStyle}" ToolTip="Redo" Margin="0,0,12,0"/>
                         <TextBlock Text="{Binding BrushInfo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" VerticalAlignment="Center" FontFamily="Consolas"/>
                     </StackPanel>

                     <!-- Main Canvas -->
                     <Border Grid.Row="1" 
                             Background="{DynamicResource TertiaryDarkBrush}" 
                             CornerRadius="8" 
                             BorderBrush="{DynamicResource BorderBrush}" 
                             BorderThickness="1">
                         <Grid>
                             <!-- Source Image -->
                             <Image Source="{Binding SourceImageSource}" 
                                    Stretch="Uniform"
                                    Visibility="{Binding HasSourceImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                             <!-- Mask Overlay -->
                             <Image Source="{Binding MaskImageSource}" 
                                    Stretch="Uniform" 
                                    Opacity="0.7"
                                    Visibility="{Binding HasMask, Converter={StaticResource BooleanToVisibilityConverter}}">
                                 <Image.OpacityMask>
                                     <SolidColorBrush Color="Red" Opacity="0.5"/>
                                 </Image.OpacityMask>
                             </Image>

                             <!-- Result Preview -->
                             <Image Source="{Binding GeneratedImageSource}" 
                                    Stretch="Uniform"
                                    Visibility="{Binding HasGeneratedImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                             <!-- Empty State -->
                             <StackPanel HorizontalAlignment="Center" 
                                         VerticalAlignment="Center"
                                         Visibility="{Binding HasSourceImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                 <TextBlock Text="🖼️" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,16" Opacity="0.3"/>
                                 <TextBlock Text="Inpainting Canvas" 
                                            Style="{DynamicResource HeadingMediumStyle}" 
                                            Foreground="{DynamicResource TextMutedBrush}" 
                                            HorizontalAlignment="Center"/>
                                 <TextBlock Text="Load an image to begin editing" 
                                            Style="{DynamicResource BodyTextStyle}" 
                                            Foreground="{DynamicResource TextMutedBrush}" 
                                            HorizontalAlignment="Center" 
                                            Margin="0,8,0,0"/>
                             </StackPanel>

                             <!-- Generation Progress -->
                             <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                     CornerRadius="8" 
                                     Padding="20" 
                                     HorizontalAlignment="Center" 
                                     VerticalAlignment="Center"
                                     Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToVisibilityConverter}}">
                                 <StackPanel HorizontalAlignment="Center">
                                     <TextBlock Text="🖌️ Inpainting..." 
                                                Style="{DynamicResource HeadingMediumStyle}" 
                                                Foreground="{DynamicResource AccentRedBrush}" 
                                                HorizontalAlignment="Center" 
                                                Margin="0,0,0,12"/>
                                     <Grid Margin="0,0,0,8">
                                         <ProgressBar Value="{Binding GenerationProgress}" 
                                                      Height="8" 
                                                      Width="250" 
                                                      Background="{DynamicResource TertiaryDarkBrush}" 
                                                      Foreground="{DynamicResource AccentRedBrush}"/>
                                         <TextBlock Text="{Binding GenerationProgress, StringFormat='{}{0:F0}%'}" 
                                                    Style="{DynamicResource CaptionTextStyle}" 
                                                    Foreground="{DynamicResource TextPrimaryBrush}" 
                                                    HorizontalAlignment="Center" 
                                                    VerticalAlignment="Center" 
                                                    FontWeight="SemiBold"/>
                                     </Grid>
                                     <TextBlock Text="{Binding GenerationStatus}" 
                                                Style="{DynamicResource BodyTextStyle}" 
                                                Foreground="{DynamicResource TextSecondaryBrush}" 
                                                HorizontalAlignment="Center"/>
                                 </StackPanel>
                             </Border>
                         </Grid>
                     </Border>

                     <!-- Canvas Tools -->
                     <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,12,0,0">
                         <Button Content="💾 Save Result" 
                                 Command="{Binding SaveResultCommand}" 
                                 Style="{DynamicResource SecondaryButtonStyle}" 
                                 Margin="0,0,8,0"
                                 Visibility="{Binding HasGeneratedImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                         <Button Content="📤 Export Mask" 
                                 Command="{Binding ExportMaskCommand}" 
                                 Style="{DynamicResource SecondaryButtonStyle}" 
                                 Margin="0,0,8,0"
                                 Visibility="{Binding HasMask, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                         <Button Content="⏹ Cancel" 
                                 Command="{Binding CancelCommand}" 
                                 Style="{DynamicResource SecondaryButtonStyle}"
                                 Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                     </StackPanel>
                 </Grid>
             </Border>

             <!-- Right Panel: History & Templates -->
             <Border Grid.Column="2" 
                     Background="{DynamicResource TertiaryDarkBrush}" 
                     CornerRadius="0,8,8,0" 
                     Padding="16">
                 <StackPanel>
                     <TextBlock Text="📚 History &amp; Tools" 
                                Style="{DynamicResource HeadingSmallStyle}"
                                Foreground="{DynamicResource AccentRedBrush}"
                                Margin="0,0,0,16"/>

                     <!-- Mask Templates -->
                     <StackPanel Margin="0,0,0,16">
                         <TextBlock Text="Mask Templates" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                         <ItemsControl ItemsSource="{Binding MaskTemplates}">
                             <ItemsControl.ItemTemplate>
                                 <DataTemplate>
                                     <Button Content="{Binding}" 
                                             Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.ApplyMaskTemplateCommand}" 
                                             CommandParameter="{Binding}" 
                                             Style="{DynamicResource SecondaryButtonStyle}" 
                                             Margin="0,0,0,4" 
                                             HorizontalAlignment="Stretch"/>
                                 </DataTemplate>
                             </ItemsControl.ItemTemplate>
                         </ItemsControl>
                     </StackPanel>

                     <!-- Generation Status -->
                     <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                         <StackPanel>
                             <TextBlock Text="Status" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                             <TextBlock Text="{Binding GenerationStatus}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap"/>
                         </StackPanel>
                     </Border>

                     <!-- Recent History -->
                     <TextBlock Text="Recent Inpainting" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                     <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="250">
                         <ItemsControl ItemsSource="{Binding GenerationHistory}">
                             <ItemsControl.ItemTemplate>
                                 <DataTemplate>
                                     <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                             CornerRadius="4" 
                                             Padding="8" 
                                             Margin="0,0,0,6"
                                             BorderBrush="{DynamicResource BorderBrush}"
                                             BorderThickness="1">
                                         <StackPanel>
                                             <Grid>
                                                 <Grid.ColumnDefinitions>
                                                     <ColumnDefinition Width="Auto"/>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="Auto"/>
                                                 </Grid.ColumnDefinitions>
                                                 <TextBlock Grid.Column="0" Text="{Binding PresetIcon}" FontSize="14" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                                 <TextBlock Grid.Column="1" Text="{Binding PromptPreview}" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" TextWrapping="Wrap" MaxHeight="25"/>
                                                 <TextBlock Grid.Column="2" Text="{Binding TimeAgo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" VerticalAlignment="Top"/>
                                             </Grid>
                                             <TextBlock Text="{Binding ParametersText}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontFamily="Consolas" FontSize="9" Margin="0,4,0,0"/>
                                         </StackPanel>
                                     </Border>
                                 </DataTemplate>
                             </ItemsControl.ItemTemplate>
                         </ItemsControl>
                     </ScrollViewer>
                 </StackPanel>
             </Border>
         </Grid>
     </DataTemplate>

     <!-- Upscaling View - Enthusiast Mode -->
     <DataTemplate x:Key="EnthusiastUpscalingViewModelTemplate">
         <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
             <Grid.ColumnDefinitions>
                 <ColumnDefinition Width="320"/>
                 <ColumnDefinition Width="*"/>
                 <ColumnDefinition Width="280"/>
             </Grid.ColumnDefinitions>

             <!-- Left Panel: Controls -->
             <Border Grid.Column="0" 
                     Background="{DynamicResource TertiaryDarkBrush}" 
                     CornerRadius="8,0,0,8" 
                     Padding="16">
                 <ScrollViewer VerticalScrollBarVisibility="Auto">
                     <StackPanel>
                         <TextBlock Text="🔍 Image Upscaling" 
                                    Style="{DynamicResource HeadingMediumStyle}"
                                    Foreground="{DynamicResource AccentRedBrush}"
                                    Margin="0,0,0,16"/>

                         <!-- Image Upload -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Source Image" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                             <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                     BorderBrush="{DynamicResource BorderBrush}" 
                                     BorderThickness="2" 
                                     CornerRadius="6" 
                                     Padding="16" 
                                     MinHeight="120"
                                     AllowDrop="True">
                                 <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                     <StackPanel Visibility="{Binding HasSourceImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                         <TextBlock Text="📁" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                         <Button Content="Load Image" Command="{Binding LoadImageCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                                         <Button Content="Load Multiple" Command="{Binding LoadMultipleImagesCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                                     </StackPanel>
                                     
                                     <StackPanel Visibility="{Binding HasSourceImage, Converter={StaticResource BooleanToVisibilityConverter}}">
                                         <Image Source="{Binding SourceImageSource}" MaxHeight="80" Stretch="Uniform" Margin="0,0,0,6"/>
                                         <TextBlock Text="{Binding SourceImageInfo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" FontSize="10"/>
                                         <Button Content="🗑️ Clear" Command="{Binding ClearImageCommand}" Style="{DynamicResource GhostButtonStyle}" Margin="0,6,0,0"/>
                                     </StackPanel>
                                 </StackPanel>
                             </Border>
                         </StackPanel>

                         <!-- Scale Control -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Scale Factor" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                             <Grid Margin="0,0,0,8">
                                 <Grid.ColumnDefinitions>
                                     <ColumnDefinition Width="*"/>
                                     <ColumnDefinition Width="60"/>
                                 </Grid.ColumnDefinitions>
                                 <Slider Value="{Binding ScaleFactor}" Minimum="1.5" Maximum="8.0" TickFrequency="0.5" TickPlacement="BottomRight"/>
                                 <TextBox Grid.Column="1" Text="{Binding ScaleFactor, UpdateSourceTrigger=PropertyChanged, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" Margin="8,0,0,0"/>
                             </Grid>
                             <ItemsControl ItemsSource="{Binding CommonScales}">
                                 <ItemsControl.ItemsPanel>
                                     <ItemsPanelTemplate>
                                         <WrapPanel/>
                                     </ItemsPanelTemplate>
                                 </ItemsControl.ItemsPanel>
                                 <ItemsControl.ItemTemplate>
                                     <DataTemplate>
                                         <Button Content="{Binding}" 
                                                 Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.SetScaleFactorCommand}" 
                                                 CommandParameter="{Binding}" 
                                                 Style="{DynamicResource GhostButtonStyle}" 
                                                 Padding="8,4" 
                                                 Margin="0,0,4,4"/>
                                     </DataTemplate>
                                 </ItemsControl.ItemTemplate>
                             </ItemsControl>
                         </StackPanel>

                         <!-- Model Selection -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Upscaling Model" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                             <ComboBox ItemsSource="{Binding AvailableModels}" 
                                       SelectedItem="{Binding SelectedModel}" 
                                       Style="{DynamicResource DarkComboBoxStyle}"/>
                         </StackPanel>

                         <!-- Quality Settings -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                             <StackPanel>
                                 <TextBlock Text="Quality Settings" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                 <ComboBox ItemsSource="{Binding QualityModes}" 
                                           SelectedItem="{Binding QualityMode}" 
                                           Style="{DynamicResource DarkComboBoxStyle}" 
                                           Margin="0,0,0,8"/>
                                 <CheckBox Content="Face Enhancement" IsChecked="{Binding EnableFaceEnhancement}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,4"/>
                                 <CheckBox Content="Noise Reduction" IsChecked="{Binding EnableDenoising}" Style="{DynamicResource DarkCheckBoxStyle}"/>
                             </StackPanel>
                         </Border>

                         <!-- Processing Info -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                             <StackPanel>
                                 <TextBlock Text="Processing Info" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="*"/>
                                     </Grid.ColumnDefinitions>
                                     <StackPanel Grid.Column="0">
                                         <TextBlock Text="Output Size:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                         <TextBlock Text="{Binding EstimatedOutputSize}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}"/>
                                     </StackPanel>
                                     <StackPanel Grid.Column="1">
                                         <TextBlock Text="Est. Time:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                         <TextBlock Text="{Binding EstimatedTime}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}"/>
                                     </StackPanel>
                                 </Grid>
                             </StackPanel>
                         </Border>

                         <!-- Generate Button -->
                         <Button Content="🔍 Upscale Image" 
                                 Command="{Binding UpscaleCommand}" 
                                 Style="{DynamicResource PrimaryButtonStyle}" 
                                 Padding="0,12" 
                                 FontSize="14" 
                                 FontWeight="SemiBold"
                                 IsEnabled="{Binding CanUpscale}"/>
                     </StackPanel>
                 </ScrollViewer>
             </Border>

             <!-- Center Panel: Before/After Comparison -->
             <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                 <Grid>
                     <Grid.RowDefinitions>
                         <RowDefinition Height="Auto"/>
                         <RowDefinition Height="*"/>
                         <RowDefinition Height="Auto"/>
                     </Grid.RowDefinitions>

                     <!-- Comparison Header -->
                     <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,12">
                         <TextBlock Text="📷 Original" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,40,0"/>
                         <Button Content="⚖️" Command="{Binding CompareResultsCommand}" Style="{DynamicResource GhostButtonStyle}" ToolTip="Compare Side by Side" Margin="0,0,40,0"/>
                         <TextBlock Text="✨ Enhanced" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource AccentRedBrush}"/>
                     </StackPanel>

                     <!-- Before/After Comparison -->
                     <Grid Grid.Row="1">
                         <Grid.ColumnDefinitions>
                             <ColumnDefinition Width="*"/>
                             <ColumnDefinition Width="*"/>
                         </Grid.ColumnDefinitions>

                         <!-- Before (Original) -->
                         <Border Grid.Column="0" 
                                 Background="{DynamicResource TertiaryDarkBrush}" 
                                 CornerRadius="8" 
                                 BorderBrush="{DynamicResource BorderBrush}" 
                                 BorderThickness="1" 
                                 Margin="0,0,8,0">
                             <Grid>
                                 <Image Source="{Binding SourceImageSource}" 
                                        Stretch="Uniform"
                                        Visibility="{Binding HasSourceImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                 <StackPanel HorizontalAlignment="Center" 
                                             VerticalAlignment="Center"
                                             Visibility="{Binding HasSourceImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                     <TextBlock Text="📷" FontSize="48" HorizontalAlignment="Center" Opacity="0.3"/>
                                     <TextBlock Text="Original" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                 </StackPanel>
                                 <TextBlock Text="BEFORE" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="8" FontWeight="SemiBold"/>
                             </Grid>
                         </Border>

                         <!-- After (Result) -->
                         <Border Grid.Column="1" 
                                 Background="{DynamicResource TertiaryDarkBrush}" 
                                 CornerRadius="8" 
                                 BorderBrush="{DynamicResource BorderBrush}" 
                                 BorderThickness="1" 
                                 Margin="8,0,0,0">
                             <Grid>
                                 <Image Source="{Binding UpscaledImageSource}" 
                                        Stretch="Uniform"
                                        Visibility="{Binding HasUpscaledImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                 <StackPanel HorizontalAlignment="Center" 
                                             VerticalAlignment="Center"
                                             Visibility="{Binding HasUpscaledImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                     <TextBlock Text="✨" FontSize="48" HorizontalAlignment="Center" Opacity="0.3"/>
                                     <TextBlock Text="Enhanced" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                 </StackPanel>

                                 <!-- Processing Progress -->
                                 <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                         CornerRadius="8" 
                                         Padding="16" 
                                         HorizontalAlignment="Center" 
                                         VerticalAlignment="Center"
                                         Visibility="{Binding IsUpscaling, Converter={StaticResource BooleanToVisibilityConverter}}">
                                     <StackPanel HorizontalAlignment="Center">
                                         <TextBlock Text="🔍 Upscaling..." 
                                                    Style="{DynamicResource HeadingSmallStyle}" 
                                                    Foreground="{DynamicResource AccentRedBrush}" 
                                                    HorizontalAlignment="Center" 
                                                    Margin="0,0,0,8"/>
                                         <Grid Margin="0,0,0,6">
                                             <ProgressBar Value="{Binding UpscalingProgress}" 
                                                          Width="200" 
                                                          Height="6" 
                                                          Background="{DynamicResource TertiaryDarkBrush}" 
                                                          Foreground="{DynamicResource AccentRedBrush}"/>
                                             <TextBlock Text="{Binding UpscalingProgress, StringFormat='{}{0:F0}%'}" 
                                                        Style="{DynamicResource CaptionTextStyle}" 
                                                        Foreground="{DynamicResource TextPrimaryBrush}" 
                                                        HorizontalAlignment="Center" 
                                                        VerticalAlignment="Center" 
                                                        FontWeight="SemiBold"/>
                                         </Grid>
                                         <TextBlock Text="{Binding UpscalingStatus}" 
                                                    Style="{DynamicResource CaptionTextStyle}" 
                                                    Foreground="{DynamicResource TextSecondaryBrush}" 
                                                    HorizontalAlignment="Center"/>
                                     </StackPanel>
                                 </Border>
                                 <TextBlock Text="AFTER" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="8" FontWeight="SemiBold"/>
                             </Grid>
                         </Border>
                     </Grid>

                     <!-- Action Bar -->
                     <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,16,0,0">
                         <Button Content="💾 Save Result" 
                                 Command="{Binding SaveResultCommand}" 
                                 Style="{DynamicResource SecondaryButtonStyle}" 
                                 Margin="0,0,8,0"
                                 Visibility="{Binding HasUpscaledImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                         <Button Content="📤 Export" 
                                 Command="{Binding ExportResultCommand}" 
                                 Style="{DynamicResource SecondaryButtonStyle}" 
                                 Margin="0,0,8,0"
                                 Visibility="{Binding HasUpscaledImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                         <Button Content="⚖️ Compare" 
                                 Command="{Binding CompareResultsCommand}" 
                                 Style="{DynamicResource SecondaryButtonStyle}" 
                                 Visibility="{Binding HasUpscaledImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                     </StackPanel>
                 </Grid>
             </Border>

             <!-- Right Panel: Batch & History -->
             <Border Grid.Column="2" 
                     Background="{DynamicResource TertiaryDarkBrush}" 
                     CornerRadius="0,8,8,0" 
                     Padding="16">
                 <StackPanel>
                     <TextBlock Text="📚 Batch &amp; History" 
                                Style="{DynamicResource HeadingSmallStyle}"
                                Foreground="{DynamicResource AccentRedBrush}"
                                Margin="0,0,0,16"/>

                     <!-- Batch Queue -->
                     <StackPanel Margin="0,0,0,16" Visibility="{Binding ProcessingQueue.Count, Converter={StaticResource ZeroToVisibilityConverter}, ConverterParameter=Inverse}">
                         <TextBlock Text="Batch Queue" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12">
                             <StackPanel>
                                 <TextBlock Text="{Binding ProcessingQueue.Count, StringFormat='{}{0} images queued'}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,8"/>
                                 <Button Content="🚀 Process Batch" Command="{Binding BatchUpscaleCommand}" Style="{DynamicResource PrimaryButtonStyle}" Padding="0,8"/>
                             </StackPanel>
                         </Border>
                     </StackPanel>

                     <!-- Processing Status -->
                     <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                         <StackPanel>
                             <TextBlock Text="Status" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                             <TextBlock Text="{Binding UpscalingStatus}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap"/>
                         </StackPanel>
                     </Border>

                     <!-- Recent History -->
                     <TextBlock Text="Recent Upscaling" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                     <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="300">
                         <ItemsControl ItemsSource="{Binding UpscalingHistory}">
                             <ItemsControl.ItemTemplate>
                                 <DataTemplate>
                                     <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                             CornerRadius="6" 
                                             Padding="10" 
                                             Margin="0,0,0,6"
                                             BorderBrush="{DynamicResource BorderBrush}"
                                             BorderThickness="1">
                                         <StackPanel>
                                             <Grid>
                                                 <Grid.ColumnDefinitions>
                                                     <ColumnDefinition Width="Auto"/>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="Auto"/>
                                                 </Grid.ColumnDefinitions>
                                                 <TextBlock Grid.Column="0" Text="{Binding ScaleText}" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource AccentRedBrush}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                                 <TextBlock Grid.Column="1" Text="{Binding ModelText}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextPrimaryBrush}" VerticalAlignment="Center"/>
                                                 <TextBlock Grid.Column="2" Text="{Binding TimeAgo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" VerticalAlignment="Center"/>
                                             </Grid>
                                             <Grid Margin="0,4,0,0">
                                                 <Grid.ColumnDefinitions>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="*"/>
                                                 </Grid.ColumnDefinitions>
                                                 <TextBlock Grid.Column="0" Text="{Binding OriginalSize}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                                 <TextBlock Grid.Column="1" Text="{Binding ProcessingTimeText}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Right"/>
                                             </Grid>
                                         </StackPanel>
                                     </Border>
                                 </DataTemplate>
                             </ItemsControl.ItemTemplate>
                         </ItemsControl>
                     </ScrollViewer>
                 </StackPanel>
             </Border>
         </Grid>
     </DataTemplate>

     <!-- Text2Video View - Enthusiast Mode -->
     <DataTemplate x:Key="EnthusiastText2VideoViewModelTemplate">
         <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
             <Grid.ColumnDefinitions>
                 <ColumnDefinition Width="320"/>
                 <ColumnDefinition Width="*"/>
                 <ColumnDefinition Width="280"/>
             </Grid.ColumnDefinitions>

             <!-- Left Panel: Controls -->
             <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8,0,0,8" Padding="16">
                 <ScrollViewer VerticalScrollBarVisibility="Auto">
                     <StackPanel>
                         <TextBlock Text="🎬 Video Generation" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                         <!-- Prompt Engineering -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Prompt" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                             <TextBox Text="{Binding Prompt, UpdateSourceTrigger=PropertyChanged}" TextWrapping="Wrap" AcceptsReturn="True" MinHeight="60" Style="{DynamicResource DarkTextBoxStyle}" Margin="0,0,0,8"/>
                             
                             <TextBlock Text="Negative Prompt" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                             <TextBox Text="{Binding NegativePrompt, UpdateSourceTrigger=PropertyChanged}" TextWrapping="Wrap" AcceptsReturn="True" MinHeight="40" Style="{DynamicResource DarkTextBoxStyle}"/>
                         </StackPanel>

                         <!-- Video Settings -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                             <StackPanel>
                                 <TextBlock Text="Video Settings" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                 
                                 <!-- Duration -->
                                 <Grid Margin="0,0,0,8">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="70"/>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="40"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Duration:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <Slider Grid.Column="1" Value="{Binding DurationSeconds}" Minimum="3" Maximum="30" TickFrequency="1" Margin="4,0"/>
                                     <TextBox Grid.Column="2" Text="{Binding DurationSeconds, StringFormat=F0}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>

                                 <!-- Frame Rate -->
                                 <Grid Margin="0,0,0,8">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="70"/>
                                         <ColumnDefinition Width="*"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="FPS:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <ComboBox Grid.Column="1" ItemsSource="{Binding FrameRateOptions}" SelectedItem="{Binding FrameRate}" Style="{DynamicResource DarkComboBoxStyle}" Margin="4,0,0,0"/>
                                 </Grid>

                                 <!-- Aspect Ratio -->
                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="70"/>
                                         <ColumnDefinition Width="*"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Ratio:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <ComboBox Grid.Column="1" ItemsSource="{Binding AspectRatios}" SelectedItem="{Binding AspectRatio}" Style="{DynamicResource DarkComboBoxStyle}" Margin="4,0,0,0"/>
                                 </Grid>
                             </StackPanel>
                         </Border>

                         <!-- Model & Style -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Model &amp; Style" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                             <ComboBox ItemsSource="{Binding AvailableModels}" SelectedItem="{Binding SelectedModel}" Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8"/>
                             <ComboBox ItemsSource="{Binding StylePresets}" SelectedItem="{Binding SelectedStyle}" Style="{DynamicResource DarkComboBoxStyle}"/>
                         </StackPanel>

                         <!-- Motion Controls -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                             <StackPanel>
                                 <TextBlock Text="Motion &amp; Camera" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                 
                                 <Grid Margin="0,0,0,8">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="70"/>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="40"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Motion:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <Slider Grid.Column="1" Value="{Binding MotionStrength}" Minimum="0" Maximum="1" TickFrequency="0.1" Margin="4,0"/>
                                     <TextBox Grid.Column="2" Text="{Binding MotionStrength, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>

                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="70"/>
                                         <ColumnDefinition Width="*"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Camera:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <ComboBox Grid.Column="1" ItemsSource="{Binding CameraMovements}" SelectedItem="{Binding CameraMovement}" Style="{DynamicResource DarkComboBoxStyle}" Margin="4,0,0,0"/>
                                 </Grid>
                             </StackPanel>
                         </Border>

                         <!-- Seed Management -->
                         <StackPanel Margin="0,0,0,16">
                             <CheckBox Content="Random Seed" IsChecked="{Binding UseRandomSeed}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,6"/>
                             <Grid Visibility="{Binding UseRandomSeed, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                 <Grid.ColumnDefinitions>
                                     <ColumnDefinition Width="*"/>
                                     <ColumnDefinition Width="Auto"/>
                                 </Grid.ColumnDefinitions>
                                 <TextBox Text="{Binding Seed}" Style="{DynamicResource DarkTextBoxStyle}" Margin="0,0,4,0"/>
                                 <Button Grid.Column="1" Content="🎲" Command="{Binding RandomizeSeedCommand}" Style="{DynamicResource GhostButtonStyle}" Padding="8"/>
                             </Grid>
                         </StackPanel>

                         <!-- Generation Info -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                             <StackPanel>
                                 <TextBlock Text="Generation Info" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="*"/>
                                     </Grid.ColumnDefinitions>
                                     <StackPanel Grid.Column="0">
                                         <TextBlock Text="Est. Time:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                         <TextBlock Text="{Binding EstimatedTimeText}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}"/>
                                     </StackPanel>
                                     <StackPanel Grid.Column="1">
                                         <TextBlock Text="File Size:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                         <TextBlock Text="{Binding FileSizeText}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}"/>
                                     </StackPanel>
                                 </Grid>
                             </StackPanel>
                         </Border>

                         <!-- Generate Button -->
                         <Button Content="🎬 Generate Video" Command="{Binding GenerateCommand}" Style="{DynamicResource PrimaryButtonStyle}" Padding="0,12" FontWeight="SemiBold" IsEnabled="{Binding CanGenerate}"/>
                     </StackPanel>
                 </ScrollViewer>
             </Border>

             <!-- Center Panel: Video Preview & Player -->
             <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                 <Grid>
                     <Grid.RowDefinitions>
                         <RowDefinition Height="*"/>
                         <RowDefinition Height="Auto"/>
                     </Grid.RowDefinitions>

                     <!-- Video Preview -->
                     <Border Grid.Row="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                         <Grid>
                             <!-- Video Player Area -->
                             <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasGeneratedVideo, Converter={StaticResource BooleanToVisibilityConverter}}">
                                 <TextBlock Text="🎬" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12" Foreground="{DynamicResource AccentRedBrush}"/>
                                 <TextBlock Text="Video Generated!" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                 <TextBlock Text="{Binding VideoInfoText}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                             </StackPanel>

                             <!-- Empty State -->
                             <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasGeneratedVideo, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                 <TextBlock Text="🎬" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,16" Opacity="0.3"/>
                                 <TextBlock Text="Video Preview" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                 <TextBlock Text="Your generated video will appear here" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                             </StackPanel>

                             <!-- Generation Progress -->
                             <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToVisibilityConverter}}">
                                 <StackPanel HorizontalAlignment="Center" MinWidth="300">
                                     <TextBlock Text="🎬 Generating Video..." Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                     <Grid Margin="0,0,0,6">
                                         <ProgressBar Value="{Binding GenerationProgress}" Height="8" Background="{DynamicResource TertiaryDarkBrush}" Foreground="{DynamicResource AccentRedBrush}"/>
                                         <TextBlock Text="{Binding GenerationProgress, StringFormat='{}{0:F0}%'}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                     </Grid>
                                     <TextBlock Text="{Binding GenerationStatus}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                     <Button Content="Cancel" Command="{Binding CancelCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="12,6"/>
                                 </StackPanel>
                             </Border>
                         </Grid>
                     </Border>

                     <!-- Video Controls -->
                     <StackPanel Grid.Row="1" Margin="0,12,0,0">
                         <!-- Playback Controls -->
                         <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,8">
                             <Button Content="▶️" Command="{Binding PlayCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="12,8" Margin="0,0,4,0"/>
                             <Button Content="⏸️" Command="{Binding PauseCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="12,8" Margin="0,0,4,0"/>
                             <Button Content="⏹️" Command="{Binding StopCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="12,8"/>
                         </StackPanel>

                         <!-- Timeline Scrubber -->
                         <Grid Margin="0,0,0,8">
                             <Grid.ColumnDefinitions>
                                 <ColumnDefinition Width="Auto"/>
                                 <ColumnDefinition Width="*"/>
                                 <ColumnDefinition Width="Auto"/>
                             </Grid.ColumnDefinitions>
                             <TextBlock Grid.Column="0" Text="{Binding CurrentTimeText}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                             <Slider Grid.Column="1" Value="{Binding CurrentFrame}" Maximum="{Binding TotalFrames}" TickFrequency="1" IsSnapToTickEnabled="True"/>
                             <TextBlock Grid.Column="2" Text="{Binding TotalTimeText}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" VerticalAlignment="Center" Margin="8,0,0,0"/>
                         </Grid>

                         <!-- Export Actions -->
                         <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Visibility="{Binding HasGeneratedVideo, Converter={StaticResource BooleanToVisibilityConverter}}">
                             <Button Content="💾 Save" Command="{Binding SaveCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                             <Button Content="📤 Export" Command="{Binding ExportCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                             <Button Content="⭐ Favorite" Command="{Binding AddToFavoritesCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                         </StackPanel>
                     </StackPanel>
                 </Grid>
             </Border>

             <!-- Right Panel: History & Queue -->
             <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="0,8,8,0" Padding="16">
                 <StackPanel>
                     <TextBlock Text="📚 History &amp; Queue" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                     <!-- Favorite Prompts -->
                     <StackPanel Margin="0,0,0,16" Visibility="{Binding FavoritePrompts.Count, Converter={StaticResource ZeroToVisibilityConverter}, ConverterParameter=Inverse}">
                         <TextBlock Text="Favorite Prompts" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                         <ScrollViewer MaxHeight="120" VerticalScrollBarVisibility="Auto">
                             <ItemsControl ItemsSource="{Binding FavoritePrompts}">
                                 <ItemsControl.ItemTemplate>
                                     <DataTemplate>
                                         <Button Content="{Binding}" Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.LoadPromptCommand}" CommandParameter="{Binding}" Style="{DynamicResource GhostButtonStyle}" Padding="8,4" Margin="0,0,0,2" HorizontalContentAlignment="Left"/>
                                     </DataTemplate>
                                 </ItemsControl.ItemTemplate>
                             </ItemsControl>
                         </ScrollViewer>
                     </StackPanel>

                     <!-- Generation Status -->
                     <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                         <StackPanel>
                             <TextBlock Text="Status" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                             <TextBlock Text="{Binding GenerationStatus}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap"/>
                         </StackPanel>
                     </Border>

                     <!-- Recent History -->
                     <TextBlock Text="Recent Generations" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                     <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="300">
                         <ItemsControl ItemsSource="{Binding GenerationHistory}">
                             <ItemsControl.ItemTemplate>
                                 <DataTemplate>
                                     <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="10" Margin="0,0,0,6" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                                         <StackPanel>
                                             <TextBlock Text="{Binding TruncatedPrompt}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextPrimaryBrush}" FontWeight="SemiBold" TextWrapping="Wrap"/>
                                             <Grid Margin="0,4,0,0">
                                                 <Grid.ColumnDefinitions>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="Auto"/>
                                                 </Grid.ColumnDefinitions>
                                                 <StackPanel Grid.Column="0">
                                                     <TextBlock Text="{Binding VideoInfo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                     <TextBlock Text="{Binding Style}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                                 </StackPanel>
                                                 <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                                                     <TextBlock Text="{Binding TimeAgo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Right"/>
                                                     <TextBlock Text="{Binding FileSizeText}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Right"/>
                                                 </StackPanel>
                                             </Grid>
                                         </StackPanel>
                                     </Border>
                                 </DataTemplate>
                             </ItemsControl.ItemTemplate>
                         </ItemsControl>
                     </ScrollViewer>
                 </StackPanel>
             </Border>
         </Grid>
     </DataTemplate>

     <!-- Video2Video View - Enthusiast Mode -->
     <DataTemplate x:Key="EnthusiastVideo2VideoViewModelTemplate">
         <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
             <Grid.ColumnDefinitions>
                 <ColumnDefinition Width="320"/>
                 <ColumnDefinition Width="*"/>
                 <ColumnDefinition Width="280"/>
             </Grid.ColumnDefinitions>

             <!-- Left Panel: Controls -->
             <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8,0,0,8" Padding="16">
                 <ScrollViewer VerticalScrollBarVisibility="Auto">
                     <StackPanel>
                         <TextBlock Text="🎞️ Video Transformation" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                         <!-- Video Upload -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Source Video" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                             <Border Background="{DynamicResource SecondaryDarkBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="2" CornerRadius="6" Padding="16" MinHeight="100" AllowDrop="True">
                                 <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                     <StackPanel Visibility="{Binding HasSourceVideo, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                         <TextBlock Text="🎞️" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                         <Button Content="Load Video" Command="{Binding LoadVideoCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                                         <Button Content="Load Multiple" Command="{Binding LoadMultipleVideosCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                                     </StackPanel>
                                     
                                     <StackPanel Visibility="{Binding HasSourceVideo, Converter={StaticResource BooleanToVisibilityConverter}}">
                                         <TextBlock Text="🎞️" FontSize="20" HorizontalAlignment="Center" Margin="0,0,0,6" Foreground="{DynamicResource AccentRedBrush}"/>
                                         <TextBlock Text="{Binding SourceVideoInfo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" FontSize="10"/>
                                         <Button Content="🗑️ Clear" Command="{Binding ClearVideoCommand}" Style="{DynamicResource GhostButtonStyle}" Margin="0,6,0,0"/>
                                     </StackPanel>
                                 </StackPanel>
                             </Border>
                         </StackPanel>

                         <!-- Transformation Settings -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Transformation" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                             <TextBox Text="{Binding Prompt, UpdateSourceTrigger=PropertyChanged}" TextWrapping="Wrap" AcceptsReturn="True" MinHeight="50" Style="{DynamicResource DarkTextBoxStyle}" Margin="0,0,0,8"/>
                             
                             <TextBlock Text="Negative Prompt" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                             <TextBox Text="{Binding NegativePrompt, UpdateSourceTrigger=PropertyChanged}" TextWrapping="Wrap" AcceptsReturn="True" MinHeight="35" Style="{DynamicResource DarkTextBoxStyle}"/>
                         </StackPanel>

                         <!-- Style & Model -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                             <StackPanel>
                                 <TextBlock Text="Style &amp; Model" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                 <ComboBox ItemsSource="{Binding AvailableModels}" SelectedItem="{Binding SelectedModel}" Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8"/>
                                 <ComboBox ItemsSource="{Binding StylePresets}" SelectedItem="{Binding SelectedStyle}" Style="{DynamicResource DarkComboBoxStyle}"/>
                             </StackPanel>
                         </Border>

                         <!-- Transformation Controls -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                             <StackPanel>
                                 <TextBlock Text="Transformation Controls" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                 
                                 <!-- Strength -->
                                 <Grid Margin="0,0,0,8">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="70"/>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="40"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Strength:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <Slider Grid.Column="1" Value="{Binding Strength}" Minimum="0.1" Maximum="1.5" TickFrequency="0.1" Margin="4,0"/>
                                     <TextBox Grid.Column="2" Text="{Binding Strength, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>

                                 <!-- Temporal Consistency -->
                                 <CheckBox Content="Maintain Temporal Consistency" IsChecked="{Binding MaintainTemporalConsistency}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,4"/>
                                 <Grid Margin="0,0,0,0" Visibility="{Binding MaintainTemporalConsistency, Converter={StaticResource BooleanToVisibilityConverter}}">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="70"/>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="40"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Temporal:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <Slider Grid.Column="1" Value="{Binding TemporalConsistencyStrength}" Minimum="0" Maximum="1" TickFrequency="0.1" Margin="4,0"/>
                                     <TextBox Grid.Column="2" Text="{Binding TemporalConsistencyStrength, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>
                             </StackPanel>
                         </Border>

                         <!-- Processing Info -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                             <StackPanel>
                                 <TextBlock Text="Processing Info" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="*"/>
                                     </Grid.ColumnDefinitions>
                                     <StackPanel Grid.Column="0">
                                         <TextBlock Text="Est. Time:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                         <TextBlock Text="{Binding ProcessingTimeText}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}"/>
                                     </StackPanel>
                                     <StackPanel Grid.Column="1">
                                         <TextBlock Text="File Size:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                         <TextBlock Text="{Binding FileSizeText}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}"/>
                                     </StackPanel>
                                 </Grid>
                             </StackPanel>
                         </Border>

                         <!-- Transform Button -->
                         <Button Content="🎞️ Transform Video" Command="{Binding ProcessVideoCommand}" Style="{DynamicResource PrimaryButtonStyle}" Padding="0,12" FontWeight="SemiBold" IsEnabled="{Binding CanProcess}"/>
                     </StackPanel>
                 </ScrollViewer>
             </Border>

             <!-- Center Panel: Before/After Comparison -->
             <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                 <Grid>
                     <Grid.RowDefinitions>
                         <RowDefinition Height="Auto"/>
                         <RowDefinition Height="*"/>
                         <RowDefinition Height="Auto"/>
                     </Grid.RowDefinitions>

                     <!-- Comparison Header -->
                     <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,12">
                         <TextBlock Text="📹 Original" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,40,0"/>
                         <Button Content="⚖️" Command="{Binding CompareCommand}" Style="{DynamicResource GhostButtonStyle}" ToolTip="Compare Side by Side" Margin="0,0,40,0"/>
                         <TextBlock Text="✨ Transformed" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource AccentRedBrush}"/>
                     </StackPanel>

                     <!-- Before/After Comparison -->
                     <Grid Grid.Row="1">
                         <Grid.ColumnDefinitions>
                             <ColumnDefinition Width="*"/>
                             <ColumnDefinition Width="*"/>
                         </Grid.ColumnDefinitions>

                         <!-- Before (Source) -->
                         <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" Margin="0,0,8,0">
                             <Grid>
                                 <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasSourceVideo, Converter={StaticResource BooleanToVisibilityConverter}}">
                                     <TextBlock Text="📹" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8" Foreground="{DynamicResource AccentRedBrush}"/>
                                     <TextBlock Text="Source Video" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                     <Button Content="▶️ Play" Command="{Binding PlaySourceCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,8,0,0"/>
                                 </StackPanel>
                                 <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasSourceVideo, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                     <TextBlock Text="📹" FontSize="48" HorizontalAlignment="Center" Opacity="0.3"/>
                                     <TextBlock Text="Source" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                 </StackPanel>
                                 <TextBlock Text="BEFORE" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="8" FontWeight="SemiBold"/>
                             </Grid>
                         </Border>

                         <!-- After (Result) -->
                         <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" Margin="8,0,0,0">
                             <Grid>
                                 <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasOutputVideo, Converter={StaticResource BooleanToVisibilityConverter}}">
                                     <TextBlock Text="✨" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8" Foreground="{DynamicResource AccentRedBrush}"/>
                                     <TextBlock Text="Transformed" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                     <Button Content="▶️ Play" Command="{Binding PlayOutputCommand}" Style="{DynamicResource PrimaryButtonStyle}" Margin="0,8,0,0"/>
                                 </StackPanel>
                                 <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasOutputVideo, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                     <TextBlock Text="✨" FontSize="48" HorizontalAlignment="Center" Opacity="0.3"/>
                                     <TextBlock Text="Result" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                 </StackPanel>

                                 <!-- Processing Progress -->
                                 <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding IsProcessing, Converter={StaticResource BooleanToVisibilityConverter}}">
                                     <StackPanel HorizontalAlignment="Center">
                                         <TextBlock Text="🎞️ Processing..." Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                         <Grid Margin="0,0,0,6">
                                             <ProgressBar Value="{Binding ProcessingProgress}" Width="200" Height="6" Background="{DynamicResource TertiaryDarkBrush}" Foreground="{DynamicResource AccentRedBrush}"/>
                                             <TextBlock Text="{Binding ProcessingProgress, StringFormat='{}{0:F0}%'}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                         </Grid>
                                         <TextBlock Text="{Binding ProcessingStatus}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                                     </StackPanel>
                                 </Border>
                                 <TextBlock Text="AFTER" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="8" FontWeight="SemiBold"/>
                             </Grid>
                         </Border>
                     </Grid>

                     <!-- Video Controls -->
                     <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,16,0,0">
                         <Button Content="⏸️ Pause" Command="{Binding PauseCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                         <Button Content="⏹️ Stop" Command="{Binding StopCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,8,0"/>
                         <Button Content="💾 Save" Command="{Binding SaveCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0" Visibility="{Binding HasOutputVideo, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                         <Button Content="📤 Export" Command="{Binding ExportCommand}" Style="{DynamicResource SecondaryButtonStyle}" Visibility="{Binding HasOutputVideo, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                     </StackPanel>
                 </Grid>
             </Border>

             <!-- Right Panel: Batch & History -->
             <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="0,8,8,0" Padding="16">
                 <StackPanel>
                     <TextBlock Text="📚 Batch &amp; History" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                     <!-- Batch Queue -->
                     <StackPanel Margin="0,0,0,16" Visibility="{Binding ProcessingQueue.Count, Converter={StaticResource ZeroToVisibilityConverter}, ConverterParameter=Inverse}">
                         <TextBlock Text="Batch Queue" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12">
                             <StackPanel>
                                 <TextBlock Text="{Binding ProcessingQueue.Count, StringFormat='{}{0} videos queued'}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,8"/>
                                 <Button Content="🚀 Process Batch" Command="{Binding BatchProcessCommand}" Style="{DynamicResource PrimaryButtonStyle}" Padding="0,8"/>
                             </StackPanel>
                         </Border>
                     </StackPanel>

                     <!-- Processing Status -->
                     <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                         <StackPanel>
                             <TextBlock Text="Status" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                             <TextBlock Text="{Binding ProcessingStatus}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap"/>
                         </StackPanel>
                     </Border>

                     <!-- Recent History -->
                     <TextBlock Text="Recent Transformations" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                     <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="300">
                         <ItemsControl ItemsSource="{Binding TransformationHistory}">
                             <ItemsControl.ItemTemplate>
                                 <DataTemplate>
                                     <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="10" Margin="0,0,0,6" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                                         <StackPanel>
                                             <TextBlock Text="{Binding TruncatedPrompt}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextPrimaryBrush}" FontWeight="SemiBold" TextWrapping="Wrap"/>
                                             <Grid Margin="0,4,0,0">
                                                 <Grid.ColumnDefinitions>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="Auto"/>
                                                 </Grid.ColumnDefinitions>
                                                 <StackPanel Grid.Column="0">
                                                     <TextBlock Text="{Binding ParametersText}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                     <TextBlock Text="{Binding SourceFileName}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                                 </StackPanel>
                                                 <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                                                     <TextBlock Text="{Binding TimeAgo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Right"/>
                                                     <TextBlock Text="{Binding FileSizeText}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Right"/>
                                                 </StackPanel>
                                             </Grid>
                                         </StackPanel>
                                     </Border>
                                 </DataTemplate>
                             </ItemsControl.ItemTemplate>
                         </ItemsControl>
                     </ScrollViewer>
                 </StackPanel>
             </Border>
         </Grid>
     </DataTemplate>

     <!-- MotionControl View - Enthusiast Mode -->
     <DataTemplate x:Key="EnthusiastMotionControlViewModelTemplate">
         <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
             <Grid.ColumnDefinitions>
                 <ColumnDefinition Width="320"/>
                 <ColumnDefinition Width="*"/>
                 <ColumnDefinition Width="280"/>
             </Grid.ColumnDefinitions>

             <!-- Left Panel: Controls -->
             <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8,0,0,8" Padding="16">
                 <ScrollViewer VerticalScrollBarVisibility="Auto">
                     <StackPanel>
                         <TextBlock Text="🎥 Motion Control" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                         <!-- Video Upload -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Source Video" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                             <Border Background="{DynamicResource SecondaryDarkBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="2" CornerRadius="6" Padding="16" MinHeight="80" AllowDrop="True">
                                 <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                     <StackPanel Visibility="{Binding HasSourceVideo, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                         <Button Content="Load Video" Command="{Binding LoadVideoCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                                     </StackPanel>
                                     <StackPanel Visibility="{Binding HasSourceVideo, Converter={StaticResource BooleanToVisibilityConverter}}">
                                         <TextBlock Text="🎥" FontSize="16" HorizontalAlignment="Center" Margin="0,0,0,4" Foreground="{DynamicResource AccentRedBrush}"/>
                                         <TextBlock Text="Video Loaded" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                                     </StackPanel>
                                 </StackPanel>
                             </Border>
                         </StackPanel>

                         <!-- Camera Controls -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                             <StackPanel>
                                 <TextBlock Text="Camera Movement" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                 <ComboBox ItemsSource="{Binding CameraMovements}" SelectedItem="{Binding SelectedCameraMovement}" Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8"/>
                                 
                                 <!-- Motion Parameters -->
                                 <Grid Margin="0,0,0,8">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="50"/>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="40"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Pan X:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <Slider Grid.Column="1" Value="{Binding PanX}" Minimum="-2" Maximum="2" TickFrequency="0.1" Margin="4,0"/>
                                     <TextBox Grid.Column="2" Text="{Binding PanX, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>

                                 <Grid Margin="0,0,0,8">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="50"/>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="40"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Pan Y:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <Slider Grid.Column="1" Value="{Binding PanY}" Minimum="-2" Maximum="2" TickFrequency="0.1" Margin="4,0"/>
                                     <TextBox Grid.Column="2" Text="{Binding PanY, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>

                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="50"/>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="40"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Zoom:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <Slider Grid.Column="1" Value="{Binding Zoom}" Minimum="0.1" Maximum="3.0" TickFrequency="0.1" Margin="4,0"/>
                                     <TextBox Grid.Column="2" Text="{Binding Zoom, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>
                             </StackPanel>
                         </Border>

                         <!-- Motion Settings -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                             <StackPanel>
                                 <TextBlock Text="Motion Settings" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                 <CheckBox Content="Object Tracking" IsChecked="{Binding EnableObjectTracking}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,8"/>
                                 
                                 <Grid>
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="70"/>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="40"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Smoothing:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <Slider Grid.Column="1" Value="{Binding MotionSmoothing}" Minimum="0" Maximum="1" TickFrequency="0.1" Margin="4,0"/>
                                     <TextBox Grid.Column="2" Text="{Binding MotionSmoothing, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>
                             </StackPanel>
                         </Border>

                         <!-- Apply Motion Button -->
                         <Button Content="🎥 Apply Motion" Command="{Binding ApplyMotionCommand}" Style="{DynamicResource PrimaryButtonStyle}" Padding="0,12" FontWeight="SemiBold" IsEnabled="{Binding CanApplyMotion}"/>
                     </StackPanel>
                 </ScrollViewer>
             </Border>

             <!-- Center Panel: Motion Preview -->
             <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                 <Grid>
                     <Grid.RowDefinitions>
                         <RowDefinition Height="*"/>
                         <RowDefinition Height="Auto"/>
                     </Grid.RowDefinitions>

                     <!-- Motion Visualization -->
                     <Border Grid.Row="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                         <Grid>
                             <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasMotionPath, Converter={StaticResource BooleanToVisibilityConverter}}">
                                 <TextBlock Text="🎥" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12" Foreground="{DynamicResource AccentRedBrush}"/>
                                 <TextBlock Text="Motion Path Active" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                 <TextBlock Text="{Binding MotionSummary}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                             </StackPanel>

                             <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasMotionPath, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                 <TextBlock Text="🎥" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,16" Opacity="0.3"/>
                                 <TextBlock Text="Motion Preview" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                             </StackPanel>

                             <!-- Processing Progress -->
                             <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding IsProcessing, Converter={StaticResource BooleanToVisibilityConverter}}">
                                 <StackPanel HorizontalAlignment="Center">
                                     <TextBlock Text="🎥 Processing Motion..." Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                     <ProgressBar Value="{Binding ProcessingProgress}" Width="200" Height="6" Background="{DynamicResource TertiaryDarkBrush}" Foreground="{DynamicResource AccentRedBrush}"/>
                                 </StackPanel>
                             </Border>
                         </Grid>
                     </Border>

                     <!-- Timeline Controls -->
                     <StackPanel Grid.Row="1" Margin="0,12,0,0">
                         <Grid Margin="0,0,0,8">
                             <Grid.ColumnDefinitions>
                                 <ColumnDefinition Width="Auto"/>
                                 <ColumnDefinition Width="*"/>
                                 <ColumnDefinition Width="Auto"/>
                             </Grid.ColumnDefinitions>
                             <TextBlock Grid.Column="0" Text="0s" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                             <Slider Grid.Column="1" Value="{Binding TimelinePosition}" Maximum="{Binding TimelineDuration}" TickFrequency="0.1"/>
                             <TextBlock Grid.Column="2" Text="{Binding TimelineDuration, StringFormat={}{0:F0}s}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" VerticalAlignment="Center" Margin="8,0,0,0"/>
                         </Grid>

                         <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                             <Button Content="🎯 Add Keyframe" Command="{Binding AddKeyframeCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                             <Button Content="👁️ Preview" Command="{Binding PreviewMotionCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                             <Button Content="🔄 Reset" Command="{Binding ResetMotionCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                         </StackPanel>
                     </StackPanel>
                 </Grid>
             </Border>

             <!-- Right Panel: Keyframes & Presets -->
             <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="0,8,8,0" Padding="16">
                 <StackPanel>
                     <TextBlock Text="🎯 Keyframes &amp; Presets" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                     <!-- Keyframes -->
                     <StackPanel Margin="0,0,0,16">
                         <TextBlock Text="Motion Keyframes" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                         <ScrollViewer MaxHeight="150" VerticalScrollBarVisibility="Auto">
                             <ItemsControl ItemsSource="{Binding MotionKeyframes}">
                                 <ItemsControl.ItemTemplate>
                                     <DataTemplate>
                                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="8" Margin="0,0,0,4">
                                             <Grid>
                                                 <Grid.ColumnDefinitions>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="Auto"/>
                                                 </Grid.ColumnDefinitions>
                                                 <StackPanel Grid.Column="0">
                                                     <TextBlock Text="{Binding TimeText}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontWeight="SemiBold"/>
                                                     <TextBlock Text="{Binding ParametersText}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontSize="9"/>
                                                 </StackPanel>
                                                 <Button Grid.Column="1" Content="🗑️" Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.RemoveKeyframeCommand}" CommandParameter="{Binding}" Style="{DynamicResource GhostButtonStyle}" Padding="4"/>
                                             </Grid>
                                         </Border>
                                     </DataTemplate>
                                 </ItemsControl.ItemTemplate>
                             </ItemsControl>
                         </ScrollViewer>
                     </StackPanel>

                     <!-- Motion Presets -->
                     <TextBlock Text="Motion Presets" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                     <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="200">
                         <ItemsControl ItemsSource="{Binding MotionPresets}">
                             <ItemsControl.ItemTemplate>
                                 <DataTemplate>
                                     <Button Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.LoadMotionPresetCommand}" CommandParameter="{Binding}" Style="{DynamicResource GhostButtonStyle}" Padding="8" Margin="0,0,0,4" HorizontalContentAlignment="Left">
                                         <StackPanel Orientation="Horizontal">
                                             <TextBlock Text="{Binding Icon}" Margin="0,0,8,0"/>
                                             <StackPanel>
                                                 <TextBlock Text="{Binding Name}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextPrimaryBrush}" FontWeight="SemiBold"/>
                                                 <TextBlock Text="{Binding Description}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" FontSize="9"/>
                                             </StackPanel>
                                         </StackPanel>
                                     </Button>
                                 </DataTemplate>
                             </ItemsControl.ItemTemplate>
                         </ItemsControl>
                     </ScrollViewer>
                 </StackPanel>
             </Border>
         </Grid>
     </DataTemplate>

     <!-- TemporalEffects View - Enthusiast Mode -->
     <DataTemplate x:Key="EnthusiastTemporalEffectsViewModelTemplate">
         <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
             <Grid.ColumnDefinitions>
                 <ColumnDefinition Width="320"/>
                 <ColumnDefinition Width="*"/>
                 <ColumnDefinition Width="280"/>
             </Grid.ColumnDefinitions>

             <!-- Left Panel: Controls -->
             <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8,0,0,8" Padding="16">
                 <ScrollViewer VerticalScrollBarVisibility="Auto">
                     <StackPanel>
                         <TextBlock Text="⏱️ Temporal Effects" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                         <!-- Video Upload -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Source Video" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                             <Border Background="{DynamicResource SecondaryDarkBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="2" CornerRadius="6" Padding="16" MinHeight="80" AllowDrop="True">
                                 <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                     <StackPanel Visibility="{Binding HasSourceVideo, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                         <Button Content="Load Video" Command="{Binding LoadVideoCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                                     </StackPanel>
                                     <StackPanel Visibility="{Binding HasSourceVideo, Converter={StaticResource BooleanToVisibilityConverter}}">
                                         <TextBlock Text="⏱️" FontSize="16" HorizontalAlignment="Center" Margin="0,0,0,4" Foreground="{DynamicResource AccentRedBrush}"/>
                                         <TextBlock Text="Video Loaded" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                                     </StackPanel>
                                 </StackPanel>
                             </Border>
                         </StackPanel>

                         <!-- Effect Selection -->
                         <StackPanel Margin="0,0,0,16">
                             <TextBlock Text="Effect Type" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                             <ComboBox ItemsSource="{Binding AvailableEffects}" SelectedItem="{Binding SelectedEffect}" Style="{DynamicResource DarkComboBoxStyle}"/>
                         </StackPanel>

                         <!-- Speed Controls -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16" Visibility="{Binding IsSpeedChangeSelected, Converter={StaticResource BooleanToVisibilityConverter}}">
                             <StackPanel>
                                 <TextBlock Text="Speed Control" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                 <Grid Margin="0,0,0,8">
                                     <Grid.ColumnDefinitions>
                                         <ColumnDefinition Width="50"/>
                                         <ColumnDefinition Width="*"/>
                                         <ColumnDefinition Width="40"/>
                                     </Grid.ColumnDefinitions>
                                     <TextBlock Text="Speed:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                     <Slider Grid.Column="1" Value="{Binding SpeedMultiplier}" Minimum="0.1" Maximum="8.0" TickFrequency="0.1" Margin="4,0"/>
                                     <TextBox Grid.Column="2" Text="{Binding SpeedMultiplier, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                 </Grid>
                                 <ComboBox ItemsSource="{Binding SpeedPresets}" SelectedItem="{Binding SpeedPreset}" Style="{DynamicResource DarkComboBoxStyle}"/>
                             </StackPanel>
                         </Border>

                         <!-- Frame Interpolation -->
                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16" Visibility="{Binding IsFrameInterpolationSelected, Converter={StaticResource BooleanToVisibilityConverter}}">
                             <StackPanel>
                                 <TextBlock Text="Frame Interpolation" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                 <ComboBox ItemsSource="{Binding FrameRateOptions}" SelectedItem="{Binding TargetFrameRate}" Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8"/>
                                 <ComboBox ItemsSource="{Binding InterpolationMethods}" SelectedItem="{Binding InterpolationMethod}" Style="{DynamicResource DarkComboBoxStyle}"/>
                             </StackPanel>
                         </Border>

                         <!-- Apply Effect Button -->
                         <Button Content="⏱️ Apply Effect" Command="{Binding ApplyEffectCommand}" Style="{DynamicResource PrimaryButtonStyle}" Padding="0,12" FontWeight="SemiBold" IsEnabled="{Binding CanApplyEffect}"/>
                     </StackPanel>
                 </ScrollViewer>
             </Border>

             <!-- Center Panel: Effect Preview -->
             <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                 <Grid>
                     <Grid.RowDefinitions>
                         <RowDefinition Height="*"/>
                         <RowDefinition Height="Auto"/>
                     </Grid.RowDefinitions>

                     <!-- Effect Preview -->
                     <Border Grid.Row="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                         <Grid>
                             <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasPreview, Converter={StaticResource BooleanToVisibilityConverter}}">
                                 <TextBlock Text="⏱️" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12" Foreground="{DynamicResource AccentRedBrush}"/>
                                 <TextBlock Text="Effect Applied" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                 <TextBlock Text="{Binding SpeedText}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                             </StackPanel>

                             <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasPreview, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                 <TextBlock Text="⏱️" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,16" Opacity="0.3"/>
                                 <TextBlock Text="Effect Preview" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                             </StackPanel>

                             <!-- Processing Progress -->
                             <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding IsProcessing, Converter={StaticResource BooleanToVisibilityConverter}}">
                                 <StackPanel HorizontalAlignment="Center">
                                     <TextBlock Text="⏱️ Processing Effect..." Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                     <ProgressBar Value="{Binding ProcessingProgress}" Width="200" Height="6" Background="{DynamicResource TertiaryDarkBrush}" Foreground="{DynamicResource AccentRedBrush}"/>
                                 </StackPanel>
                             </Border>
                         </Grid>
                     </Border>

                     <!-- Effect Controls -->
                     <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,12,0,0">
                         <Button Content="👁️ Preview" Command="{Binding PreviewEffectCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                         <Button Content="💾 Export" Command="{Binding ExportEffectCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0" IsEnabled="{Binding CanExport}"/>
                         <Button Content="🔄 Reset" Command="{Binding ResetEffectCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                     </StackPanel>
                 </Grid>
             </Border>

             <!-- Right Panel: Templates & History -->
             <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="0,8,8,0" Padding="16">
                 <StackPanel>
                     <TextBlock Text="📚 Templates &amp; History" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                     <!-- Effect Templates -->
                     <TextBlock Text="Effect Templates" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                     <ScrollViewer MaxHeight="200" VerticalScrollBarVisibility="Auto">
                         <ItemsControl ItemsSource="{Binding EffectTemplates}">
                             <ItemsControl.ItemTemplate>
                                 <DataTemplate>
                                     <Button Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.ApplyTemplateCommand}" CommandParameter="{Binding}" Style="{DynamicResource GhostButtonStyle}" Padding="8" Margin="0,0,0,4" HorizontalContentAlignment="Left">
                                         <StackPanel Orientation="Horizontal">
                                             <TextBlock Text="{Binding Icon}" Margin="0,0,8,0"/>
                                             <StackPanel>
                                                 <TextBlock Text="{Binding Name}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextPrimaryBrush}" FontWeight="SemiBold"/>
                                                 <TextBlock Text="{Binding Description}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" FontSize="9"/>
                                             </StackPanel>
                                         </StackPanel>
                                     </Button>
                                 </DataTemplate>
                             </ItemsControl.ItemTemplate>
                         </ItemsControl>
                     </ScrollViewer>

                     <!-- Processing Status -->
                     <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,16,0,0">
                         <StackPanel>
                             <TextBlock Text="Status" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                             <TextBlock Text="{Binding ProcessingStatus}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap"/>
                         </StackPanel>
                     </Border>
                 </StackPanel>
             </Border>
         </Grid>
     </DataTemplate>

     <!-- ThreeDModels View - Enthusiast Mode -->
     <DataTemplate x:Key="EnthusiastThreeDModelsViewModelTemplate">
         <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
             <Grid.ColumnDefinitions>
                 <ColumnDefinition Width="280"/>
                 <ColumnDefinition Width="*"/>
                 <ColumnDefinition Width="280"/>
             </Grid.ColumnDefinitions>

             <!-- Left Panel: Model Library -->
             <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8,0,0,8" Padding="16">
                 <StackPanel>
                     <TextBlock Text="🎯 3D Model Library" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                     <!-- Search & Import -->
                     <StackPanel Margin="0,0,0,16">
                         <TextBox Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged}" Style="{DynamicResource DarkTextBoxStyle}" Margin="0,0,0,8"/>
                         <StackPanel Orientation="Horizontal">
                             <Button Content="📥 Import" Command="{Binding ImportModelCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                             <Button Content="📥 Batch" Command="{Binding ImportMultipleModelsCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                         </StackPanel>
                     </StackPanel>

                     <!-- Categories -->
                     <StackPanel Margin="0,0,0,16">
                         <TextBlock Text="Category" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                         <ComboBox ItemsSource="{Binding ModelCategories}" SelectedItem="{Binding SelectedCategory}" Style="{DynamicResource DarkComboBoxStyle}"/>
                     </StackPanel>

                     <!-- Model List -->
                     <ScrollViewer VerticalScrollBarVisibility="Auto">
                         <ItemsControl ItemsSource="{Binding FilteredModels}">
                             <ItemsControl.ItemTemplate>
                                 <DataTemplate>
                                     <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="10" Margin="0,0,0,6" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                                         <StackPanel>
                                             <Grid>
                                                 <Grid.ColumnDefinitions>
                                                     <ColumnDefinition Width="*"/>
                                                     <ColumnDefinition Width="Auto"/>
                                                 </Grid.ColumnDefinitions>
                                                 <StackPanel Grid.Column="0">
                                                     <TextBlock Text="{Binding Name}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextPrimaryBrush}" FontWeight="SemiBold"/>
                                                     <TextBlock Text="{Binding Category}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                 </StackPanel>
                                                 <TextBlock Grid.Column="1" Text="{Binding Format}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource AccentRedBrush}" VerticalAlignment="Center"/>
                                             </Grid>
                                             <TextBlock Text="{Binding ModelInfo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" Margin="0,4,0,0"/>
                                         </StackPanel>
                                     </Border>
                                 </DataTemplate>
                             </ItemsControl.ItemTemplate>
                         </ItemsControl>
                     </ScrollViewer>
                 </StackPanel>
             </Border>

             <!-- Center Panel: 3D Viewport -->
             <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                 <Grid>
                     <Grid.RowDefinitions>
                         <RowDefinition Height="*"/>
                         <RowDefinition Height="Auto"/>
                     </Grid.RowDefinitions>

                     <!-- 3D Viewport -->
                     <Border Grid.Row="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                         <Grid>
                             <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasSelectedModel, Converter={StaticResource BooleanToVisibilityConverter}}">
                                 <TextBlock Text="🎯" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12" Foreground="{DynamicResource AccentRedBrush}"/>
                                 <TextBlock Text="3D Model Viewer" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                 <TextBlock Text="{Binding ModelInfoText}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                             </StackPanel>

                             <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasSelectedModel, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                 <TextBlock Text="🎯" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,16" Opacity="0.3"/>
                                 <TextBlock Text="3D Viewport" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                 <TextBlock Text="Select a model to view" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                             </StackPanel>

                             <!-- Loading Progress -->
                             <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
                                 <StackPanel HorizontalAlignment="Center">
                                     <TextBlock Text="🎯 Loading Model..." Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                     <TextBlock Text="{Binding LoadingStatus}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                                 </StackPanel>
                             </Border>
                         </Grid>
                     </Border>

                     <!-- Viewport Controls -->
                     <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,12,0,0">
                         <Button Content="🔄 Reset" Command="{Binding ResetViewportCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                         <Button Content="🔍 Fit" Command="{Binding FitToViewCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                         <Button Content="▶️ Play" Command="{Binding PlayAnimationCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0" Visibility="{Binding CanPlayAnimation, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                         <Button Content="⏸️ Pause" Command="{Binding PauseAnimationCommand}" Style="{DynamicResource SecondaryButtonStyle}" Visibility="{Binding CanPlayAnimation, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                     </StackPanel>
                 </Grid>
             </Border>

             <!-- Right Panel: Materials & Properties -->
             <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="0,8,8,0" Padding="16">
                 <StackPanel>
                     <TextBlock Text="🎨 Materials &amp; Properties" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                     <!-- Model Properties -->
                     <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16" Visibility="{Binding HasSelectedModel, Converter={StaticResource BooleanToVisibilityConverter}}">
                         <StackPanel>
                             <TextBlock Text="Model Properties" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                             <Grid>
                                 <Grid.ColumnDefinitions>
                                     <ColumnDefinition Width="*"/>
                                     <ColumnDefinition Width="*"/>
                                 </Grid.ColumnDefinitions>
                                 <StackPanel Grid.Column="0">
                                     <TextBlock Text="Polygons:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                     <TextBlock Text="{Binding PolyCountText}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}"/>
                                 </StackPanel>
                                 <StackPanel Grid.Column="1">
                                     <TextBlock Text="Textures:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                     <TextBlock Text="{Binding TextureCount}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}"/>
                                 </StackPanel>
                             </Grid>
                         </StackPanel>
                     </Border>

                     <!-- Materials -->
                     <StackPanel Margin="0,0,0,16">
                         <TextBlock Text="Available Materials" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                         <ScrollViewer MaxHeight="200" VerticalScrollBarVisibility="Auto">
                             <ItemsControl ItemsSource="{Binding AvailableMaterials}">
                                 <ItemsControl.ItemTemplate>
                                     <DataTemplate>
                                         <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="8" Margin="0,0,0,4">
                                             <StackPanel>
                                                 <TextBlock Text="{Binding Name}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextPrimaryBrush}" FontWeight="SemiBold"/>
                                                 <TextBlock Text="{Binding MaterialInfo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontSize="9"/>
                                             </StackPanel>
                                         </Border>
                                     </DataTemplate>
                                 </ItemsControl.ItemTemplate>
                             </ItemsControl>
                         </ScrollViewer>
                     </StackPanel>

                     <!-- Quick Actions -->
                     <StackPanel>
                         <Button Content="⭐ Add to Favorites" Command="{Binding AddToFavoritesCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4" IsEnabled="{Binding HasSelectedModel}"/>
                         <Button Content="📤 Export Model" Command="{Binding ExportModelCommand}" Style="{DynamicResource SecondaryButtonStyle}" IsEnabled="{Binding CanExportModel}"/>
                     </StackPanel>
                 </StackPanel>
             </Border>
         </Grid>
     </DataTemplate>

     <!-- Image Generation Template - Text2Image Professional -->
     <DataTemplate x:Key="Text2ImageTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="320"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="280"/>
            </Grid.ColumnDefinitions>
            
            <!-- Controls Panel -->
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="8,0,0,8" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="Image Generation" 
                                   Style="{DynamicResource HeadingSmallStyle}"
                                   Foreground="{DynamicResource AccentPurpleBrush}"
                                   Margin="0,0,0,16"/>
                        
                        <!-- Prompt Input -->
                        <TextBlock Text="Prompt" Style="{DynamicResource CaptionTextStyle}"
                                   Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                        <TextBox Text="{Binding Prompt, UpdateSourceTrigger=PropertyChanged}"
                                 Style="{DynamicResource DarkTextBoxStyle}" 
                                 MinHeight="80" TextWrapping="Wrap" AcceptsReturn="True"
                                 Margin="0,0,0,12"/>
                        
                        <!-- Negative Prompt -->
                        <TextBlock Text="Negative Prompt" Style="{DynamicResource CaptionTextStyle}"
                                   Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                        <TextBox Text="{Binding NegativePrompt, UpdateSourceTrigger=PropertyChanged}"
                                 Style="{DynamicResource DarkTextBoxStyle}" 
                                 MinHeight="60" TextWrapping="Wrap" AcceptsReturn="True"
                                 Margin="0,0,0,16"/>
                        
                        <!-- Essential Parameters Panel (Always Visible) -->
                        <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="4" Padding="12" Margin="0,0,0,12">
                            <StackPanel>
                                <TextBlock Text="Essential Settings" Style="{DynamicResource CaptionTextStyle}" 
                                           Foreground="{DynamicResource AccentPurpleBrush}" Margin="0,0,0,8"/>
                                
                                <!-- Steps with Quality Indicator -->
                                <Grid Margin="0,0,0,12">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="60"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Quality (Steps)" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1" Text="{Binding Steps, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{DynamicResource DarkTextBoxStyle}"/>
                                    </Grid>
                                    <Slider Grid.Row="1" Minimum="15" Maximum="50" Value="{Binding Steps}" 
                                            Margin="0,4,0,0" TickPlacement="BottomRight" TickFrequency="5"/>
                                </Grid>
                                
                                <!-- CFG Scale with Prompt Adherence Label -->
                                <Grid Margin="0,0,0,12">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="60"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Prompt Adherence (CFG)" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1" Text="{Binding CfgScale, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{DynamicResource DarkTextBoxStyle}"/>
                                    </Grid>
                                    <Slider Grid.Row="1" Minimum="3" Maximum="15" Value="{Binding CfgScale}" 
                                            Margin="0,4,0,0" TickPlacement="BottomRight" TickFrequency="2"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                        
                        <!-- Advanced Parameters (Collapsible) -->
                        <Expander Header="Advanced Settings" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <!-- Sampler with Performance Notes -->
                                <Grid Margin="0,0,0,12">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Row="0" Text="Sampler Method" Margin="0,0,0,4"/>
                                    <ComboBox Grid.Row="1" SelectedValue="{Binding Sampler}" Style="{DynamicResource DarkComboBoxStyle}">
                                        <ComboBoxItem Content="DPM++ 2M Karras (Recommended)" Tag="dpmpp_2m_karras"/>
                                        <ComboBoxItem Content="Euler A (Fast)" Tag="euler_a"/>
                                        <ComboBoxItem Content="DDIM (Stable)" Tag="ddim"/>
                                        <ComboBoxItem Content="LMS (Legacy)" Tag="lms"/>
                                    </ComboBox>
                                </Grid>
                                
                                <!-- Seed Control for Reproducibility -->
                                <Grid Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Seed (Reproducibility)" Margin="0,0,0,4"/>
                                        <TextBlock Text="Use same seed for identical results" Style="{DynamicResource CaptionTextStyle}" 
                                                   Foreground="{DynamicResource TextMutedBrush}" FontSize="10"/>
                                    </StackPanel>
                                    <TextBox Grid.Column="1" Text="{Binding Seed, UpdateSourceTrigger=PropertyChanged}" 
                                             Style="{DynamicResource DarkTextBoxStyle}"/>
                                    <Button Grid.Column="2" Content="🎲" ToolTip="Random Seed" 
                                            Command="{Binding RandomizeSeedCommand}" 
                                            Style="{DynamicResource SecondaryButtonStyle}" 
                                            Width="28" Height="28" Margin="4,0,0,0"/>
                                </Grid>
                                
                                <!-- Batch Size with Cost Estimation -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Batch Size"/>
                                        <TextBlock Text="{Binding BatchCostEstimate}" Style="{DynamicResource CaptionTextStyle}" 
                                                   Foreground="{DynamicResource TextMutedBrush}" FontSize="10"/>
                                    </StackPanel>
                                    <TextBox Grid.Column="1" Text="{Binding BatchSize, UpdateSourceTrigger=PropertyChanged}" 
                                             Style="{DynamicResource DarkTextBoxStyle}"/>
                                </Grid>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Generate Button -->
                        <Button Content="Generate Image" 
                                Command="{Binding GenerateCommand}"
                                IsEnabled="{Binding CanGenerate}"
                                Style="{DynamicResource PrimaryButtonStyle}"
                                Padding="0,12" FontSize="14" FontWeight="SemiBold"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>
            
            <!-- Preview Panel -->
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" 
                    Padding="20" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1,0">
                <Grid>
                    <Border Background="{DynamicResource PrimaryDarkBrush}" 
                            CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                        <Grid>
                            <Image Source="{Binding GeneratedImageSource}" 
                                   Stretch="Uniform"
                                   Visibility="{Binding HasGeneratedImage, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Text="🖼️ Generated image will appear here" 
                                       HorizontalAlignment="Center" VerticalAlignment="Center"
                                       Style="{DynamicResource CaptionTextStyle}"
                                       Foreground="{DynamicResource TextMutedBrush}"
                                       Visibility="{Binding HasGeneratedImage, Converter={StaticResource BoolToVisibility}, ConverterParameter=Inverted}"/>
                        </Grid>
                    </Border>
                </Grid>
            </Border>
            
            <!-- History Panel -->
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="0,8,8,0" Padding="16">
                <StackPanel>
                    <TextBlock Text="Generation History" 
                               Style="{DynamicResource HeadingSmallStyle}"
                               Foreground="{DynamicResource AccentPurpleBrush}"
                               Margin="0,0,0,12"/>
                    
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <ListBox ItemsSource="{Binding GenerationHistory}"
                                 Style="{DynamicResource DarkListBoxStyle}">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Border Padding="8" Margin="0,0,0,4" 
                                            Background="{DynamicResource TertiaryDarkBrush}" 
                                            CornerRadius="4">
                                        <StackPanel>
                                            <TextBlock Text="{Binding Prompt}" 
                                                      Style="{DynamicResource CaptionTextStyle}"
                                                      TextWrapping="Wrap" MaxHeight="40"/>
                                            <TextBlock Text="{Binding Timestamp}" 
                                                      Style="{DynamicResource CodeTextStyle}"
                                                      FontSize="9" 
                                                      Foreground="{DynamicResource TextMutedBrush}"/>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </ScrollViewer>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>

    <!-- Text2Video Template - Professional Video Generation -->
    <DataTemplate x:Key="Text2VideoTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="320"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="280"/>
            </Grid.ColumnDefinitions>
            
            <!-- Controls Panel -->
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="8,0,0,8" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="Video Generation" 
                                   Style="{DynamicResource HeadingSmallStyle}"
                                   Foreground="{DynamicResource AccentPurpleBrush}"
                                   Margin="0,0,0,16"/>
                        
                        <!-- Motion Prompt -->
                        <TextBlock Text="Motion Description" Style="{DynamicResource CaptionTextStyle}"
                                   Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                        <TextBox Style="{DynamicResource DarkTextBoxStyle}" 
                                 MinHeight="80" TextWrapping="Wrap" AcceptsReturn="True"
                                 Margin="0,0,0,16"/>
                        
                        <!-- Professional Video Parameters -->
                        <Expander Header="Video Parameters" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <!-- Duration -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Duration (seconds)" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Column="1" Style="{DynamicResource DarkComboBoxStyle}">
                                        <ComboBoxItem Content="2s"/>
                                        <ComboBoxItem Content="4s" IsSelected="True"/>
                                        <ComboBoxItem Content="8s"/>
                                    </ComboBox>
                                </Grid>
                                
                                <!-- Motion Strength -->
                                <TextBlock Text="Motion Intensity" Margin="0,0,0,4"/>
                                <Slider Value="{Binding MotionIntensity}" 
                                        Minimum="0" Maximum="1" 
                                        TickFrequency="0.1" 
                                        TickPlacement="BottomRight"/>
                                
                                <!-- Frame Rate -->
                                <Grid Margin="0,8,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Frame Rate" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Column="1" 
                                              ItemsSource="{Binding FrameRateOptions}" 
                                              SelectedItem="{Binding SelectedFrameRate}"
                                              DisplayMemberPath="Display"
                                              SelectedValuePath="Value"
                                              Style="{DynamicResource DarkComboBoxStyle}"/>
                                </Grid>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Generate Button -->
                        <Button Content="Generate Video" 
                                Style="{DynamicResource PrimaryButtonStyle}"
                                Padding="0,12" FontSize="14" FontWeight="SemiBold"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>
            
            <!-- Preview Panel -->
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" 
                    Padding="20" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1,0">
                <Grid>
                    <Border Background="{DynamicResource PrimaryDarkBrush}" 
                            CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1"
                            MinHeight="300">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock Text="🎬" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                            <TextBlock Text="Generated video preview" 
                                       Style="{DynamicResource CaptionTextStyle}"
                                       Foreground="{DynamicResource TextMutedBrush}"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>
            
            <!-- History Panel -->
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="0,8,8,0" Padding="16">
                <StackPanel>
                    <TextBlock Text="Video Library" 
                               Style="{DynamicResource HeadingSmallStyle}"
                               Foreground="{DynamicResource AccentPurpleBrush}"
                               Margin="0,0,0,12"/>
                    
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <TextBlock Text="Generated videos will appear here" 
                                   Style="{DynamicResource CaptionTextStyle}"
                                   Foreground="{DynamicResource TextMutedBrush}"/>
                    </ScrollViewer>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>


    <!-- Entity Creation Template - Professional Character Development -->
    <DataTemplate x:Key="EntityCreationTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="320"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="280"/>
            </Grid.ColumnDefinitions>
            
            <!-- Entity Configuration -->
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="8,0,0,8" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="Entity Development" 
                                   Style="{DynamicResource HeadingSmallStyle}"
                                   Foreground="{DynamicResource AccentPurpleBrush}"
                                   Margin="0,0,0,16"/>
                        
                        <!-- Basic Identity -->
                        <Expander Header="Core Identity" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Entity Name" Margin="0,0,0,4"/>
                                <TextBox Style="{DynamicResource DarkTextBoxStyle}" Margin="0,0,0,8"/>
                                
                                <TextBlock Text="Archetype" Margin="0,0,0,4"/>
                                <ComboBox Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8">
                                    <ComboBoxItem Content="Virtual Assistant"/>
                                    <ComboBoxItem Content="Academic Expert"/>
                                    <ComboBoxItem Content="Creative Partner" IsSelected="True"/>
                                    <ComboBoxItem Content="Technical Specialist"/>
                                </ComboBox>
                                
                                <TextBlock Text="Personality Brief" Margin="0,0,0,4"/>
                                <TextBox Style="{DynamicResource DarkTextBoxStyle}" 
                                         MinHeight="60" TextWrapping="Wrap" AcceptsReturn="True"/>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Behavioral Parameters -->
                        <Expander Header="Behavioral Tuning" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <!-- Creativity -->
                                <TextBlock Text="Creativity Level" Margin="0,0,0,4"/>
                                <Slider Value="0.7" Minimum="0" Maximum="1" 
                                        TickFrequency="0.1" TickPlacement="BottomRight" Margin="0,0,0,8"/>
                                
                                <!-- Formality -->
                                <TextBlock Text="Communication Style" Margin="0,0,0,4"/>
                                <Slider Value="0.5" Minimum="0" Maximum="1" 
                                        TickFrequency="0.1" TickPlacement="BottomRight" Margin="0,0,0,8"/>
                                
                                <!-- Response Length -->
                                <TextBlock Text="Response Verbosity" Margin="0,0,0,4"/>
                                <ComboBox Style="{DynamicResource DarkComboBoxStyle}">
                                    <ComboBoxItem Content="Concise"/>
                                    <ComboBoxItem Content="Balanced" IsSelected="True"/>
                                    <ComboBoxItem Content="Detailed"/>
                                </ComboBox>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Voice Integration -->
                        <Expander Header="Voice &amp; Avatar" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Voice Profile" Margin="0,0,0,4"/>
                                <ComboBox Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8">
                                    <ComboBoxItem Content="Neural Voice A"/>
                                    <ComboBoxItem Content="Neural Voice B" IsSelected="True"/>
                                    <ComboBoxItem Content="Custom Voice"/>
                                </ComboBox>
                                
                                <TextBlock Text="Avatar Model" Margin="0,0,0,4"/>
                                <ComboBox Style="{DynamicResource DarkComboBoxStyle}">
                                    <ComboBoxItem Content="Default Humanoid" IsSelected="True"/>
                                    <ComboBoxItem Content="Abstract Form"/>
                                    <ComboBoxItem Content="Custom Model"/>
                                </ComboBox>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Create Button -->
                        <Button Content="Create Entity" 
                                Style="{DynamicResource PrimaryButtonStyle}"
                                Padding="0,12" FontSize="14" FontWeight="SemiBold"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>
            
            <!-- 3D Avatar Preview -->
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" 
                    Padding="20" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1,0">
                <Grid>
                    <Border Background="{DynamicResource PrimaryDarkBrush}" 
                            CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock Text="🧙‍♂️" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,16"/>
                            <TextBlock Text="3D Avatar Renderer" 
                                       Style="{DynamicResource HeadingSmallStyle}"
                                       Foreground="{DynamicResource AccentPurpleBrush}"
                                       HorizontalAlignment="Center" Margin="0,0,0,8"/>
                            <TextBlock Text="Entity appearance will be displayed here" 
                                       Style="{DynamicResource CaptionTextStyle}"
                                       Foreground="{DynamicResource TextMutedBrush}"/>
                            
                            <!-- Camera Controls -->
                            <StackPanel Orientation="Horizontal" Margin="0,16,0,0">
                                <Button Content="🔄" Style="{DynamicResource GhostButtonStyle}" 
                                        ToolTip="Rotate" Margin="0,0,4,0"/>
                                <Button Content="🔍" Style="{DynamicResource GhostButtonStyle}" 
                                        ToolTip="Zoom" Margin="0,0,4,0"/>
                                <Button Content="💡" Style="{DynamicResource GhostButtonStyle}" 
                                        ToolTip="Lighting"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>
            
            <!-- Entity Templates -->
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="0,8,8,0" Padding="16">
                <StackPanel>
                    <TextBlock Text="Entity Templates" 
                               Style="{DynamicResource HeadingSmallStyle}"
                               Foreground="{DynamicResource AccentPurpleBrush}"
                               Margin="0,0,0,12"/>
                    
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <!-- Template Cards -->
                            <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                    CornerRadius="4" Padding="8" Margin="0,0,0,8">
                                <StackPanel>
                                    <TextBlock Text="Creative Partner" FontWeight="SemiBold" FontSize="12"/>
                                    <TextBlock Text="Imaginative • Collaborative • Inspiring" 
                                               Style="{DynamicResource CaptionTextStyle}" FontSize="10"/>
                                    <Button Content="Load Template" Style="{DynamicResource GhostButtonStyle}" 
                                            Padding="4" Margin="0,4,0,0" HorizontalAlignment="Left"/>
                                </StackPanel>
                            </Border>
                            
                            <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                    CornerRadius="4" Padding="8" Margin="0,0,0,8">
                                <StackPanel>
                                    <TextBlock Text="Technical Expert" FontWeight="SemiBold" FontSize="12"/>
                                    <TextBlock Text="Precise • Analytical • Detail-oriented" 
                                               Style="{DynamicResource CaptionTextStyle}" FontSize="10"/>
                                    <Button Content="Load Template" Style="{DynamicResource GhostButtonStyle}" 
                                            Padding="4" Margin="0,4,0,0" HorizontalAlignment="Left"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>

    <!-- 3D Model Viewer Template - Professional 3D Interface -->
    <DataTemplate x:Key="ThreeDModelViewerTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="280"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="280"/>
            </Grid.ColumnDefinitions>
            
            <!-- Model Browser -->
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="8,0,0,8" Padding="16">
                <StackPanel>
                    <TextBlock Text="Model Browser" 
                               Style="{DynamicResource HeadingSmallStyle}"
                               Foreground="{DynamicResource AccentPurpleBrush}"
                               Margin="0,0,0,16"/>
                    
                    <!-- File Tree -->
                    <TreeView Background="Transparent" BorderThickness="0" MaxHeight="400">
                        <TreeViewItem Header="📁 Models" IsExpanded="True">
                            <TreeViewItem Header="📁 Characters">
                                <TreeViewItem Header="🧙‍♂️ wizard.fbx"/>
                                <TreeViewItem Header="👩‍🚀 astronaut.obj"/>
                            </TreeViewItem>
                            <TreeViewItem Header="📁 Environments">
                                <TreeViewItem Header="🏰 castle.blend"/>
                                <TreeViewItem Header="🌍 terrain.fbx"/>
                            </TreeViewItem>
                            <TreeViewItem Header="📁 Objects">
                                <TreeViewItem Header="⚔️ sword.obj"/>
                                <TreeViewItem Header="📚 book.fbx"/>
                            </TreeViewItem>
                        </TreeViewItem>
                    </TreeView>
                    
                    <!-- Load Controls -->
                    <StackPanel Margin="0,16,0,0">
                        <Button Content="Load Selected Model" 
                                Style="{DynamicResource PrimaryButtonStyle}"
                                Padding="0,8" Margin="0,0,0,8"/>
                        <Button Content="Import New Model" 
                                Style="{DynamicResource GhostButtonStyle}"
                                Padding="0,8"/>
                    </StackPanel>
                </StackPanel>
            </Border>
            
            <!-- 3D Viewport -->
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" 
                    Padding="20" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1,0">
                <Grid>
                    <Border Background="{DynamicResource PrimaryDarkBrush}" 
                            CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                        <Grid>
                            <!-- 3D Scene Placeholder -->
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock Text="🎭" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,16"/>
                                <TextBlock Text="3D Viewport" 
                                           Style="{DynamicResource HeadingSmallStyle}"
                                           Foreground="{DynamicResource AccentPurpleBrush}"
                                           HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                <TextBlock Text="Select a model to view in 3D space" 
                                           Style="{DynamicResource CaptionTextStyle}"
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                            </StackPanel>
                            
                            <!-- Viewport Controls Overlay -->
                            <StackPanel VerticalAlignment="Top" HorizontalAlignment="Right" 
                                        Margin="16" Background="{DynamicResource SecondaryDarkBrush}"
                                        Orientation="Horizontal">
                                <Button Content="🔄" Style="{DynamicResource GhostButtonStyle}" 
                                        ToolTip="Orbit" Width="32" Height="32"/>
                                <Button Content="↔️" Style="{DynamicResource GhostButtonStyle}" 
                                        ToolTip="Pan" Width="32" Height="32"/>
                                <Button Content="🔍" Style="{DynamicResource GhostButtonStyle}" 
                                        ToolTip="Zoom" Width="32" Height="32"/>
                                <Button Content="🏠" Style="{DynamicResource GhostButtonStyle}" 
                                        ToolTip="Reset View" Width="32" Height="32"/>
                            </StackPanel>
                            
                            <!-- Render Mode Toggle -->
                            <StackPanel VerticalAlignment="Bottom" HorizontalAlignment="Left" 
                                        Margin="16" Background="{DynamicResource SecondaryDarkBrush}">
                                <ComboBox Style="{DynamicResource DarkComboBoxStyle}" Width="120">
                                    <ComboBoxItem Content="Solid" IsSelected="True"/>
                                    <ComboBoxItem Content="Wireframe"/>
                                    <ComboBoxItem Content="Textured"/>
                                    <ComboBoxItem Content="Lit"/>
                                </ComboBox>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </Border>
            
            <!-- Properties Panel -->
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="0,8,8,0" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="Model Properties" 
                                   Style="{DynamicResource HeadingSmallStyle}"
                                   Foreground="{DynamicResource AccentPurpleBrush}"
                                   Margin="0,0,0,16"/>
                        
                        <!-- Transform Controls -->
                        <Expander Header="Transform" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Position" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Grid.Column="0" Text="0.0" Style="{DynamicResource DarkTextBoxStyle}" Margin="0,0,2,0"/>
                                    <TextBox Grid.Column="1" Text="0.0" Style="{DynamicResource DarkTextBoxStyle}" Margin="2,0"/>
                                    <TextBox Grid.Column="2" Text="0.0" Style="{DynamicResource DarkTextBoxStyle}" Margin="2,0,0,0"/>
                                </Grid>
                                
                                <TextBlock Text="Rotation" Style="{DynamicResource CaptionTextStyle}" Margin="0,8,0,4"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Grid.Column="0" Text="0°" Style="{DynamicResource DarkTextBoxStyle}" Margin="0,0,2,0"/>
                                    <TextBox Grid.Column="1" Text="0°" Style="{DynamicResource DarkTextBoxStyle}" Margin="2,0"/>
                                    <TextBox Grid.Column="2" Text="0°" Style="{DynamicResource DarkTextBoxStyle}" Margin="2,0,0,0"/>
                                </Grid>
                                
                                <TextBlock Text="Scale" Style="{DynamicResource CaptionTextStyle}" Margin="0,8,0,4"/>
                                <TextBox Text="1.0" Style="{DynamicResource DarkTextBoxStyle}"/>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Model Info -->
                        <Expander Header="Model Information" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Grid Margin="0,0,0,4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Vertices:" Style="{DynamicResource CaptionTextStyle}"/>
                                    <TextBlock Grid.Column="1" Text="1,234" Style="{DynamicResource CaptionTextStyle}" HorizontalAlignment="Right"/>
                                </Grid>
                                
                                <Grid Margin="0,0,0,4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Triangles:" Style="{DynamicResource CaptionTextStyle}"/>
                                    <TextBlock Grid.Column="1" Text="2,468" Style="{DynamicResource CaptionTextStyle}" HorizontalAlignment="Right"/>
                                </Grid>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Materials:" Style="{DynamicResource CaptionTextStyle}"/>
                                    <TextBlock Grid.Column="1" Text="3" Style="{DynamicResource CaptionTextStyle}" HorizontalAlignment="Right"/>
                                </Grid>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Export Options -->
                        <Button Content="Export Model" 
                                Style="{DynamicResource PrimaryButtonStyle}"
                                Padding="0,8"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- ===== ADDITIONAL ENTHUSIAST TEMPLATES FOR COMPREHENSIVE COVERAGE ===== -->
    
    <!-- BaseModel Template - Professional Model Selection -->
    <DataTemplate x:Key="BaseModelTemplate">
        <StackPanel Margin="12">
            <TextBlock Text="Select Base Model" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,4"/>
            <ComboBox ItemsSource="{Binding FilteredModels}" SelectedItem="{Binding SelectedModel}" Style="{DynamicResource DarkComboBoxStyle}">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock>
                            <Run Text="{Binding Name}"/>
                            <Run Text=" ("/>
                            <Run Text="{Binding Size}"/>
                            <Run Text=")"/>
                        </TextBlock>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>

            <TextBlock Text="Inference Engine" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,12,0,4"/>
            <ComboBox SelectedItem="{Binding SelectedRunner}" Style="{DynamicResource DarkComboBoxStyle}">
                <ComboBoxItem>llama.cpp</ComboBoxItem>
                <ComboBoxItem>vLLM</ComboBoxItem>
                <ComboBoxItem>ExLlamaV2</ComboBoxItem>
            </ComboBox>

            <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                <Button Content="Load" Command="{Binding LoadModelCommand}" CommandParameter="{Binding SelectedModel}" Style="{StaticResource PrimaryButtonStyle}"/>
                <Button Content="Unload" Command="{Binding UnloadModelCommand}" Style="{StaticResource SecondaryButtonStyle}" Margin="8,0,0,0"/>
            </StackPanel>
        </StackPanel>
    </DataTemplate>
    
    <!-- Advanced Template - Configuration Controls -->
    <DataTemplate x:Key="AdvancedTemplate">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="16">
                <TextBlock Text="Advanced Configuration" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentYellowBrush}" Margin="0,0,0,16"/>
                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16">
                    <TextBlock Text="Load a model to access advanced configuration parameters." Style="{DynamicResource BodyTextStyle}" TextWrapping="Wrap"/>
                </Border>
            </StackPanel>
        </ScrollViewer>
    </DataTemplate>
    
    <!-- ControlNets Template -->
    <DataTemplate x:Key="ControlNetsTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>
            
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6,0,0,6" Padding="16">
                <StackPanel>
                    <TextBlock Text="ControlNet Configuration" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,12"/>
                    <ComboBox Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8">
                        <ComboBoxItem>Canny Edge</ComboBoxItem>
                        <ComboBoxItem>OpenPose</ComboBoxItem>
                        <ComboBoxItem>Depth Map</ComboBoxItem>
                    </ComboBox>
                    <TextBlock Text="Conditioning Scale" Style="{DynamicResource CaptionTextStyle}" Margin="0,8,0,4"/>
                    <Slider Value="1.0" Minimum="0.1" Maximum="2.0" TickFrequency="0.1"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" Padding="16" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1,0">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="Reference Image Preview" Style="{DynamicResource BodyTextStyle}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                    <TextBlock Text="Drop or select reference image" Style="{DynamicResource CaptionTextStyle}" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="0,6,6,0" Padding="16">
                <StackPanel>
                    <TextBlock Text="Processing Options" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,12"/>
                    <CheckBox Content="Preprocessor" Style="{DynamicResource DarkCheckBoxStyle}" IsChecked="True" Margin="0,4"/>
                    <CheckBox Content="Low VRAM Mode" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4"/>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- VAEs Template -->
    <DataTemplate x:Key="VAEsTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>
            
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6,0,0,6" Padding="16">
                <StackPanel>
                    <TextBlock Text="VAE Selection" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,16"/>
                    <ComboBox Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,12">
                        <ComboBoxItem>Default VAE</ComboBoxItem>
                        <ComboBoxItem>kl-f8-anime2.ckpt</ComboBoxItem>
                        <ComboBoxItem>vae-ft-mse-840000-ema.ckpt</ComboBoxItem>
                    </ComboBox>
                    <TextBlock Text="VAEs improve image quality and can affect color saturation, contrast, and overall aesthetic." Style="{DynamicResource CaptionTextStyle}" TextWrapping="Wrap"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="0,6,6,0" Padding="16">
                <StackPanel>
                    <TextBlock Text="Quality Settings" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,12"/>
                    <TextBlock Text="Processing Mode" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <ComboBox Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,12">
                        <ComboBoxItem>Standard</ComboBoxItem>
                        <ComboBoxItem>High Quality</ComboBoxItem>
                        <ComboBoxItem>Tiled (Low VRAM)</ComboBoxItem>
                    </ComboBox>
                    <CheckBox Content="Enable VAE optimization" Style="{DynamicResource DarkCheckBoxStyle}" IsChecked="True"/>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- Additional compact templates for remaining views -->
    <DataTemplate x:Key="HypernetworksTemplate">
        <StackPanel Margin="16">
            <TextBlock Text="Hypernetwork Management" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,12"/>
            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <ComboBox Style="{DynamicResource DarkComboBoxStyle}"><ComboBoxItem>None Selected</ComboBoxItem></ComboBox>
                    <TextBlock Grid.Column="1" Text="Strength: 1.0" Style="{DynamicResource BodyTextStyle}" VerticalAlignment="Center" Margin="12,0,0,0"/>
                </Grid>
            </Border>
        </StackPanel>
    </DataTemplate>
    
    <DataTemplate x:Key="EmbeddingsTemplate">
        <StackPanel Margin="16">
            <TextBlock Text="Textual Inversions" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,12"/>
            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16">
                <TextBlock Text="Available embeddings will appear here after scanning model directories." Style="{DynamicResource CaptionTextStyle}" TextWrapping="Wrap"/>
            </Border>
        </StackPanel>
    </DataTemplate>
    
    <!-- ENHANCED ENTHUSIAST InpaintingTemplate - Collapsible Panels + Contextual Guidance -->
    <DataTemplate x:Key="InpaintingTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="280"/>
            </Grid.ColumnDefinitions>
            
            <!-- Advanced Controls Panel -->
            <Border Grid.Column="0" 
                    Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="8,0,0,8" 
                    Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- Header with Status -->
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Inpainting Studio" 
                                       Style="{DynamicResource HeadingMediumStyle}"/>
                            <Border Grid.Column="1"
                                    Background="{DynamicResource SuccessBrush}"
                                    Padding="6,2"
                                    CornerRadius="4">
                                <TextBlock Text="READY" 
                                           Foreground="{DynamicResource TextPrimaryBrush}"
                                           FontSize="9"
                                           FontWeight="Bold"/>
                            </Border>
                        </Grid>
                        
                        <!-- Essential Controls (Always Visible) -->
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                Padding="12" 
                                CornerRadius="6"
                                Margin="0,0,0,12">
                            <StackPanel>
                                <TextBlock Text="Essential Settings" 
                                           Style="{DynamicResource CaptionTextStyle}"
                                           FontWeight="SemiBold"
                                           Margin="0,0,0,8"/>
                                
                                <!-- Source Image -->
                                <Button Content="📁 Load Source Image" 
                                        Command="{Binding LoadImageCommand}"
                                        Style="{DynamicResource SecondaryButtonStyle}"
                                        Margin="0,0,0,8"/>
                                
                                <!-- Prompt -->
                                <TextBlock Text="Transformation Description" 
                                           Style="{DynamicResource CaptionTextStyle}"
                                           Margin="0,0,0,4"/>
                                <TextBox Text="{Binding Prompt, UpdateSourceTrigger=PropertyChanged}" 
                                         Style="{DynamicResource DarkTextBoxStyle}"
                                         MinHeight="60" 
                                         TextWrapping="Wrap"
                                         Margin="0,0,0,8"/>
                                
                                <!-- Generate Button -->
                                <Button Content="🎨 Generate Inpainting" 
                                        Command="{Binding GenerateCommand}"
                                        Style="{DynamicResource PrimaryButtonStyle}"
                                        Padding="12,8"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- Collapsible Mask Controls -->
                        <Expander Header="Mask &amp; Brush Settings" 
                                  IsExpanded="False"
                                  Margin="0,0,0,8">
                            <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                    Padding="12" 
                                    CornerRadius="6"
                                    Margin="0,4,0,0">
                                <StackPanel>
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <!-- Brush Size -->
                                        <StackPanel Grid.Column="0" Margin="0,0,8,0">
                                            <TextBlock Text="Brush Size" 
                                                       Style="{DynamicResource CaptionTextStyle}"
                                                       Margin="0,0,0,4"/>
                                            <Slider Value="{Binding BrushSize}" 
                                                    Minimum="5" 
                                                    Maximum="100"
                                                    TickFrequency="5"/>
                                            <TextBlock Text="{Binding BrushSize, StringFormat={}Size: {0}px}" 
                                                       Style="{DynamicResource CodeTextStyle}"
                                                       FontSize="10"
                                                       HorizontalAlignment="Center"/>
                                        </StackPanel>
                                        
                                        <!-- Mask Blur -->
                                        <StackPanel Grid.Column="1" Margin="8,0,0,0">
                                            <TextBlock Text="Mask Blur" 
                                                       Style="{DynamicResource CaptionTextStyle}"
                                                       Margin="0,0,0,4"/>
                                            <Slider Value="{Binding MaskBlur}" 
                                                    Minimum="0" 
                                                    Maximum="32"
                                                    TickFrequency="2"/>
                                            <TextBlock Text="{Binding MaskBlur, StringFormat={}Blur: {0}px}" 
                                                       Style="{DynamicResource CodeTextStyle}"
                                                       FontSize="10"
                                                       HorizontalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                    
                                    <!-- Brush Tools -->
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <Button Content="🖌️ Paint" 
                                                Style="{DynamicResource GhostButtonStyle}"
                                                Padding="8,4"
                                                Command="{Binding SetBrushModeCommand}"
                                                CommandParameter="Paint"
                                                Margin="0,0,4,0"/>
                                        <Button Content="🧽 Erase" 
                                                Style="{DynamicResource GhostButtonStyle}"
                                                Padding="8,4"
                                                Command="{Binding SetBrushModeCommand}"
                                                CommandParameter="Erase"
                                                Margin="0,0,4,0"/>
                                        <Button Content="🗑️ Clear" 
                                                Style="{DynamicResource GhostButtonStyle}"
                                                Padding="8,4"
                                                Command="{Binding ClearMaskCommand}"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </Expander>
                        
                        <!-- Collapsible Generation Settings -->
                        <Expander Header="Generation Parameters" 
                                  IsExpanded="False"
                                  Margin="0,0,0,8">
                            <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                    Padding="12" 
                                    CornerRadius="6"
                                    Margin="0,4,0,0">
                                <StackPanel>
                                    <!-- Strength -->
                                    <StackPanel Margin="0,0,0,12">
                                        <TextBlock Text="Inpainting Strength" 
                                                   Style="{DynamicResource CaptionTextStyle}"
                                                   Margin="0,0,0,4"/>
                                        <Slider Value="{Binding Strength}" 
                                                Minimum="0.1" 
                                                Maximum="1.0"
                                                TickFrequency="0.1"/>
                                        <TextBlock Text="{Binding Strength, StringFormat={}Strength: {0:F1}}" 
                                                   Style="{DynamicResource CodeTextStyle}"
                                                   FontSize="10"
                                                   HorizontalAlignment="Center"/>
                                    </StackPanel>
                                    
                                    <!-- Steps and CFG -->
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <StackPanel Grid.Column="0" Margin="0,0,8,0">
                                            <TextBlock Text="Steps" 
                                                       Style="{DynamicResource CaptionTextStyle}"
                                                       Margin="0,0,0,4"/>
                                            <Slider Value="{Binding Steps}" 
                                                    Minimum="10" 
                                                    Maximum="50"/>
                                        </StackPanel>
                                        
                                        <StackPanel Grid.Column="1" Margin="8,0,0,0">
                                            <TextBlock Text="CFG Scale" 
                                                       Style="{DynamicResource CaptionTextStyle}"
                                                       Margin="0,0,0,4"/>
                                            <Slider Value="{Binding CfgScale}" 
                                                    Minimum="1" 
                                                    Maximum="20"/>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Expander>
                        
                        <!-- Contextual Guidance -->
                        <Border Background="{DynamicResource AccentRedBrush}"
                                Padding="10,6"
                                CornerRadius="6"
                                Margin="0,8,0,0"
                                Opacity="0.9">
                            <TextBlock Text="💡 Pro Tip: Lower strength preserves more of the original image. Higher values create more dramatic changes." 
                                       Style="{DynamicResource CaptionTextStyle}"
                                       Foreground="{DynamicResource TextPrimaryBrush}"
                                       FontSize="10"
                                       TextWrapping="Wrap"/>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Border>
            
            <!-- Main Canvas Area -->
            <Border Grid.Column="1" 
                    Background="{DynamicResource TertiaryDarkBrush}" 
                    Padding="12">
                <Grid>
                    <!-- Canvas Content -->
                    <Border Background="{DynamicResource PrimaryDarkBrush}"
                            CornerRadius="4"
                            BorderBrush="{DynamicResource BorderBrush}"
                            BorderThickness="1">
                        <Grid>
                            <Image Source="{Binding SourceImageSource}" 
                                   Stretch="Uniform"
                                   Visibility="{Binding HasSourceImage, Converter={StaticResource BoolToVisibility}}"/>
                            <StackPanel HorizontalAlignment="Center" 
                                        VerticalAlignment="Center"
                                        Visibility="{Binding HasSourceImage, Converter={StaticResource BoolToVisibility}, ConverterParameter=Inverted}">
                                <TextBlock Text="🖼️" 
                                           FontSize="64" 
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,12"
                                           Opacity="0.3"/>
                                <TextBlock Text="Load an image to start inpainting" 
                                           Style="{DynamicResource HeadingSmallStyle}"
                                           HorizontalAlignment="Center"
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="Paint over areas you want to change" 
                                           Style="{DynamicResource CaptionTextStyle}"
                                           HorizontalAlignment="Center"
                                           Foreground="{DynamicResource TextMutedBrush}"
                                           Margin="0,4,0,0"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- Canvas Tools Overlay -->
                    <StackPanel HorizontalAlignment="Right" 
                                VerticalAlignment="Top"
                                Orientation="Horizontal"
                                Margin="8">
                        <Button Content="🔍+" 
                                Style="{DynamicResource GhostButtonStyle}"
                                Padding="6"
                                ToolTip="Zoom in"
                                Command="{Binding ZoomInCommand}"
                                Margin="0,0,2,0"/>
                        <Button Content="🔍-" 
                                Style="{DynamicResource GhostButtonStyle}"
                                Padding="6"
                                ToolTip="Zoom out"
                                Command="{Binding ZoomOutCommand}"
                                Margin="0,0,2,0"/>
                        <Button Content="🔄" 
                                Style="{DynamicResource GhostButtonStyle}"
                                Padding="6"
                                ToolTip="Reset view"
                                Command="{Binding ResetViewCommand}"/>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- Results & History Panel -->
            <Border Grid.Column="2" 
                    Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="0,8,8,0" 
                    Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- Results Header -->
                        <TextBlock Text="Generation Results" 
                                   Style="{DynamicResource HeadingMediumStyle}"
                                   Margin="0,0,0,12"/>
                        
                        <!-- Current Result -->
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="6" 
                                Padding="12"
                                Margin="0,0,0,12">
                            <StackPanel>
                                <TextBlock Text="Current Result" 
                                           Style="{DynamicResource CaptionTextStyle}"
                                           FontWeight="SemiBold"
                                           Margin="0,0,0,8"/>
                                <Border Background="{DynamicResource PrimaryDarkBrush}"
                                        Height="120"
                                        CornerRadius="4"
                                        Margin="0,0,0,8">
                                    <Image Source="{Binding GeneratedImageSource}" 
                                           Stretch="Uniform"
                                           Visibility="{Binding HasGeneratedImage, Converter={StaticResource BoolToVisibility}}"/>
                                </Border>
                                <StackPanel Orientation="Horizontal">
                                    <Button Content="💾" 
                                            Style="{DynamicResource GhostButtonStyle}"
                                            Padding="6,4"
                                            ToolTip="Save result"
                                            Command="{Binding SaveCommand}"
                                            Margin="0,0,4,0"/>
                                    <Button Content="🔄" 
                                            Style="{DynamicResource GhostButtonStyle}"
                                            Padding="6,4"
                                            ToolTip="Regenerate"
                                            Command="{Binding RegenerateCommand}"
                                            Margin="0,0,4,0"/>
                                    <Button Content="📋" 
                                            Style="{DynamicResource GhostButtonStyle}"
                                            Padding="6,4"
                                            ToolTip="Copy to clipboard"
                                            Command="{Binding CopyToClipboardCommand}"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- Generation History -->
                        <TextBlock Text="Recent Results" 
                                   Style="{DynamicResource CaptionTextStyle}"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,8"/>
                        
                        <ItemsControl ItemsSource="{Binding GenerationHistory}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{DynamicResource TertiaryDarkBrush}"
                                            CornerRadius="4"
                                            Padding="8"
                                            Margin="0,0,0,6">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="60"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Image Grid.Column="0"
                                                   Source="{Binding Thumbnail}"
                                                   Width="52" Height="52"
                                                   Stretch="UniformToFill"/>
                                            <StackPanel Grid.Column="1" 
                                                        Margin="8,0,0,0">
                                                <TextBlock Text="{Binding Timestamp, StringFormat={}HH:mm:ss}" 
                                                           Style="{DynamicResource CodeTextStyle}"
                                                           FontSize="10"/>
                                                <TextBlock Text="{Binding Settings}" 
                                                           Style="{DynamicResource CaptionTextStyle}"
                                                           FontSize="9"
                                                           TextTrimming="CharacterEllipsis"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- Image2Image Template -->
    <DataTemplate x:Key="Image2ImageTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="280"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="200"/>
            </Grid.ColumnDefinitions>
            
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6,0,0,6" Padding="12">
                <StackPanel>
                    <TextBlock Text="Image Transformation" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,12"/>
                    <TextBlock Text="Source Image" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <Button Content="Load Image" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                    <Border Background="{DynamicResource TertiaryDarkBrush}" Height="100" CornerRadius="4" Margin="0,0,0,12"/>
                    <TextBlock Text="Transformation Strength" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <Slider Value="0.7" Minimum="0.1" Maximum="1.0"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" Padding="8">
                <TextBlock Text="Result Preview" Style="{DynamicResource BodyTextStyle}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="0,6,6,0" Padding="12">
                <TextBlock Text="Generation History" Style="{DynamicResource HeadingSmallStyle}"/>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- Upscaling Template -->
    <DataTemplate x:Key="UpscalingTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="280"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="200"/>
            </Grid.ColumnDefinitions>
            
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6,0,0,6" Padding="12">
                <StackPanel>
                    <TextBlock Text="Image Upscaling" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,12"/>
                    <TextBlock Text="Upscale Method" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <ComboBox Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8">
                        <ComboBoxItem Content="ESRGAN 4x" IsSelected="True"/>
                        <ComboBoxItem Content="Real-ESRGAN"/>
                        <ComboBoxItem Content="Waifu2x"/>
                    </ComboBox>
                    <TextBlock Text="Scale Factor" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <ComboBox Style="{DynamicResource DarkComboBoxStyle}">
                        <ComboBoxItem Content="2x"/>
                        <ComboBoxItem Content="4x" IsSelected="True"/>
                        <ComboBoxItem Content="8x"/>
                    </ComboBox>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" Padding="8">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="Before/After Comparison" Style="{DynamicResource BodyTextStyle}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                    <TextBlock Text="Load image to begin upscaling" Style="{DynamicResource CaptionTextStyle}" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="0,6,6,0" Padding="12">
                <StackPanel>
                    <TextBlock Text="Quality Settings" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,8"/>
                    <CheckBox Content="Noise Reduction" Style="{DynamicResource DarkCheckBoxStyle}" IsChecked="True" Margin="0,4"/>
                    <CheckBox Content="Preserve Details" Style="{DynamicResource DarkCheckBoxStyle}" IsChecked="True" Margin="0,4"/>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- Video2Video Template -->
    <DataTemplate x:Key="Video2VideoTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>
            
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6,0,0,6" Padding="16">
                <StackPanel>
                    <TextBlock Text="Video Transformation" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentPurpleBrush}" Margin="0,0,0,16"/>
                    <TextBlock Text="Source Video" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <Button Content="Load Video File" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,12"/>
                    <TextBlock Text="Style Prompt" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <TextBox Style="{DynamicResource DarkTextBoxStyle}" MinHeight="60" TextWrapping="Wrap" AcceptsReturn="True" Margin="0,0,0,12"/>
                    <TextBlock Text="Style Strength" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <Slider Value="0.5" Minimum="0.1" Maximum="1.0" TickFrequency="0.1"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" Padding="16">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="🎬" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                    <TextBlock Text="Video Preview" Style="{DynamicResource HeadingSmallStyle}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                    <TextBlock Text="Original and transformed video comparison" Style="{DynamicResource CaptionTextStyle}" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="0,6,6,0" Padding="16">
                <StackPanel>
                    <TextBlock Text="Processing Queue" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,12"/>
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <TextBlock Text="Video processing jobs will appear here" Style="{DynamicResource CaptionTextStyle}" TextWrapping="Wrap"/>
                    </ScrollViewer>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- MotionControl Template -->
    <DataTemplate x:Key="MotionControlTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>
            
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6,0,0,6" Padding="16">
                <StackPanel>
                    <TextBlock Text="Motion Configuration" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,16"/>
                    <TextBlock Text="Camera Motion" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <ComboBox Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,12">
                        <ComboBoxItem Content="Static" IsSelected="True"/>
                        <ComboBoxItem Content="Pan Left"/>
                        <ComboBoxItem Content="Pan Right"/>
                        <ComboBoxItem Content="Zoom In"/>
                        <ComboBoxItem Content="Zoom Out"/>
                    </ComboBox>
                    <TextBlock Text="Motion Speed" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <Slider Value="0.5" Minimum="0.1" Maximum="2.0" TickFrequency="0.1" Margin="0,0,0,12"/>
                    <TextBlock Text="Object Tracking" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <CheckBox Content="Enable tracking" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" Padding="16">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="🎯" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                    <TextBlock Text="Motion Canvas" Style="{DynamicResource HeadingSmallStyle}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                    <TextBlock Text="Visual motion path editor" Style="{DynamicResource CaptionTextStyle}" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="0,6,6,0" Padding="16">
                <StackPanel>
                    <TextBlock Text="Timeline Controls" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,12"/>
                    <TextBlock Text="Keyframe editor for precise motion control" Style="{DynamicResource CaptionTextStyle}" TextWrapping="Wrap"/>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- TemporalEffects Template -->
    <DataTemplate x:Key="TemporalEffectsTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>
            
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6,0,0,6" Padding="16">
                <StackPanel>
                    <TextBlock Text="Temporal Effects" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,16"/>
                    <TextBlock Text="Time Stretching" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <Slider Value="1.0" Minimum="0.25" Maximum="4.0" TickFrequency="0.25" Margin="0,0,0,12"/>
                    <CheckBox Content="Frame Interpolation" Style="{DynamicResource DarkCheckBoxStyle}" IsChecked="True" Margin="0,4"/>
                    <CheckBox Content="Motion Blur" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4"/>
                    <CheckBox Content="Stabilization" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" Padding="16">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="⏱️" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                    <TextBlock Text="Effect Preview" Style="{DynamicResource HeadingSmallStyle}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                    <TextBlock Text="Real-time temporal effect visualization" Style="{DynamicResource CaptionTextStyle}" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="0,6,6,0" Padding="16">
                <StackPanel>
                    <TextBlock Text="Effect Library" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,12"/>
                    <TextBlock Text="Pre-configured temporal effect presets" Style="{DynamicResource CaptionTextStyle}" TextWrapping="Wrap"/>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- Voice Template -->
    <DataTemplate x:Key="VoiceTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>
            
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6,0,0,6" Padding="16">
                <StackPanel>
                    <TextBlock Text="Voice Overview" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentPurpleBrush}" Margin="0,0,0,16"/>
                    <TextBlock Text="Quick Actions" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,8"/>
                    <Button Content="Text-to-Speech" Style="{DynamicResource PrimaryButtonStyle}" Margin="0,0,0,6"/>
                    <Button Content="Voice Cloning" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,6"/>
                    <Button Content="Real-time Synthesis" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,6"/>
                    <Button Content="Audio Processing" Style="{DynamicResource SecondaryButtonStyle}"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" Padding="16">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="🎤" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                    <TextBlock Text="Voice Synthesis Hub" Style="{DynamicResource HeadingSmallStyle}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                    <TextBlock Text="Select a voice feature to begin" Style="{DynamicResource CaptionTextStyle}" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="0,6,6,0" Padding="16">
                <StackPanel>
                    <TextBlock Text="Voice Status" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,12"/>
                    <TextBlock Text="Ready" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentGreenBrush}" Margin="0,0,0,4"/>
                    <TextBlock Text="Available Voices: 5" Style="{DynamicResource CaptionTextStyle}"/>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>
    
    
    <!-- RealTimeSynthesis Template -->
    
    <!-- Entities Template -->
    <DataTemplate x:Key="EntitiesTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>
            
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6,0,0,6" Padding="16">
                <StackPanel>
                    <TextBlock Text="Entity Management" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentPurpleBrush}" Margin="0,0,0,16"/>
                    <Button Content="Create New Entity" Style="{DynamicResource PrimaryButtonStyle}" Margin="0,0,0,8"/>
                    <Button Content="Import Entity" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                    <Button Content="Entity Templates" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,16"/>
                    <TextBlock Text="Active Entities" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,8"/>
                    <ListBox Background="{DynamicResource TertiaryDarkBrush}" BorderThickness="1" BorderBrush="{DynamicResource BorderBrush}" MinHeight="100"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" Padding="16">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="👥" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                    <TextBlock Text="Entity Workspace" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentPurpleBrush}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                    <TextBlock Text="Create or select an entity to begin" Style="{DynamicResource CaptionTextStyle}" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="0,6,6,0" Padding="16">
                <StackPanel>
                    <TextBlock Text="Entity Stats" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,12"/>
                    <TextBlock Text="Total Entities: 0" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <TextBlock Text="Active: 0" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <TextBlock Text="Templates: 4" Style="{DynamicResource CaptionTextStyle}"/>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- BehavioralPatterns Template -->
    <DataTemplate x:Key="BehavioralPatternsTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>
            
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6,0,0,6" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="Behavior Configuration" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,16"/>
                        <TextBlock Text="Personality Traits" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,8"/>
                        
                        <!-- Trait Sliders -->
                        <StackPanel>
                            <TextBlock Text="Creativity" Style="{DynamicResource CaptionTextStyle}" Margin="0,4,0,2"/>
                            <Slider Value="0.7" Minimum="0" Maximum="1" TickFrequency="0.1" Margin="0,0,0,8"/>
                            
                            <TextBlock Text="Formality" Style="{DynamicResource CaptionTextStyle}" Margin="0,4,0,2"/>
                            <Slider Value="0.5" Minimum="0" Maximum="1" TickFrequency="0.1" Margin="0,0,0,8"/>
                            
                            <TextBlock Text="Empathy" Style="{DynamicResource CaptionTextStyle}" Margin="0,4,0,2"/>
                            <Slider Value="0.8" Minimum="0" Maximum="1" TickFrequency="0.1" Margin="0,0,0,8"/>
                            
                            <TextBlock Text="Curiosity" Style="{DynamicResource CaptionTextStyle}" Margin="0,4,0,2"/>
                            <Slider Value="0.6" Minimum="0" Maximum="1" TickFrequency="0.1"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
            
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" Padding="16">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="🧠" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                    <TextBlock Text="Behavioral Script Editor" Style="{DynamicResource HeadingSmallStyle}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                    <TextBlock Text="AI behavior scripting interface" Style="{DynamicResource CaptionTextStyle}" HorizontalAlignment="Center" Margin="0,0,0,16"/>
                    <Border Background="{DynamicResource PrimaryDarkBrush}" CornerRadius="4" Padding="16" MinWidth="300" MinHeight="200">
                        <TextBlock Text="// Entity behavioral patterns\n// Define conversation style, response patterns\n// and interaction preferences here" Style="{DynamicResource CodeTextStyle}" Foreground="{DynamicResource AccentGreenBrush}"/>
                    </Border>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="0,6,6,0" Padding="16">
                <StackPanel>
                    <TextBlock Text="Pattern Library" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,12"/>
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="4" Padding="8" Margin="0,0,0,6">
                                <StackPanel>
                                    <TextBlock Text="Conversational" FontWeight="SemiBold" FontSize="11"/>
                                    <TextBlock Text="Natural dialogue patterns" Style="{DynamicResource CaptionTextStyle}" FontSize="9"/>
                                </StackPanel>
                            </Border>
                            <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="4" Padding="8" Margin="0,0,0,6">
                                <StackPanel>
                                    <TextBlock Text="Professional" FontWeight="SemiBold" FontSize="11"/>
                                    <TextBlock Text="Formal interaction style" Style="{DynamicResource CaptionTextStyle}" FontSize="9"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- InteractionTesting Template -->
    <DataTemplate x:Key="InteractionTestingTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>
            
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6,0,0,6" Padding="16">
                <StackPanel>
                    <TextBlock Text="Test Configuration" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,16"/>
                    <TextBlock Text="Test Entity" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <ComboBox Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,12">
                        <ComboBoxItem Content="Select Entity..."/>
                    </ComboBox>
                    <TextBlock Text="Test Scenario" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <ComboBox Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,12">
                        <ComboBoxItem Content="Casual Conversation" IsSelected="True"/>
                        <ComboBoxItem Content="Problem Solving"/>
                        <ComboBoxItem Content="Creative Task"/>
                        <ComboBoxItem Content="Technical Query"/>
                    </ComboBox>
                    <Button Content="Start Test Session" Style="{DynamicResource PrimaryButtonStyle}"/>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" Padding="16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="Entity Interaction Test" Style="{DynamicResource HeadingSmallStyle}" HorizontalAlignment="Center" Margin="0,0,0,16"/>
                    
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Background="{DynamicResource PrimaryDarkBrush}" Padding="12">
                        <TextBlock Text="Conversation simulation will appear here..." Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                    </ScrollViewer>
                    
                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,12,0,0">
                        <TextBox Style="{DynamicResource DarkTextBoxStyle}" Width="300" Margin="0,0,8,0" Text="Type test message..."/>
                        <Button Content="Send" Style="{DynamicResource PrimaryButtonStyle}" Padding="12,6"/>
                    </StackPanel>
                </Grid>
            </Border>
            
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="0,6,6,0" Padding="16">
                <StackPanel>
                    <TextBlock Text="Test Results" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,12"/>
                    <TextBlock Text="Response Time: --ms" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <TextBlock Text="Coherence: --" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                    <TextBlock Text="Personality Match: --%" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,12"/>
                    <Button Content="Export Test Log" Style="{DynamicResource SecondaryButtonStyle}" Padding="0,6"/>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- EntityManagement Template -->
    <DataTemplate x:Key="EntityManagementTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>
            
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6,0,0,6" Padding="16">
                <StackPanel>
                    <TextBlock Text="Entity Library" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,16"/>
                    <TextBox Style="{DynamicResource DarkTextBoxStyle}" Text="Search entities..." Margin="0,0,0,12"/>
                    <ListBox Background="{DynamicResource TertiaryDarkBrush}" BorderThickness="1" BorderBrush="{DynamicResource BorderBrush}" MinHeight="250" Margin="0,0,0,12"/>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="Edit" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,6,0"/>
                        <Button Content="Delete" Style="{DynamicResource DangerButtonStyle}" Margin="0,0,6,0"/>
                        <Button Content="Export" Style="{DynamicResource GhostButtonStyle}"/>
                    </StackPanel>
                </StackPanel>
            </Border>
            
            <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="Entity Details" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,16"/>
                        
                        <!-- Entity Information Display -->
                        <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="Entity Details Ready" Style="{DynamicResource BodyTextStyle}" HorizontalAlignment="Center"/>
                                <TextBlock Text="Choose an entity from the library to explore details" Style="{DynamicResource CaptionTextStyle}" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- Version History -->
                        <TextBlock Text="Version History" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,8"/>
                        <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" MinHeight="100">
                            <TextBlock Text="Version history will appear here" Style="{DynamicResource CaptionTextStyle}"/>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Border>
            
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="0,6,6,0" Padding="16">
                <StackPanel>
                    <TextBlock Text="Quick Actions" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,12"/>
                    <Button Content="Backup All Entities" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,6"/>
                    <Button Content="Import from File" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,6"/>
                    <Button Content="Entity Statistics" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,12"/>
                    
                    <TextBlock Text="Storage Info" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,8"/>
                    <TextBlock Text="Used: 0 MB" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,2"/>
                    <TextBlock Text="Available: 1024 MB" Style="{DynamicResource CaptionTextStyle}"/>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- ThreeDModels Template - Enthusiast Mode -->
    <DataTemplate x:Key="ThreeDModelsTemplate">
        <Border Padding="16" Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="8">
            <Grid>
                <!-- Main Content (visible when 3D rendering is available) -->
                <StackPanel Visibility="{Binding Has3DRenderingCapability, Converter={StaticResource BoolToVisibility}}">
                    <!-- Professional Header -->
                    <TextBlock Text="3D Model Viewer" 
                               Style="{DynamicResource HeadingLargeStyle}"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,16"/>
                    
                    <!-- Load Model Section -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,16">
                        <Button Content="Load Model" 
                                Command="{Binding LoadModelCommand}"
                                Style="{DynamicResource PrimaryButtonStyle}"
                                Margin="0,0,8,0"/>
                        <Button Content="Import" 
                                Command="{Binding ImportCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Margin="0,0,8,0"/>
                        <Button Content="Recent" 
                                Command="{Binding ShowRecentCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"/>
                    </StackPanel>
                    
                    <!-- Camera Controls -->
                    <TextBlock Text="Camera Controls:" 
                               Style="{DynamicResource BodyTextStyle}"
                               Margin="0,0,0,8"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,16">
                        <Button Content="Rotate" Command="{Binding RotateCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                        <Button Content="Pan" Command="{Binding PanCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                        <Button Content="Zoom In" Command="{Binding ZoomInCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                        <Button Content="Zoom Out" Command="{Binding ZoomOutCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                        <Button Content="Reset View" Command="{Binding ResetViewCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                    </StackPanel>
                    
                    <!-- 3D Viewport -->
                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="4" 
                            MinHeight="300"
                            Margin="0,0,0,16">
                        <Grid>
                            <Viewport3D ClipToBounds="True"
                                       Visibility="{Binding HasModel, Converter={StaticResource BoolToVisibility}}">
                                <Viewport3D.Camera>
                                    <PerspectiveCamera Position="{Binding CameraPosition}" 
                                                       LookDirection="{Binding CameraLookDirection}"
                                                       UpDirection="0,1,0"
                                                       FieldOfView="{Binding FieldOfView}"/>
                                </Viewport3D.Camera>
                                <!-- ModelVisual3D would be bound here -->
                            </Viewport3D>
                            <TextBlock Text="Load a 3D model to begin viewing" 
                                       Style="{DynamicResource CaptionTextStyle}"
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center"
                                       Visibility="{Binding HasModel, Converter={StaticResource BoolToVisibility}, ConverterParameter=Inverted}"/>
                        </Grid>
                    </Border>
                    
                    <!-- Model Information Panel -->
                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="4" 
                            Padding="12"
                            Visibility="{Binding HasModel, Converter={StaticResource BoolToVisibility}}"
                            Margin="0,0,0,16">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="{Binding ModelName}" Style="{DynamicResource BodyTextStyle}" FontWeight="Bold"/>
                                <TextBlock Text="{Binding ModelFormat}" Style="{DynamicResource CaptionTextStyle}"/>
                            </StackPanel>
                            <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                <TextBlock Text="{Binding VertexCount, StringFormat={}{0:N0} vertices}" Style="{DynamicResource CaptionTextStyle}"/>
                                <TextBlock Text="{Binding TriangleCount, StringFormat={}{0:N0} triangles}" Style="{DynamicResource CaptionTextStyle}"/>
                            </StackPanel>
                            <StackPanel Grid.Column="2" HorizontalAlignment="Right">
                                <TextBlock Text="{Binding FileSize}" Style="{DynamicResource CaptionTextStyle}"/>
                                <TextBlock Text="{Binding LoadTime}" Style="{DynamicResource CaptionTextStyle}"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- Action Buttons -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <Button Content="Export Screenshot" 
                                Command="{Binding SaveScreenshotCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Visibility="{Binding HasModel, Converter={StaticResource BoolToVisibility}}"
                                Margin="0,0,8,0"/>
                        <Button Content="Export Model" 
                                Command="{Binding ExportModelCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Visibility="{Binding HasModel, Converter={StaticResource BoolToVisibility}}"
                                Margin="0,0,8,0"/>
                        <Button Content="Clear" 
                                Command="{Binding ClearModelCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Visibility="{Binding HasModel, Converter={StaticResource BoolToVisibility}}"/>
                    </StackPanel>
                </StackPanel>
                
                <!-- Capability Error State (visible when 3D rendering is not available) -->
                <Border Background="{DynamicResource ErrorBrush}" Padding="16" CornerRadius="4"
                        Visibility="{Binding Has3DRenderingCapability, Converter={StaticResource BoolToVisibility}, ConverterParameter=Inverted}">
                    <StackPanel HorizontalAlignment="Center">
                        <TextBlock Text="3D Rendering Not Available" 
                                   Foreground="{DynamicResource TextPrimaryBrush}" 
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,8"/>
                        <TextBlock Text="{Binding ThreeDRenderingError}" 
                                   Foreground="{DynamicResource TextPrimaryBrush}" 
                                   TextWrapping="Wrap"
                                   HorizontalAlignment="Center"/>
                        <Button Content="Switch to Compatible Model" 
                                Command="{Binding SwitchToCompatibleModelCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>
    </DataTemplate>
    
    <!-- ModelPropertiesPanel Template -->
    <DataTemplate x:Key="ModelPropertiesPanelTemplate">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="16">
                <TextBlock Text="3D Model Properties" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,16"/>
                
                <Expander Header="Transform" IsExpanded="True" Margin="0,0,0,12">
                    <Grid Margin="0,8,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <!-- Position Controls -->
                        <StackPanel Grid.Row="0" Margin="0,0,0,8">
                            <TextBlock Text="Position" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBox Grid.Column="0" Text="0.0" Style="{DynamicResource DarkTextBoxStyle}" Margin="0,0,2,0"/>
                                <TextBox Grid.Column="1" Text="0.0" Style="{DynamicResource DarkTextBoxStyle}" Margin="2,0"/>
                                <TextBox Grid.Column="2" Text="0.0" Style="{DynamicResource DarkTextBoxStyle}" Margin="2,0,0,0"/>
                            </Grid>
                        </StackPanel>
                        
                        <!-- Rotation Controls -->
                        <StackPanel Grid.Row="1" Margin="0,0,0,8">
                            <TextBlock Text="Rotation (degrees)" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBox Grid.Column="0" Text="0" Style="{DynamicResource DarkTextBoxStyle}" Margin="0,0,2,0"/>
                                <TextBox Grid.Column="1" Text="0" Style="{DynamicResource DarkTextBoxStyle}" Margin="2,0"/>
                                <TextBox Grid.Column="2" Text="0" Style="{DynamicResource DarkTextBoxStyle}" Margin="2,0,0,0"/>
                            </Grid>
                        </StackPanel>
                        
                        <!-- Scale Controls -->
                        <StackPanel Grid.Row="2">
                            <TextBlock Text="Scale" Style="{DynamicResource CaptionTextStyle}" Margin="0,0,0,4"/>
                            <TextBox Text="1.0" Style="{DynamicResource DarkTextBoxStyle}"/>
                        </StackPanel>
                    </Grid>
                </Expander>
                
                <Expander Header="Model Information" IsExpanded="False">
                    <StackPanel Margin="0,8,0,0">
                        <Grid Margin="0,0,0,4">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="Vertices:" Style="{DynamicResource CaptionTextStyle}"/>
                            <TextBlock Grid.Column="1" Text="--" Style="{DynamicResource CaptionTextStyle}" HorizontalAlignment="Right"/>
                        </Grid>
                        
                        <Grid Margin="0,0,0,4">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="Triangles:" Style="{DynamicResource CaptionTextStyle}"/>
                            <TextBlock Grid.Column="1" Text="--" Style="{DynamicResource CaptionTextStyle}" HorizontalAlignment="Right"/>
                        </Grid>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="Materials:" Style="{DynamicResource CaptionTextStyle}"/>
                            <TextBlock Grid.Column="1" Text="--" Style="{DynamicResource CaptionTextStyle}" HorizontalAlignment="Right"/>
                        </Grid>
                    </StackPanel>
                </Expander>
            </StackPanel>
        </ScrollViewer>
    </DataTemplate>
    
    <!-- ModelTreeView Template -->
    <DataTemplate x:Key="ModelTreeViewTemplate">
        <StackPanel Margin="16">
            <TextBlock Text="3D Model Browser" Style="{DynamicResource HeadingSmallStyle}" Margin="0,0,0,16"/>
            
            <TreeView Background="Transparent" BorderThickness="0">
                <TreeViewItem Header="📁 Models" IsExpanded="True">
                    <TreeViewItem Header="📁 Characters">
                        <TreeViewItem Header="🧙‍♂️ wizard.fbx"/>
                        <TreeViewItem Header="👩‍🚀 astronaut.obj"/>
                        <TreeViewItem Header="🦾 robot.blend"/>
                    </TreeViewItem>
                    <TreeViewItem Header="📁 Environments">
                        <TreeViewItem Header="🏰 castle.fbx"/>
                        <TreeViewItem Header="🌍 terrain.obj"/>
                        <TreeViewItem Header="🏠 house.blend"/>
                    </TreeViewItem>
                    <TreeViewItem Header="📁 Objects">
                        <TreeViewItem Header="⚔️ sword.fbx"/>
                        <TreeViewItem Header="📚 book.obj"/>
                        <TreeViewItem Header="🏺 vase.blend"/>
                    </TreeViewItem>
                </TreeViewItem>
            </TreeView>
            
            <Button Content="Load Selected Model" Style="{DynamicResource PrimaryButtonStyle}" Margin="0,16,0,8"/>
            <Button Content="Import New Model" Style="{DynamicResource SecondaryButtonStyle}"/>
        </StackPanel>
    </DataTemplate>
    
    <!-- ViewportControl Template -->
    <DataTemplate x:Key="ViewportControlTemplate">
        <Grid>
            <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                <Grid>
                    <!-- 3D Scene Placeholder -->
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                        <TextBlock Text="🎭" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,16"/>
                        <TextBlock Text="3D Viewport" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentPurpleBrush}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                        <TextBlock Text="Load a 3D model to begin viewing" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                    </StackPanel>
                    
                    <!-- Viewport Controls Overlay -->
                    <StackPanel VerticalAlignment="Top" HorizontalAlignment="Right" Margin="16" Background="{DynamicResource SecondaryDarkBrush}" Orientation="Horizontal" Opacity="0.9">
                        <Button Content="🔄" Style="{DynamicResource GhostButtonStyle}" ToolTip="Orbit Camera" Width="32" Height="32"/>
                        <Button Content="↔️" Style="{DynamicResource GhostButtonStyle}" ToolTip="Pan View" Width="32" Height="32"/>
                        <Button Content="🔍" Style="{DynamicResource GhostButtonStyle}" ToolTip="Zoom" Width="32" Height="32"/>
                        <Button Content="🏠" Style="{DynamicResource GhostButtonStyle}" ToolTip="Reset View" Width="32" Height="32"/>
                    </StackPanel>
                    
                    <!-- Render Mode Controls -->
                    <StackPanel VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="16" Background="{DynamicResource SecondaryDarkBrush}" Opacity="0.9">
                        <ComboBox Style="{DynamicResource DarkComboBoxStyle}" Width="120">
                            <ComboBoxItem Content="Solid" IsSelected="True"/>
                            <ComboBoxItem Content="Wireframe"/>
                            <ComboBoxItem Content="Textured"/>
                            <ComboBoxItem Content="Lit"/>
                        </ComboBox>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- ENTHUSIAST DASHBOARD: Balanced system info + activity tracking -->
    <DataTemplate x:Key="EnthusiastDashboardViewModelTemplate">
        <dashboard:EnthusiastDashboardView/>
    </DataTemplate>

    <!-- OLD TEMPLATE CONTENT BELOW - TO BE CLEANED UP -->
    <DataTemplate x:Key="OldEnthusiastDashboardTemplate">
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <Grid Margin="24">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/> <!-- System Status -->
                    <RowDefinition Height="Auto"/> <!-- Quick Actions -->
                    <RowDefinition Height="*"/>    <!-- Main Content -->
                </Grid.RowDefinitions>

                <!-- System Health Bar -->
                <Border Grid.Row="0" Style="{StaticResource DarkCardStyle}" Margin="0,0,0,24">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Health Indicator -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <Ellipse Width="16" Height="16" 
                                     Fill="{DynamicResource SuccessBrush}"
                                     VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <TextBlock Text="System Status" 
                                       Style="{StaticResource HeadingSmallStyle}"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- System Info -->
                        <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center">
                            <TextBlock Text="Model Active" 
                                       Style="{StaticResource CodeTextStyle}"
                                       VerticalAlignment="Center" Margin="0,0,24,0"/>
                            <TextBlock Text="4.2GB VRAM" 
                                       Style="{StaticResource CaptionTextStyle}"
                                       VerticalAlignment="Center" Margin="0,0,24,0"/>
                            <TextBlock Text="32 t/s" 
                                       Style="{StaticResource CaptionTextStyle}"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- API Status -->
                        <TextBlock Grid.Column="2" 
                                   Text="Connected"
                                   Style="{StaticResource CaptionTextStyle}"
                                   Foreground="{DynamicResource SuccessBrush}"
                                   VerticalAlignment="Center"/>
                    </Grid>
                </Border>

                <!-- Expanded Quick Actions -->
                <Border Grid.Row="1" Style="{StaticResource DarkCardStyle}" Margin="0,0,0,24">
                    <StackPanel>
                        <TextBlock Text="🚀 Quick Actions" 
                                   Style="{StaticResource HeadingMediumStyle}"
                                   Margin="0,0,0,16"/>
                        
                        <!-- 6 Actions in 3x2 grid -->
                        <UniformGrid Columns="3" Rows="2">
                            <Button Content="💬 Chat" Style="{StaticResource PrimaryButtonStyle}" Margin="0,0,8,8" Padding="20,16"/>
                            <Button Content="🧠 Model" Style="{StaticResource SecondaryButtonStyle}" Margin="4,0,4,8" Padding="20,16"/>
                            <Button Content="🖼️ Image" Style="{StaticResource SecondaryButtonStyle}" Margin="8,0,0,8" Padding="20,16"/>
                            <Button Content="🎬 Video" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,8,0" Padding="20,16"/>
                            <Button Content="⏳ Jobs" Style="{StaticResource SecondaryButtonStyle}" Margin="4,0,4,0" Padding="20,16"/>
                            <Button Content="📊 Data" Style="{StaticResource SecondaryButtonStyle}" Margin="8,0,0,0" Padding="20,16"/>
                        </UniformGrid>
                    </StackPanel>
                </Border>

                <!-- Two-Column Activity + Stats -->
                <Grid Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*"/>
                        <ColumnDefinition Width="1*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Recent Activity -->
                    <Border Grid.Column="0" Style="{StaticResource DarkCardStyle}" Margin="0,0,12,0">
                        <StackPanel>
                            <TextBlock Text="📈 Recent Activity" Style="{StaticResource HeadingMediumStyle}" Margin="0,0,0,16"/>
                            <!-- Sample activity items -->
                            <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12,8" Margin="0,0,0,8">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="💬" FontSize="20" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Chat Session" Style="{StaticResource BodyTextStyle}" FontWeight="SemiBold"/>
                                        <TextBlock Text="Generated 1,247 tokens" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                                    </StackPanel>
                                    <TextBlock Grid.Column="2" Text="2m ago" Style="{StaticResource CaptionTextStyle}" VerticalAlignment="Center"/>
                                </Grid>
                            </Border>
                            <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12,8">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="🧠" FontSize="20" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Model Loaded" Style="{StaticResource BodyTextStyle}" FontWeight="SemiBold"/>
                                        <TextBlock Text="Qwen-2.5-32B-Q4_K_M" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                                    </StackPanel>
                                    <TextBlock Grid.Column="2" Text="15m ago" Style="{StaticResource CaptionTextStyle}" VerticalAlignment="Center"/>
                                </Grid>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- System Statistics -->
                    <Border Grid.Column="1" Style="{StaticResource DarkCardStyle}" Margin="12,0,0,0">
                        <StackPanel>
                            <TextBlock Text="📊 System Overview" Style="{StaticResource HeadingMediumStyle}" Margin="0,0,0,16"/>
                            <!-- GPU Usage -->
                            <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="16,12" Margin="0,0,0,12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="🎮" FontSize="20" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                    <TextBlock Grid.Column="1" Text="GPU Usage" Style="{StaticResource BodyTextStyle}" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="2" Text="67%" Style="{StaticResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" VerticalAlignment="Center"/>
                                </Grid>
                            </Border>
                            <!-- Memory Usage -->
                            <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="16,12" Margin="0,0,0,12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="🧠" FontSize="20" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                    <TextBlock Grid.Column="1" Text="VRAM Usage" Style="{StaticResource BodyTextStyle}" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="2" Text="4.2/8GB" Style="{StaticResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" VerticalAlignment="Center"/>
                                </Grid>
                            </Border>
                            <!-- Performance -->
                            <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="16,12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="⚡" FontSize="20" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                    <TextBlock Grid.Column="1" Text="Speed" Style="{StaticResource BodyTextStyle}" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="2" Text="32 t/s" Style="{StaticResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" VerticalAlignment="Center"/>
                                </Grid>
                            </Border>
                        </StackPanel>
                    </Border>
                </Grid>
            </Grid>
        </ScrollViewer>
    </DataTemplate>
    
    <!-- ENTHUSIAST RUNNER MANAGER: Runner switching + detailed status + controls -->
    <DataTemplate x:Key="EnthusiastRunnerManagerViewModelTemplate">
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <Grid Margin="24">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/> <!-- Header + Status -->
                    <RowDefinition Height="Auto"/> <!-- Control Bar -->
                    <RowDefinition Height="*"/>    <!-- Main Content -->
                </Grid.RowDefinitions>

                <!-- Header + Active Runner Status -->
                <StackPanel Grid.Row="0" Margin="0,0,0,24">
                    <!-- Header -->
                    <StackPanel Margin="0,0,0,20">
                        <TextBlock Text="🏃‍♂️ Runner Manager"
                                   Style="{StaticResource HeadingLargeStyle}"
                                   Foreground="{DynamicResource AccentRedBrush}"/>
                        <TextBlock Text="Control and switch between LLM backends"
                                   Style="{StaticResource BodyTextStyle}"
                                   Margin="0,8,0,0"/>
                    </StackPanel>

                    <!-- Active Runner Status Bar -->
                    <Border Style="{StaticResource DarkCardStyle}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Health Indicator -->
                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                <Ellipse Width="20" Height="20" VerticalAlignment="Center" Margin="0,0,12,0">
                                    <Ellipse.Style>
                                        <Style TargetType="Ellipse">
                                            <Setter Property="Fill" Value="{DynamicResource ErrorBrush}"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsHealthy}" Value="True">
                                                    <Setter Property="Fill" Value="{DynamicResource SuccessBrush}"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Ellipse.Style>
                                </Ellipse>
                                <StackPanel>
                                    <TextBlock Text="Active Runner" Style="{StaticResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <TextBlock Text="{Binding ActiveRunnerName}" Style="{StaticResource HeadingMediumStyle}" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,2,0,0"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- Status Info -->
                            <StackPanel Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock Text="{Binding ActiveRunnerStatus}" Style="{StaticResource BodyTextStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                <TextBlock Text="{Binding StatusMessage}" Style="{StaticResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontFamily="Consolas" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                            </StackPanel>

                            <!-- Quick Controls -->
                            <StackPanel Grid.Column="2" Orientation="Horizontal">
                                <Button Content="🔄 Restart" Command="{Binding RestartRunnerCommand}" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,8,0"/>
                                <Button Content="🔄 Refresh" Command="{Binding RefreshRunnersCommand}" Style="{StaticResource GhostButtonStyle}"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </StackPanel>

                <!-- Control Bar -->
                <Border Grid.Row="1" Style="{StaticResource DarkCardStyle}" Margin="0,0,0,20">
                    <StackPanel Orientation="Horizontal">
                        <Button Content="🔄 Switch Runner" Command="{Binding SwitchRunnerCommand}" Style="{StaticResource PrimaryButtonStyle}" Margin="0,0,12,0"/>
                        <Button Content="🚀 Start" Command="{Binding StartRunnerCommand}" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,8,0"/>
                        <Button Content="🛑 Stop" Command="{Binding StopRunnerCommand}" Style="{StaticResource DangerButtonStyle}" Margin="0,0,8,0"/>
                        <Button Content="⚙️ Configure" Style="{StaticResource GhostButtonStyle}"/>
                    </StackPanel>
                </Border>

                <!-- Two-Column Layout -->
                <Grid Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="1*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Available Runners -->
                    <Border Grid.Column="0" Style="{StaticResource DarkCardStyle}" Margin="0,0,12,0">
                        <StackPanel>
                            <TextBlock Text="🏃‍♂️ Available Runners" Style="{StaticResource HeadingMediumStyle}" Margin="0,0,0,16"/>
                            
                            <!-- Runner List (bound) -->
                            <ItemsControl ItemsSource="{Binding AvailableRunners}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" Padding="16,12" Margin="0,0,0,12">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Grid.Column="0" Text="{Binding Icon}" FontSize="24" VerticalAlignment="Center" Margin="0,0,16,0"/>
                                                <StackPanel Grid.Column="1">
                                                    <TextBlock Text="{Binding Name}" Style="{StaticResource HeadingSmallStyle}"/>
                                                    <TextBlock Text="{Binding Description}" Style="{StaticResource BodyTextStyle}" Margin="0,4,0,0"/>
                                                    <TextBlock Text="{Binding Type}" Style="{StaticResource CaptionTextStyle}" FontFamily="Consolas" Margin="0,4,0,0"/>
                                                </StackPanel>
                                                <Button Grid.Column="2" Content="Activate" Command="{Binding DataContext.SwitchRunnerCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" Style="{StaticResource PrimaryButtonStyle}" IsEnabled="{Binding IsActive, Converter={StaticResource InvertBool}}"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </Border>

                    <!-- System Status & Info -->
                    <Border Grid.Column="1" Style="{StaticResource DarkCardStyle}" Margin="12,0,0,0">
                        <StackPanel>
                            <TextBlock Text="📊 System Status" Style="{StaticResource HeadingMediumStyle}" Margin="0,0,0,16"/>

                            <!-- Current Runner Info -->
                            <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12,8" Margin="0,0,0,16">
                                <StackPanel>
                                    <TextBlock Text="Active Runner Details" Style="{StaticResource CaptionTextStyle}" FontWeight="SemiBold"/>
                                    <Grid Margin="0,8,0,4">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Name:" Style="{StaticResource CaptionTextStyle}" MinWidth="50"/>
                                        <TextBlock Grid.Column="1" Text="LlamaServer" Style="{StaticResource BodyTextStyle}"/>
                                    </Grid>
                                    <Grid Margin="0,0,0,4">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Status:" Style="{StaticResource CaptionTextStyle}" MinWidth="50"/>
                                        <TextBlock Grid.Column="1" Text="Running" Style="{StaticResource BodyTextStyle}" Foreground="{DynamicResource SuccessBrush}"/>
                                    </Grid>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="PID:" Style="{StaticResource CaptionTextStyle}" MinWidth="50"/>
                                        <TextBlock Grid.Column="1" Text="15432" Style="{StaticResource CodeTextStyle}"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Performance Metrics -->
                            <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12,8" Margin="0,0,0,16">
                                <StackPanel>
                                    <TextBlock Text="Performance" Style="{StaticResource CaptionTextStyle}" FontWeight="SemiBold"/>
                                    <Grid Margin="0,8,0,4">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Speed:" Style="{StaticResource CaptionTextStyle}" MinWidth="50"/>
                                        <TextBlock Grid.Column="1" Text="32 tokens/sec" Style="{StaticResource BodyTextStyle}"/>
                                    </Grid>
                                    <Grid Margin="0,0,0,4">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Memory:" Style="{StaticResource CaptionTextStyle}" MinWidth="50"/>
                                        <TextBlock Grid.Column="1" Text="4.2GB VRAM" Style="{StaticResource BodyTextStyle}"/>
                                    </Grid>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Uptime:" Style="{StaticResource CaptionTextStyle}" MinWidth="50"/>
                                        <TextBlock Grid.Column="1" Text="2h 34m" Style="{StaticResource BodyTextStyle}"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Quick Actions -->
                            <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12">
                                <StackPanel>
                                    <TextBlock Text="Quick Actions" Style="{StaticResource CaptionTextStyle}" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                    <UniformGrid Columns="2">
                                        <Button Content="🔧 Config" Style="{StaticResource GhostButtonStyle}" Padding="8,6" Margin="0,0,4,4"/>
                                        <Button Content="📊 Stats" Style="{StaticResource GhostButtonStyle}" Padding="8,6" Margin="4,0,0,4"/>
                                        <Button Content="🔄 Reload" Style="{StaticResource GhostButtonStyle}" Padding="8,6" Margin="0,4,4,0"/>
                                        <Button Content="📋 Logs" Style="{StaticResource GhostButtonStyle}" Padding="8,6" Margin="4,4,0,0"/>
                                    </UniformGrid>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>
                </Grid>
            </Grid>
        </ScrollViewer>
    </DataTemplate>
    
    <!-- Enthusiast Chat Toolbar Template -->
    <DataTemplate x:Key="ChatToolbarTemplate">
        <DockPanel LastChildFill="True" Margin="0,0,0,8">
            <!-- Left: Tabs/Title placeholder -->
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Left">
                <TextBlock Text="Conversations" Style="{StaticResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" VerticalAlignment="Center"/>
            </StackPanel>
            <!-- Right: Controls -->
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                <TextBlock Text="Temp" Style="{StaticResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" VerticalAlignment="Center"/>
                <TextBox Width="60" Margin="6,0,12,0" Text="{Binding Temperature, UpdateSourceTrigger=PropertyChanged, StringFormat=F2}" Style="{StaticResource DarkTextBoxStyle}"/>
                <TextBlock Text="top_p" Style="{StaticResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" VerticalAlignment="Center"/>
                <TextBox Width="60" Margin="6,0,12,0" Text="{Binding TopP, UpdateSourceTrigger=PropertyChanged, StringFormat=F2}" Style="{StaticResource DarkTextBoxStyle}"/>
                <TextBlock Text="max_tokens" Style="{StaticResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" VerticalAlignment="Center"/>
                <TextBox Width="70" Margin="6,0,12,0" Text="{Binding MaxTokens, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkTextBoxStyle}"/>
                <TextBlock Text="T/s:" Style="{StaticResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" VerticalAlignment="Center"/>
                <TextBlock Text="{Binding TokensPerSecond, StringFormat=F1}" Foreground="{DynamicResource TextSecondaryBrush}" VerticalAlignment="Center" Margin="4,0,0,0"/>
            </StackPanel>
        </DockPanel>
    </DataTemplate>

    <!-- Enthusiast Chat Input Template -->
    <DataTemplate x:Key="ChatInputTemplate">
        <StackPanel>
            <!-- System Prompt Editor -->
            <Expander Header="System Prompt" Background="{DynamicResource SecondaryDarkBrush}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,8">
                <TextBox Text="{Binding SystemPrompt, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkTextBoxMultilineStyle}" TextWrapping="Wrap" MinHeight="60"/>
            </Expander>
            <!-- Input + Send/Stop -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox Grid.Column="0"
                         Text="{Binding UserInput, UpdateSourceTrigger=PropertyChanged}"
                         Style="{StaticResource DarkTextBoxMultilineStyle}"
                         MinHeight="60"
                         MaxHeight="200"
                         TextWrapping="Wrap"
                         AcceptsReturn="True"
                         Margin="0,0,8,0"/>
                <Button Grid.Column="1"
                        Content="Send"
                        Command="{Binding SendCommand}"
                        Style="{StaticResource PrimaryButtonStyle}"
                        IsEnabled="{Binding CanSend}"/>
                <Button Grid.Column="2"
                        Content="Stop"
                        Command="{Binding StopCommand}"
                        Style="{StaticResource SecondaryButtonStyle}"
                        Margin="8,0,0,0"
                        IsEnabled="{Binding IsStreaming}"/>
            </Grid>
        </StackPanel>
    </DataTemplate>

    
    <!-- keep existing templates below (unchanged) -->
    
    <!-- Ensure file ends with closing tag -->
</ResourceDictionary>
