<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib">

    <!-- Datasets View - Enthusiast Mode -->
    <DataTemplate x:Key="EnthusiastDatasetsViewModelTemplate">
        <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header / Controls -->
            <DockPanel Grid.Row="0" Margin="12,12,12,8">
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Left">
                    <TextBlock Text="ðŸ“š" FontSize="24" Margin="0,0,8,0" Foreground="{DynamicResource TextPrimaryBrush}"/>
                    <TextBlock Text="Datasets Library" Style="{DynamicResource HeadingLargeStyle}" Foreground="{DynamicResource TextPrimaryBrush}"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                    <Button Content="Upload" Style="{DynamicResource PrimaryButtonStyle}" Command="{Binding ImportDatasetCommand}" Margin="0,0,8,0"/>
                    <Button Content="New" Style="{DynamicResource SecondaryButtonStyle}" Command="{Binding CreateDatasetCommand}" Margin="0,0,8,0"/>
                    <Button Content="Refresh" Style="{DynamicResource SecondaryButtonStyle}" Command="{Binding RefreshDatasetsCommand}"/>
                </StackPanel>
            </DockPanel>

            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="3*"/>
                </Grid.ColumnDefinitions>

                <!-- Left Panel - Dataset List -->
                <Border Grid.Column="0" 
                        Background="{DynamicResource TertiaryDarkBrush}" 
                        BorderBrush="{DynamicResource BorderBrush}" 
                        BorderThickness="0,1,1,0" 
                        Padding="12">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Search/Filter -->
                        <Grid Grid.Row="0" Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox Grid.Column="0" Tag="Search datasets..." 
                                     Background="{DynamicResource TertiaryDarkBrush}"
                                     BorderBrush="{DynamicResource BorderBrush}"
                                     Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <ComboBox Grid.Column="1" Width="100" Margin="8,0,0,0" SelectedIndex="0">
                                <ComboBoxItem>All Types</ComboBoxItem>
                                <ComboBoxItem>Text</ComboBoxItem>
                                <ComboBoxItem>JSONL</ComboBoxItem>
                                <ComboBoxItem>Parquet</ComboBoxItem>
                            </ComboBox>
                        </Grid>

                        <!-- Dataset List -->
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                            <ItemsControl ItemsSource="{Binding Datasets}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                                BorderBrush="{DynamicResource BorderBrush}" 
                                                BorderThickness="1" 
                                                CornerRadius="4" 
                                                Padding="12" 
                                                Margin="0,0,0,8">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>

                                                <TextBlock Grid.Column="0" Text="{Binding TypeIcon}" FontSize="20" Margin="0,0,12,0" VerticalAlignment="Center" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                
                                                <StackPanel Grid.Column="1">
                                                    <TextBlock Text="{Binding Name}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                    <TextBlock Text="{Binding Description}" FontSize="11" Foreground="{DynamicResource TextMutedBrush}" TextTrimming="CharacterEllipsis"/>
                                                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                        <TextBlock Text="{Binding DocumentCount, StringFormat='{}{0:N0} docs'}" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,8,0"/>
                                                        <TextBlock Text="{Binding SizeText}" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                    </StackPanel>
                                                </StackPanel>

                                                <StackPanel Grid.Column="2" VerticalAlignment="Center">
                                                    <TextBlock Text="{Binding StatusText}" FontSize="10" Foreground="{Binding StatusBrush}" HorizontalAlignment="Right"/>
                                                    <TextBlock Text="{Binding LastModified, StringFormat='Updated {0:MMM d}'}" FontSize="9" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Right"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>

                        <!-- Statistics -->
                        <Border Grid.Row="2" Background="{DynamicResource PrimaryDarkBrush}" Padding="8" Margin="0,8,0,0" CornerRadius="4">
                            <StackPanel>
                                <TextBlock Text="Dataset Statistics" FontWeight="SemiBold" FontSize="12" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="{Binding Datasets.Count, StringFormat='Total: {0}'}" FontSize="11" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <TextBlock Grid.Column="1" Text="Size: 2.4 GB" FontSize="11" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Right"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>

                <!-- Right Panel - Dataset Details/Preview -->
                <Border Grid.Column="1" 
                        Background="{DynamicResource SecondaryDarkBrush}" 
                        BorderBrush="{DynamicResource BorderBrush}" 
                        BorderThickness="0,1,0,0" 
                        Padding="16">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Selected Dataset Header -->
                        <StackPanel Grid.Row="0" Margin="0,0,0,16">
                            <TextBlock Text="{Binding SelectedDataset.Name}" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <TextBlock Text="{Binding SelectedDataset.Description}" Style="{DynamicResource BodySmallStyle}" Foreground="{DynamicResource TextMutedBrush}" Margin="0,4,0,0"/>
                        </StackPanel>

                        <!-- Data Preview -->
                        <Border Grid.Row="1" Background="{DynamicResource PrimaryDarkBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" CornerRadius="4" Padding="12">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                
                                <DockPanel Grid.Row="0" Margin="0,0,0,8">
                                    <TextBlock Text="Data Preview" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                                        <TextBlock Text="Page:" Foreground="{DynamicResource TextMutedBrush}" Margin="0,0,4,0"/>
                                        <TextBlock Text="1 / 10" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                    </StackPanel>
                                </DockPanel>

                                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                                    <TextBlock Text="Dataset preview content here..." FontFamily="Consolas" FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                </ScrollViewer>
                            </Grid>
                        </Border>

                        <!-- Actions -->
                        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                            <Button Content="Prepare for Training" Style="{DynamicResource PrimaryButtonStyle}"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </DataTemplate>
    
    <!-- Compatibility aliases in case runtime type name differs -->
    <DataTemplate x:Key="EnthusiastDatasetsViewTemplate">
        <ContentPresenter ContentTemplate="{StaticResource EnthusiastDatasetsViewModelTemplate}"/>
    </DataTemplate>
    <DataTemplate x:Key="EnthusiastDatasetViewModelTemplate">
        <ContentPresenter ContentTemplate="{StaticResource EnthusiastDatasetsViewModelTemplate}"/>
    </DataTemplate>

    <!-- Generic keys so selector fallback (viewModelTypeTemplate) resolves -->
    <DataTemplate x:Key="DatasetsViewModelTemplate">
        <ContentPresenter ContentTemplate="{StaticResource EnthusiastDatasetsViewModelTemplate}"/>
    </DataTemplate>
    <DataTemplate x:Key="DatasetViewModelTemplate">
        <ContentPresenter ContentTemplate="{StaticResource EnthusiastDatasetsViewModelTemplate}"/>
    </DataTemplate>
    
</ResourceDictionary>
