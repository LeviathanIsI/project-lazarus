<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    
    <!-- DEVELOPER TIER: MINIMAL SAFE TEMPLATES -->
    
    <!-- Jobs View Template - Full job control + logs + performance monitoring -->
    <DataTemplate x:Key="DeveloperJobsViewModelTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="350" MinWidth="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="400" MinWidth="350"/>
            </Grid.ColumnDefinitions>
            
            <!-- Left Panel: Advanced Queue Control -->
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="8,0,0,8" Padding="12">
                <StackPanel>
                    <!-- Header with System Stats -->
                    <Grid Margin="0,0,0,12">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal">
                            <TextBlock Text="🔧" FontSize="16" Margin="0,0,6,0"/>
                            <TextBlock Text="Job Control" Style="{DynamicResource HeadingSmallStyle}"/>
                        </StackPanel>
                        
                        <Grid Grid.Row="1" Margin="0,4,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="CPU" Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="45%" Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource AccentRedBrush}"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1">
                                <TextBlock Text="RAM" Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="8.2GB" Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource AccentRedBrush}"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="2">
                                <TextBlock Text="GPU" Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="78%" Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource AccentRedBrush}"/>
                            </StackPanel>
                        </Grid>
                    </Grid>
                    
                    <!-- Advanced Queue Controls -->
                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="4" Padding="8" Margin="0,0,0,12">
                        <StackPanel>
                            <Grid Margin="0,0,0,6">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <Button Grid.Column="0" Content="+" Style="{DynamicResource MinimalButtonStyle}" 
                                        FontSize="12" Width="20" Height="20" Margin="0,0,4,0"/>
                                <ComboBox Grid.Column="1" SelectedItem="High Priority" 
                                          Style="{DynamicResource CompactComboBoxStyle}">
                                    <ComboBoxItem>Low Priority</ComboBoxItem>
                                    <ComboBoxItem>Normal</ComboBoxItem>
                                    <ComboBoxItem>High Priority</ComboBoxItem>
                                    <ComboBoxItem>Critical</ComboBoxItem>
                                </ComboBox>
                                <Button Grid.Column="2" Content="⏸️" Style="{DynamicResource MinimalButtonStyle}" 
                                        FontSize="10" Width="20" Height="20" Margin="4,0,0,0"/>
                            </Grid>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" Text="Concurrent: 3" 
                                           Style="{DynamicResource BodyTextSmallStyle}"/>
                                <TextBlock Grid.Column="1" Text="Queue: Auto" 
                                           Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                    
                    <!-- Job Queue with Priority Indicators -->
                    <TextBlock Text="Queue (Priority Order)" 
                               Style="{DynamicResource BodyTextBoldStyle}"
                               Margin="0,0,0,6"/>
                    <ScrollViewer MaxHeight="250" Margin="0,0,0,12">
                        <ItemsControl ItemsSource="{Binding QueuedJobs}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                            CornerRadius="4" Padding="8" Margin="0,0,0,4"
                                            BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <Border Grid.Column="0" Width="3" Height="20" 
                                                    Background="{DynamicResource AccentRedBrush}" 
                                                    CornerRadius="2" Margin="0,0,8,0"/>
                                            
                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="{Binding Name}" 
                                                           Style="{DynamicResource BodyTextStyle}" FontSize="11"/>
                                                <TextBlock Text="{Binding JobType}" 
                                                           Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"
                                                           Foreground="{DynamicResource TextSecondaryBrush}"/>
                                            </StackPanel>
                                            
                                            <TextBlock Grid.Column="2" Text="P1" 
                                                       Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"
                                                       Foreground="{DynamicResource AccentRedBrush}" 
                                                       Margin="0,0,4,0"/>
                                            
                                            <Button Grid.Column="3" Content="❌" 
                                                    Style="{DynamicResource MinimalButtonStyle}"
                                                    FontSize="8" Width="16" Height="16"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    
                    <!-- Performance Monitoring -->
                    <TextBlock Text="System Monitor" 
                               Style="{DynamicResource BodyTextBoldStyle}"
                               Margin="0,0,0,6"/>
                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="4" Padding="8">
                        <StackPanel>
                            <Grid Margin="0,0,0,4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" Text="Jobs/sec:" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontSize="10"/>
                                <ProgressBar Grid.Column="1" Value="0.7" Maximum="1" Height="4" 
                                             Background="{DynamicResource PrimaryDarkBrush}"
                                             Foreground="{DynamicResource AccentRedBrush}" Margin="6,0"/>
                                <TextBlock Grid.Column="2" Text="2.3" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontSize="10"/>
                            </Grid>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" Text="Throughput:" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontSize="10"/>
                                <ProgressBar Grid.Column="1" Value="0.45" Maximum="1" Height="4" 
                                             Background="{DynamicResource PrimaryDarkBrush}"
                                             Foreground="{DynamicResource SuccessBrush}" Margin="6,0"/>
                                <TextBlock Grid.Column="2" Text="85MB/s" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontSize="10"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>
            
            <!-- Center Panel: Active Jobs with Technical Details -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="12">
                <ScrollViewer>
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <TextBlock Text="🔍" FontSize="16" Margin="0,0,6,0" Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <TextBlock Text="Active Processes" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <Border Background="{DynamicResource AccentRedBrush}" 
                                    CornerRadius="8" Padding="4,2" Margin="8,0,0,0">
                                <TextBlock Text="{Binding ActiveJobs.Count}" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontSize="10"
                                           Foreground="{DynamicResource TextPrimaryBrush}"/>
                            </Border>
                        </StackPanel>
                        
                        <!-- Active Jobs with Process Details -->
                        <ItemsControl ItemsSource="{Binding ActiveJobs}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                            CornerRadius="6" Padding="12" Margin="0,0,0,8"
                                            BorderBrush="{DynamicResource AccentRedBrush}" BorderThickness="1">
                                        <StackPanel>
                                            <!-- Process Header -->
                                            <Grid Margin="0,0,0,8">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="{Binding Name}" 
                                                               Style="{DynamicResource BodyTextBoldStyle}" FontSize="12"
                                                               Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="PID:" Style="{DynamicResource BodyTextSmallStyle}" 
                                                                   FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                        <TextBlock Text="{Binding ProcessId}" Style="{DynamicResource BodyTextSmallStyle}" 
                                                                   FontSize="9" Margin="4,0,0,0"/>
                                                        <TextBlock Text="•" Style="{DynamicResource BodyTextSmallStyle}" 
                                                                   FontSize="9" Margin="6,0" Foreground="{DynamicResource TextMutedBrush}"/>
                                                        <TextBlock Text="{Binding JobType}" Style="{DynamicResource BodyTextSmallStyle}" 
                                                                   FontSize="9" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                    </StackPanel>
                                                </StackPanel>
                                                
                                                <TextBlock Grid.Column="1" Text="{Binding Progress, StringFormat='{}{0:P1}'}" 
                                                           Style="{DynamicResource BodyTextBoldStyle}" FontSize="14"
                                                           Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,8,0"/>
                                                
                                                <StackPanel Grid.Column="2" Orientation="Horizontal">
                                                    <Button Content="⏸️" Style="{DynamicResource MinimalButtonStyle}" 
                                                            FontSize="10" Width="18" Height="18" Margin="0,0,2,0"
                                                            Command="{Binding DataContext.PauseJobCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                            CommandParameter="{Binding}"/>
                                                    <Button Content="❌" Style="{DynamicResource MinimalButtonStyle}" 
                                                            FontSize="10" Width="18" Height="18"
                                                            Command="{Binding DataContext.CancelJobCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                            CommandParameter="{Binding}"/>
                                                </StackPanel>
                                            </Grid>
                                            
                                            <!-- Technical Progress Bar -->
                                            <ProgressBar Value="{Binding Progress}" Maximum="100" 
                                                         Height="6" Margin="0,0,0,8"
                                                         Background="{DynamicResource TertiaryDarkBrush}"
                                                         Foreground="{DynamicResource AccentRedBrush}"/>
                                            
                                            <!-- Technical Metrics Grid -->
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                
                                                <StackPanel Grid.Row="0" Grid.Column="0">
                                                    <TextBlock Text="CPU" Style="{DynamicResource BodyTextSmallStyle}" 
                                                               FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="12%" Style="{DynamicResource BodyTextSmallStyle}" FontSize="9" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Row="0" Grid.Column="1">
                                                    <TextBlock Text="Memory" Style="{DynamicResource BodyTextSmallStyle}" 
                                                               FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="2.1GB" Style="{DynamicResource BodyTextSmallStyle}" FontSize="9" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Row="0" Grid.Column="2">
                                                    <TextBlock Text="Disk I/O" Style="{DynamicResource BodyTextSmallStyle}" 
                                                               FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="45MB/s" Style="{DynamicResource BodyTextSmallStyle}" FontSize="9" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Row="0" Grid.Column="3">
                                                    <TextBlock Text="ETA" Style="{DynamicResource BodyTextSmallStyle}" 
                                                               FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="{Binding EstimatedCompletion, StringFormat='HH:mm:ss'}" 
                                                               Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Row="1" Grid.Column="0">
                                                    <TextBlock Text="Started" Style="{DynamicResource BodyTextSmallStyle}" 
                                                               FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="{Binding StartTime, StringFormat='HH:mm:ss'}" 
                                                               Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Row="1" Grid.Column="1">
                                                    <TextBlock Text="Threads" Style="{DynamicResource BodyTextSmallStyle}" 
                                                               FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="8" Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Row="1" Grid.Column="2">
                                                    <TextBlock Text="Priority" Style="{DynamicResource BodyTextSmallStyle}" 
                                                               FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="High" Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"
                                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Row="1" Grid.Column="3">
                                                    <TextBlock Text="Status" Style="{DynamicResource BodyTextSmallStyle}" 
                                                               FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="{Binding Status}" Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                                                </StackPanel>
                                            </Grid>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        
                        <!-- Empty State -->
                        <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                CornerRadius="6" Padding="20"
                                Visibility="{Binding HasActiveJobs, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="🔧" FontSize="32" HorizontalAlignment="Center" 
                                           Foreground="{DynamicResource TextMutedBrush}" Margin="0,0,0,8"/>
                                <TextBlock Text="System Idle" 
                                           Style="{DynamicResource HeadingSmallStyle}"
                                           HorizontalAlignment="Center" Margin="0,0,0,4"/>
                                <TextBlock Text="No active processes. Queue jobs for execution." 
                                           Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Border>
            
            <!-- Right Panel: Live Logs & Advanced Analytics -->
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="0,8,8,0" Padding="12">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Log Header with Controls -->
                    <Grid Grid.Row="0" Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <TextBlock Text="📄" FontSize="16" Margin="0,0,6,0" Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <TextBlock Text="Live Logs" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextPrimaryBrush}"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <ComboBox SelectedItem="All" Style="{DynamicResource CompactComboBoxStyle}" 
                                      Width="60" Margin="0,0,4,0">
                                <ComboBoxItem>All</ComboBoxItem>
                                <ComboBoxItem>Error</ComboBoxItem>
                                <ComboBoxItem>Warning</ComboBoxItem>
                                <ComboBoxItem>Info</ComboBoxItem>
                                <ComboBoxItem>Debug</ComboBoxItem>
                            </ComboBox>
                            <Button Content="🗑️" Style="{DynamicResource MinimalButtonStyle}" 
                                    FontSize="10" Width="20" Height="20"/>
                        </StackPanel>
                    </Grid>
                    
                    <!-- Live Log Stream -->
                    <Border Grid.Row="1" Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="4" Margin="0,0,0,8">
                        <ScrollViewer x:Name="LogScrollViewer" Padding="8">
                            <StackPanel>
                                <TextBlock Text="[12:34:56] INFO: Job 'Model Download' started (PID: 4521)" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontFamily="Consolas" FontSize="9"
                                           Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,2"/>
                                <TextBlock Text="[12:34:57] DEBUG: Allocated 2.1GB GPU memory" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontFamily="Consolas" FontSize="9"
                                           Foreground="{DynamicResource TextMutedBrush}" Margin="0,0,0,2"/>
                                <TextBlock Text="[12:34:58] INFO: Download progress: 45% (850MB/1.8GB)" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontFamily="Consolas" FontSize="9"
                                           Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,2"/>
                                <TextBlock Text="[12:34:59] WARNING: Network latency spike: 250ms" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontFamily="Consolas" FontSize="9"
                                           Foreground="{DynamicResource WarningBrush}" Margin="0,0,0,2"/>
                                <TextBlock Text="[12:35:00] INFO: Resumed normal download speed" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontFamily="Consolas" FontSize="9"
                                           Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,2"/>
                                <TextBlock Text="[12:35:01] DEBUG: Thread pool: 8/12 threads active" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontFamily="Consolas" FontSize="9"
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                    
                    <!-- Advanced Analytics Panel -->
                    <Border Grid.Row="2" Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="4" Padding="8">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Analytics Header -->
                            <TextBlock Grid.Row="0" Grid.ColumnSpan="2" Text="Performance Analytics" 
                                       Style="{DynamicResource BodyTextBoldStyle}" FontSize="10"
                                       Margin="0,0,0,6"/>
                            
                            <!-- Metrics Row 1 -->
                            <StackPanel Grid.Row="1" Grid.Column="0">
                                <TextBlock Text="Avg. Speed" Style="{DynamicResource BodyTextSmallStyle}" 
                                           FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="85.3 MB/s" Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Row="1" Grid.Column="1">
                                <TextBlock Text="Efficiency" Style="{DynamicResource BodyTextSmallStyle}" 
                                           FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="92.4%" Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"
                                           Foreground="{DynamicResource SuccessBrush}"/>
                            </StackPanel>
                            
                            <!-- Metrics Row 2 -->
                            <StackPanel Grid.Row="2" Grid.Column="0">
                                <TextBlock Text="Errors" Style="{DynamicResource BodyTextSmallStyle}" 
                                           FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="0" Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"
                                           Foreground="{DynamicResource SuccessBrush}"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Row="2" Grid.Column="1">
                                <TextBlock Text="Uptime" Style="{DynamicResource BodyTextSmallStyle}" 
                                           FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="2h 34m" Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                            </StackPanel>
                            
                            <!-- Network Stats -->
                            <StackPanel Grid.Row="3" Grid.ColumnSpan="2" Margin="0,4,0,0">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBlock Grid.Column="0" Text="Network:" 
                                               Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                                    <ProgressBar Grid.Column="1" Value="0.85" Maximum="1" Height="3" 
                                                 Background="{DynamicResource PrimaryDarkBrush}"
                                                 Foreground="{DynamicResource SuccessBrush}" Margin="4,0"/>
                                    <TextBlock Grid.Column="2" Text="85%" 
                                               Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                                </Grid>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </Border>
        </Grid>
    </DataTemplate>
    <!-- Datasets View Template - Full dataset control + embedding parameters + performance monitoring -->
    <DataTemplate x:Key="DeveloperDatasetsViewModelTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="350" MinWidth="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="400" MinWidth="350"/>
            </Grid.ColumnDefinitions>
            
            <!-- Left Panel: Advanced Dataset Control -->
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="8,0,0,8" Padding="12">
                <StackPanel>
                    <!-- Header with System Stats -->
                    <Grid Margin="0,0,0,12">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal">
                            <TextBlock Text="🔧" FontSize="16" Margin="0,0,6,0"/>
                            <TextBlock Text="Dataset Control" Style="{DynamicResource HeadingSmallStyle}"/>
                        </StackPanel>
                        
                        <Grid Grid.Row="1" Margin="0,4,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Disk" Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="2.1GB" Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource AccentRedBrush}"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1">
                                <TextBlock Text="Vectors" Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="45.2K" Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource AccentRedBrush}"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="2">
                                <TextBlock Text="Indexes" Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="3" Style="{DynamicResource BodyTextSmallStyle}"
                                           Foreground="{DynamicResource AccentRedBrush}"/>
                            </StackPanel>
                        </Grid>
                    </Grid>
                    
                    <!-- Advanced Import Controls -->
                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="4" Padding="8" Margin="0,0,0,12">
                        <StackPanel>
                            <Grid Margin="0,0,0,6">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <ComboBox Grid.Column="0" SelectedItem="Auto-detect" 
                                          Style="{DynamicResource CompactComboBoxStyle}">
                                    <ComboBoxItem>Auto-detect</ComboBoxItem>
                                    <ComboBoxItem>PDF Parser</ComboBoxItem>
                                    <ComboBoxItem>Text Splitter</ComboBoxItem>
                                    <ComboBoxItem>Code Parser</ComboBoxItem>
                                </ComboBox>
                                <Button Grid.Column="1" Content="+" Style="{DynamicResource MinimalButtonStyle}" 
                                        FontSize="12" Width="20" Height="20" Margin="4,0,0,0"/>
                            </Grid>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" Text="Chunk: 512" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontSize="10"/>
                                <TextBlock Grid.Column="1" Text="Overlap: 64" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontSize="10"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                    
                    <!-- Dataset List with Technical Details -->
                    <TextBlock Text="Dataset Registry" 
                               Style="{DynamicResource BodyTextBoldStyle}"
                               Margin="0,0,0,6"/>
                    <ScrollViewer MaxHeight="200" Margin="0,0,0,12">
                        <ItemsControl ItemsSource="{Binding Datasets}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                            CornerRadius="4" Padding="8" Margin="0,0,0,4"
                                            BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <!-- Dataset Header -->
                                            <Grid Grid.Row="0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <TextBlock Grid.Column="0" Text="{Binding TypeIcon}" 
                                                           FontSize="12" Margin="0,0,6,0"/>
                                                
                                                <TextBlock Grid.Column="1" Text="{Binding Name}" 
                                                           Style="{DynamicResource BodyTextStyle}" FontSize="11"/>
                                                
                                                <TextBlock Grid.Column="2" Text="{Binding StatusText}" 
                                                           Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"
                                                           Foreground="{DynamicResource SuccessBrush}"/>
                                            </Grid>
                                            
                                            <!-- Technical Metrics -->
                                            <Grid Grid.Row="1" Margin="0,4,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="Docs" Style="{DynamicResource BodyTextSmallStyle}" 
                                                               FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="{Binding DocumentCount}" 
                                                               Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Column="1">
                                                    <TextBlock Text="Chunks" Style="{DynamicResource BodyTextSmallStyle}" 
                                                               FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="{Binding ChunkCount}" 
                                                               Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Column="2">
                                                    <TextBlock Text="Size" Style="{DynamicResource BodyTextSmallStyle}" 
                                                               FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="{Binding SizeText}" 
                                                               Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                                                </StackPanel>
                                            </Grid>
                                            
                                            <!-- Processing Progress -->
                                            <ProgressBar Grid.Row="2" 
                                                         Visibility="{Binding IsProcessing, Converter={StaticResource BoolToVisibility}}"
                                                         Value="{Binding ProcessingProgress}" Maximum="1" Height="3" Margin="0,4,0,0"
                                                         Background="{DynamicResource PrimaryDarkBrush}"
                                                         Foreground="{DynamicResource AccentRedBrush}"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    
                    <!-- Performance Metrics -->
                    <TextBlock Text="Performance" 
                               Style="{DynamicResource BodyTextBoldStyle}"
                               Margin="0,0,0,6"/>
                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="4" Padding="8">
                        <StackPanel>
                            <Grid Margin="0,0,0,4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" Text="Index rate:" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontSize="10"/>
                                <ProgressBar Grid.Column="1" Value="0.6" Maximum="1" Height="4" 
                                             Background="{DynamicResource PrimaryDarkBrush}"
                                             Foreground="{DynamicResource SuccessBrush}" Margin="6,0"/>
                                <TextBlock Grid.Column="2" Text="1.2K/s" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontSize="10"/>
                            </Grid>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" Text="Query time:" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontSize="10"/>
                                <ProgressBar Grid.Column="1" Value="0.2" Maximum="1" Height="4" 
                                             Background="{DynamicResource PrimaryDarkBrush}"
                                             Foreground="{DynamicResource AccentRedBrush}" Margin="6,0"/>
                                <TextBlock Grid.Column="2" Text="45ms" 
                                           Style="{DynamicResource BodyTextSmallStyle}" FontSize="10"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>
            
            <!-- Center Panel: Source Management & Configuration -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="12">
                <ScrollViewer>
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <TextBlock Text="🔍" FontSize="16" Margin="0,0,6,0"/>
                            <TextBlock Text="Source Configuration" Style="{DynamicResource HeadingSmallStyle}"/>
                        </StackPanel>
                        
                        <!-- Source Management with Advanced Options -->
                        <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                CornerRadius="6" Padding="12" Margin="0,0,0,12">
                            <StackPanel>
                                <!-- Advanced Source Controls -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBlock Grid.Column="0" Text="Source Registry" 
                                               Style="{DynamicResource BodyTextBoldStyle}"/>
                                    <Button Grid.Column="1" Content="+ Dir" 
                                            Style="{DynamicResource MinimalButtonStyle}"
                                            FontSize="10" Width="30" Height="18" Margin="0,0,2,0"/>
                                    <Button Grid.Column="2" Content="+ URL" 
                                            Style="{DynamicResource MinimalButtonStyle}"
                                            FontSize="10" Width="30" Height="18" Margin="0,0,2,0"/>
                                    <Button Grid.Column="3" Content="+ API" 
                                            Style="{DynamicResource MinimalButtonStyle}"
                                            FontSize="10" Width="30" Height="18"/>
                                </Grid>
                                
                                <!-- Source List with Processing Details -->
                                <ItemsControl ItemsSource="{Binding RagSources}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                                    CornerRadius="4" Padding="10" Margin="0,0,0,6">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    
                                                    <!-- Source Header -->
                                                    <Grid Grid.Row="0">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        
                                                        <TextBlock Grid.Column="0" Text="{Binding TypeIcon}" 
                                                                   FontSize="14" Margin="0,0,6,0" VerticalAlignment="Center"/>
                                                        
                                                        <StackPanel Grid.Column="1">
                                                            <TextBlock Text="{Binding Name}" 
                                                                       Style="{DynamicResource BodyTextBoldStyle}" FontSize="11"/>
                                                            <TextBlock Text="{Binding Path}" 
                                                                       Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"
                                                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                        </StackPanel>
                                                        
                                                        <Button Grid.Column="2" Content="⚙️" 
                                                                Style="{DynamicResource MinimalButtonStyle}"
                                                                FontSize="10" Width="18" Height="18" Margin="0,0,2,0"/>
                                                        <Button Grid.Column="3" Content="🔄" 
                                                                Style="{DynamicResource MinimalButtonStyle}"
                                                                FontSize="10" Width="18" Height="18" Margin="0,0,2,0"/>
                                                        <Button Grid.Column="4" Content="❌" 
                                                                Style="{DynamicResource MinimalButtonStyle}"
                                                                FontSize="10" Width="18" Height="18"/>
                                                    </Grid>
                                                    
                                                    <!-- Source Metrics -->
                                                    <Grid Grid.Row="1" Margin="0,6,0,0">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>
                                                        
                                                        <StackPanel Grid.Column="0">
                                                            <TextBlock Text="Files" Style="{DynamicResource BodyTextSmallStyle}" 
                                                                       FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                            <TextBlock Text="{Binding FileCount}" 
                                                                       Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                                                        </StackPanel>
                                                        
                                                        <StackPanel Grid.Column="1">
                                                            <TextBlock Text="Size" Style="{DynamicResource BodyTextSmallStyle}" 
                                                                       FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                            <TextBlock Text="{Binding SizeText}" 
                                                                       Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                                                        </StackPanel>
                                                        
                                                        <StackPanel Grid.Column="2">
                                                            <TextBlock Text="Modified" Style="{DynamicResource BodyTextSmallStyle}" 
                                                                       FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                            <TextBlock Text="{Binding LastModified, StringFormat='MM/dd'}" 
                                                                       Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                                                        </StackPanel>
                                                        
                                                        <StackPanel Grid.Column="3">
                                                            <TextBlock Text="Status" Style="{DynamicResource BodyTextSmallStyle}" 
                                                                       FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                            <TextBlock Text="{Binding StatusText}" 
                                                                       Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"
                                                                       Foreground="{DynamicResource SuccessBrush}"/>
                                                        </StackPanel>
                                                    </Grid>
                                                    
                                                    <!-- Processing Progress -->
                                                    <ProgressBar Grid.Row="2" 
                                                                 Visibility="{Binding IsProcessing, Converter={StaticResource BoolToVisibility}}"
                                                                 Value="{Binding ProcessingProgress}" Maximum="1" Height="3" Margin="0,6,0,0"
                                                                 Background="{DynamicResource PrimaryDarkBrush}"
                                                                 Foreground="{DynamicResource AccentRedBrush}"/>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                                
                                <!-- Watch Configuration -->
                                <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                        CornerRadius="4" Padding="8" Margin="0,8,0,0">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Grid.Column="0" Text="Auto-watch:" 
                                                   Style="{DynamicResource BodyTextSmallStyle}" FontSize="10"/>
                                        <CheckBox Grid.Column="1" IsChecked="True" 
                                                  Content="Monitor file changes" Margin="8,0"
                                                  Style="{DynamicResource CheckBoxStyle}"/>
                                        <TextBlock Grid.Column="2" Text="5s interval" 
                                                   Style="{DynamicResource BodyTextSmallStyle}" FontSize="10"/>
                                    </Grid>
                                </Border>
                            </StackPanel>
                        </Border>
                        
                        <!-- Processing Pipeline Status -->
                        <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                CornerRadius="6" Padding="12">
                            <StackPanel>
                                <TextBlock Text="Processing Pipeline" 
                                           Style="{DynamicResource BodyTextBoldStyle}"
                                           Margin="0,0,0,8"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Parse" Style="{DynamicResource BodyTextSmallStyle}" 
                                                   FontSize="10" Foreground="{DynamicResource TextMutedBrush}"/>
                                        <TextBlock Text="Active" Style="{DynamicResource BodyTextSmallStyle}" 
                                                   FontSize="10" Foreground="{DynamicResource SuccessBrush}"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Chunk" Style="{DynamicResource BodyTextSmallStyle}" 
                                                   FontSize="10" Foreground="{DynamicResource TextMutedBrush}"/>
                                        <TextBlock Text="Queue: 23" Style="{DynamicResource BodyTextSmallStyle}" 
                                                   FontSize="10" Foreground="{DynamicResource AccentRedBrush}"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="2">
                                        <TextBlock Text="Embed" Style="{DynamicResource BodyTextSmallStyle}" 
                                                   FontSize="10" Foreground="{DynamicResource TextMutedBrush}"/>
                                        <TextBlock Text="Processing" Style="{DynamicResource BodyTextSmallStyle}" 
                                                   FontSize="10" Foreground="{DynamicResource WarningBrush}"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Border>
            
            <!-- Right Panel: Advanced Index Management & Logs -->
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="0,8,8,0" Padding="12">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Index Management Header -->
                    <Grid Grid.Row="0" Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <TextBlock Text="🧠" FontSize="16" Margin="0,0,6,0"/>
                            <TextBlock Text="Index Control" Style="{DynamicResource HeadingSmallStyle}"/>
                        </StackPanel>
                        
                        <Button Grid.Column="1" Content="⚙️" 
                                Style="{DynamicResource MinimalButtonStyle}" 
                                FontSize="10" Width="20" Height="20" ToolTip="Advanced Settings"/>
                    </Grid>
                    
                    <!-- Embedding Configuration Panel -->
                    <ScrollViewer Grid.Row="1" Margin="0,0,0,8">
                        <StackPanel>
                            <!-- Model Configuration -->
                            <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                    CornerRadius="4" Padding="8" Margin="0,0,0,8">
                                <StackPanel>
                                    <TextBlock Text="Embedding Model" 
                                               Style="{DynamicResource BodyTextBoldStyle}" FontSize="10"
                                               Margin="0,0,0,4"/>
                                    <ComboBox SelectedValue="sentence-transformers/all-MiniLM-L6-v2"
                                              Style="{DynamicResource CompactComboBoxStyle}" FontSize="10">
                                        <ComboBoxItem>sentence-transformers/all-MiniLM-L6-v2</ComboBoxItem>
                                        <ComboBoxItem>text-embedding-ada-002</ComboBoxItem>
                                        <ComboBoxItem>intfloat/e5-base-v2</ComboBoxItem>
                                        <ComboBoxItem>local-embedding-model</ComboBoxItem>
                                    </ComboBox>
                                    
                                    <Grid Margin="0,4,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Dims" Style="{DynamicResource BodyTextSmallStyle}" 
                                                       FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="384" Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                                        </StackPanel>
                                        
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="Batch" Style="{DynamicResource BodyTextSmallStyle}" 
                                                       FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="32" Style="{DynamicResource BodyTextSmallStyle}" FontSize="9"/>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            
                            <!-- Active Indexes with Controls -->
                            <TextBlock Text="Index Registry" 
                                       Style="{DynamicResource BodyTextBoldStyle}" FontSize="10"
                                       Margin="0,0,0,4"/>
                            <ItemsControl ItemsSource="{Binding EmbeddingIndexes}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                                CornerRadius="4" Padding="8" Margin="0,0,0,4">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                
                                                <!-- Index Header -->
                                                <Grid Grid.Row="0">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    
                                                    <TextBlock Grid.Column="0" Text="{Binding Name}" 
                                                               Style="{DynamicResource BodyTextBoldStyle}" FontSize="10"/>
                                                    <Button Grid.Column="1" Content="🔄" 
                                                            Style="{DynamicResource MinimalButtonStyle}"
                                                            FontSize="8" Width="16" Height="16" Margin="0,0,2,0"/>
                                                    <Button Grid.Column="2" Content="❌" 
                                                            Style="{DynamicResource MinimalButtonStyle}"
                                                            FontSize="8" Width="16" Height="16"/>
                                                </Grid>
                                                
                                                <!-- Index Stats -->
                                                <Grid Grid.Row="1" Margin="0,4,0,0">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    
                                                    <StackPanel Grid.Column="0">
                                                        <TextBlock Text="Vec" Style="{DynamicResource BodyTextSmallStyle}" 
                                                                   FontSize="8" Foreground="{DynamicResource TextMutedBrush}"/>
                                                        <TextBlock Text="{Binding VectorCount}" 
                                                                   Style="{DynamicResource BodyTextSmallStyle}" FontSize="8"/>
                                                    </StackPanel>
                                                    
                                                    <StackPanel Grid.Column="1">
                                                        <TextBlock Text="Size" Style="{DynamicResource BodyTextSmallStyle}" 
                                                                   FontSize="8" Foreground="{DynamicResource TextMutedBrush}"/>
                                                        <TextBlock Text="{Binding SizeText}" 
                                                                   Style="{DynamicResource BodyTextSmallStyle}" FontSize="8"/>
                                                    </StackPanel>
                                                    
                                                    <StackPanel Grid.Column="2">
                                                        <TextBlock Text="Perf" Style="{DynamicResource BodyTextSmallStyle}" 
                                                                   FontSize="8" Foreground="{DynamicResource TextMutedBrush}"/>
                                                        <TextBlock Text="{Binding QueryTimeMs, StringFormat='{}{0}ms'}" 
                                                                   Style="{DynamicResource BodyTextSmallStyle}" FontSize="8"/>
                                                    </StackPanel>
                                                </Grid>
                                                
                                                <!-- Health Indicator -->
                                                <ProgressBar Grid.Row="2" 
                                                             Value="{Binding Health}" Maximum="1" Height="2" Margin="0,4,0,0"
                                                             Background="{DynamicResource PrimaryDarkBrush}"
                                                             Foreground="{DynamicResource SuccessBrush}"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            
                            <!-- Index Operations -->
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="+ Create Index" 
                                        Style="{DynamicResource PrimaryButtonStyle}" FontSize="10"
                                        Margin="0,0,0,4"/>
                                <Button Content="Optimize All" 
                                        Style="{DynamicResource SecondaryButtonStyle}" FontSize="10"
                                        Margin="0,0,0,4"/>
                                <Button Content="Backup Indexes" 
                                        Style="{DynamicResource SecondaryButtonStyle}" FontSize="10"/>
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                    
                    <!-- System Logs Panel -->
                    <Border Grid.Row="2" Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="4" Padding="8" Height="120">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <Grid Grid.Row="0" Margin="0,0,0,4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" Text="System Logs" 
                                           Style="{DynamicResource BodyTextBoldStyle}" FontSize="10"/>
                                <Button Grid.Column="1" Content="🗑️" 
                                        Style="{DynamicResource MinimalButtonStyle}"
                                        FontSize="8" Width="16" Height="16"/>
                            </Grid>
                            
                            <ScrollViewer Grid.Row="1">
                                <StackPanel>
                                    <TextBlock Text="[12:34:56] INFO: Index 'docs-v2' rebuilt (2.1s)" 
                                               Style="{DynamicResource BodyTextSmallStyle}" FontFamily="Consolas" FontSize="8"
                                               Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,1"/>
                                    <TextBlock Text="[12:34:55] DEBUG: Processed 1,234 chunks" 
                                               Style="{DynamicResource BodyTextSmallStyle}" FontFamily="Consolas" FontSize="8"
                                               Foreground="{DynamicResource TextMutedBrush}" Margin="0,0,0,1"/>
                                    <TextBlock Text="[12:34:54] INFO: Source '/docs/manual.pdf' updated" 
                                               Style="{DynamicResource BodyTextSmallStyle}" FontFamily="Consolas" FontSize="8"
                                               Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,1"/>
                                    <TextBlock Text="[12:34:53] WARNING: Embedding batch timeout (3s)" 
                                               Style="{DynamicResource BodyTextSmallStyle}" FontFamily="Consolas" FontSize="8"
                                               Foreground="{DynamicResource WarningBrush}" Margin="0,0,0,1"/>
                                    <TextBlock Text="[12:34:52] DEBUG: Memory usage: 1.2GB / 4GB" 
                                               Style="{DynamicResource BodyTextSmallStyle}" FontFamily="Consolas" FontSize="8"
                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                </Grid>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- Model Selection Template - Basic Binding -->
    <DataTemplate x:Key="ModelSelectionTemplate">
        <Border Margin="2" Padding="4" 
                Background="{DynamicResource SecondaryDarkBrush}"
                CornerRadius="2">
            <StackPanel>
                <TextBlock Text="{Binding Name}" 
                           Foreground="{DynamicResource TextPrimaryBrush}" 
                           FontSize="10"/>
                <TextBlock Text="{Binding Size}" 
                           Foreground="{DynamicResource TextMutedBrush}" 
                           FontSize="9"/>
            </StackPanel>
        </Border>
    </DataTemplate>
    
    <!-- Parameter Control Template - Simple -->
    <DataTemplate x:Key="ParameterControlTemplate">
        <Border Margin="2" Padding="4" 
                Background="{DynamicResource TertiaryDarkBrush}"
                CornerRadius="2">
            <TextBlock Text="Developer Parameter Control" 
                       Foreground="{DynamicResource TextPrimaryBrush}"
                       FontSize="10"/>
        </Border>
    </DataTemplate>
<!-- Removed stray closing tag to maintain a single root ResourceDictionary -->
    <DataTemplate x:Key="ChatMessageTemplate">
        <Border Margin="6,3" 
                Padding="12,8"
                Background="{DynamicResource SecondaryDarkBrush}"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="1"
                CornerRadius="6">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Technical Header with Expanded Metrics -->
                <Grid Grid.Row="0" Margin="0,0,0,6">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Role with Type Indicator -->
                    <Border Grid.Column="0" 
                            Background="{DynamicResource AccentRedBrush}"
                            Padding="6,2"
                            CornerRadius="4"
                            Margin="0,0,8,0">
                        <TextBlock Text="{Binding Role, Converter={StaticResource RoleToDisplayName}}" 
                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                   FontWeight="Bold"
                                   FontSize="10"/>
                    </Border>
                    
                    <!-- Message ID -->
                    <TextBlock Grid.Column="2" 
                               Text="{Binding MessageId, StringFormat={}ID:{0}}" 
                               Foreground="{DynamicResource TextMutedBrush}"
                               FontFamily="Consolas"
                               FontSize="9"
                               VerticalAlignment="Center"
                               Margin="0,0,8,0"/>
                    
                    <!-- Generation Time -->
                    <TextBlock Grid.Column="3" 
                               Text="{Binding GenerationTime, StringFormat={}{0}ms}" 
                               Foreground="{DynamicResource WarningBrush}"
                               FontFamily="Consolas"
                               FontSize="9"
                               VerticalAlignment="Center"
                               Margin="0,0,8,0"/>
                    
                    <!-- Precise Timestamp -->
                    <TextBlock Grid.Column="4" 
                               Text="{Binding Timestamp, StringFormat=HH:mm:ss.fff}" 
                               Foreground="{DynamicResource TextMutedBrush}"
                               FontFamily="Consolas"
                               FontSize="9"
                               VerticalAlignment="Center"/>
                </Grid>
                
                <!-- Message Content with Monospace Option -->
                <Border Grid.Row="1" 
                        Background="{DynamicResource TertiaryDarkBrush}"
                        Padding="8"
                        CornerRadius="4"
                        Margin="0,0,0,6">
                    <TextBlock Text="{Binding Text}" 
                               Foreground="{DynamicResource TextPrimaryBrush}"
                               FontSize="11"
                               FontFamily="Consolas"
                               TextWrapping="Wrap"
                               LineHeight="16"/>
                </Border>
                
                <!-- Comprehensive Technical Metrics -->
                <Grid Grid.Row="2" Margin="0,0,0,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Token Analytics -->
                    <StackPanel Grid.Column="0" Margin="0,0,8,0">
                        <TextBlock Text="TOKENS" 
                                   Style="{DynamicResource CodeTextStyle}"
                                   FontWeight="Bold"
                                   FontSize="8"
                                   Foreground="{DynamicResource AccentRedBrush}"/>
                        <TextBlock Text="{Binding TokenCount, StringFormat={}Count: {0}}" 
                                   Style="{DynamicResource CodeTextStyle}"
                                   FontSize="9"/>
                        <TextBlock Text="{Binding TokensPerSecond, StringFormat={}Rate: {0:F1}/s}" 
                                   Style="{DynamicResource CodeTextStyle}"
                                   FontSize="9"/>
                    </StackPanel>
                    
                    <!-- Model Information -->
                    <StackPanel Grid.Column="1" Margin="0,0,8,0">
                        <TextBlock Text="MODEL" 
                                   Style="{DynamicResource CodeTextStyle}"
                                   FontWeight="Bold"
                                   FontSize="8"
                                   Foreground="{DynamicResource AccentRedBrush}"/>
                        <TextBlock Text="{Binding ModelUsed}" 
                                   Style="{DynamicResource CodeTextStyle}"
                                   FontSize="9"/>
                        <TextBlock Text="{Binding ModelVersion, StringFormat={}v{0}}" 
                                   Style="{DynamicResource CodeTextStyle}"
                                   FontSize="9"/>
                    </StackPanel>
                    
                    <!-- Performance Metrics -->
                    <StackPanel Grid.Column="2">
                        <TextBlock Text="PERF" 
                                   Style="{DynamicResource CodeTextStyle}"
                                   FontWeight="Bold"
                                   FontSize="8"
                                   Foreground="{DynamicResource AccentRedBrush}"/>
                        <TextBlock Text="{Binding CpuUsage, StringFormat={}CPU: {0:F1}%}" 
                                   Style="{DynamicResource CodeTextStyle}"
                                   FontSize="9"/>
                        <TextBlock Text="{Binding MemoryUsage, StringFormat={}RAM: {0}MB}" 
                                   Style="{DynamicResource CodeTextStyle}"
                                   FontSize="9"/>
                    </StackPanel>
                </Grid>
                
                <!-- Collapsible JSON Debug Panel -->
                <Expander Grid.Row="3" 
                          Header="Raw JSON Debug Data" 
                          IsExpanded="False"
                          Margin="0,2,0,0">
                    <Border Background="{DynamicResource PrimaryDarkBrush}"
                            BorderBrush="{DynamicResource BorderBrush}"
                            BorderThickness="1"
                            Padding="8"
                            CornerRadius="4"
                            Margin="0,4,0,0">
                        <ScrollViewer MaxHeight="200" 
                                      VerticalScrollBarVisibility="Auto"
                                      HorizontalScrollBarVisibility="Auto">
                            <TextBlock Text="{Binding JsonDebugData}" 
                                       FontFamily="Consolas"
                                       FontSize="9"
                                       Foreground="{DynamicResource SuccessBrush}"
                                       TextWrapping="NoWrap"/>
                        </ScrollViewer>
                    </Border>
                </Expander>
                
                <!-- Advanced Debug Actions -->
                <StackPanel Grid.Row="4" 
                            Orientation="Horizontal" 
                            HorizontalAlignment="Right"
                            Margin="0,4,0,0">
                    <Button Content="📋 Copy JSON" 
                            Style="{DynamicResource GhostButtonStyle}"
                            Padding="4,2"
                            FontSize="9"
                            Command="{Binding CopyJsonCommand}"
                            Margin="0,0,4,0"/>
                    <Button Content="🔬 Inspect" 
                            Style="{DynamicResource GhostButtonStyle}"
                            Padding="4,2"
                            FontSize="9"
                            Command="{Binding InspectCommand}"
                            Margin="0,0,4,0"/>
                    <Button Content="📊 Profile" 
                            Style="{DynamicResource GhostButtonStyle}"
                            Padding="4,2"
                            FontSize="9"
                            Command="{Binding ProfileCommand}"/>
                </StackPanel>
            </Grid>
        </Border>
    </DataTemplate>
    
    <!-- Chat Status Template - Simple -->
    <DataTemplate x:Key="ChatStatusTemplate">
        <Border Padding="20" 
                Background="{DynamicResource PrimaryDarkBrush}"
                CornerRadius="4"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="1">
            <StackPanel MaxWidth="800">
                <!-- Technical Header -->
                <Grid Margin="0,0,0,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="🔧 LAZARUS INFERENCE ENGINE" 
                                   FontFamily="Consolas"
                                   FontSize="18" 
                                   FontWeight="Bold" 
                                   Foreground="{DynamicResource AccentRedBrush}"/>
                        <TextBlock Text="Model configuration required for neural network initialization" 
                                   FontFamily="Consolas"
                                   FontSize="11" 
                                   Foreground="{DynamicResource TextMutedBrush}"
                                   Margin="0,4,0,0"/>
                    </StackPanel>
                    
                    <Border Grid.Column="1" 
                            Background="{DynamicResource TertiaryDarkBrush}"
                            Padding="8,4"
                            CornerRadius="4">
                        <TextBlock Text="STATUS: IDLE" 
                                   FontFamily="Consolas"
                                   FontSize="10" 
                                   FontWeight="Bold"
                                   Foreground="{DynamicResource WarningBrush}"/>
                    </Border>
                </Grid>
                
                <!-- Technical Configuration Grid -->
                <Border Background="{DynamicResource TertiaryDarkBrush}"
                        Padding="16"
                        CornerRadius="4"
                        Margin="0,0,0,16">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Model Loading -->
                        <StackPanel Grid.Column="0" Margin="0,0,16,0">
                            <TextBlock Text="⚙️ MODEL RUNTIME" 
                                       FontFamily="Consolas"
                                       FontSize="12" 
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource AccentRedBrush}"
                                       Margin="0,0,0,8"/>
                            <TextBlock Text="• Load GGUF/SafeTensors" 
                                       FontFamily="Consolas"
                                       FontSize="10" 
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <TextBlock Text="• Configure quantization" 
                                       FontFamily="Consolas"
                                       FontSize="10" 
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <TextBlock Text="• Set context length" 
                                       FontFamily="Consolas"
                                       FontSize="10" 
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                        </StackPanel>
                        
                        <!-- Advanced Features -->
                        <StackPanel Grid.Column="1" Margin="0,0,16,0">
                            <TextBlock Text="🚀 OPTIMIZATION" 
                                       FontFamily="Consolas"
                                       FontSize="12" 
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource AccentPurpleBrush}"
                                       Margin="0,0,0,8"/>
                            <TextBlock Text="• LoRA stack management" 
                                       FontFamily="Consolas"
                                       FontSize="10" 
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <TextBlock Text="• GPU acceleration" 
                                       FontFamily="Consolas"
                                       FontSize="10" 
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <TextBlock Text="• Memory optimization" 
                                       FontFamily="Consolas"
                                       FontSize="10" 
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                        </StackPanel>
                        
                        <!-- Debug & Monitoring -->
                        <StackPanel Grid.Column="2">
                            <TextBlock Text="📊 MONITORING" 
                                       FontFamily="Consolas"
                                       FontSize="12" 
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource SuccessBrush}"
                                       Margin="0,0,0,8"/>
                            <TextBlock Text="• Real-time metrics" 
                                       FontFamily="Consolas"
                                       FontSize="10" 
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <TextBlock Text="• Token analysis" 
                                       FontFamily="Consolas"
                                       FontSize="10" 
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <TextBlock Text="• Performance profiling" 
                                       FontFamily="Consolas"
                                       FontSize="10" 
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <!-- Action Buttons -->
                <UniformGrid Columns="3" Margin="0,0,0,16">
                    <Button Content="INIT MODEL RUNTIME" 
                            FontFamily="Consolas"
                            FontSize="11"
                            FontWeight="Bold"
                            Background="{DynamicResource AccentRedBrush}"
                            Foreground="White"
                            BorderThickness="0"
                            Padding="12,8"
                            Margin="0,0,4,0"/>
                    
                    <Button Content="CONNECT REMOTE API" 
                            FontFamily="Consolas"
                            FontSize="11"
                            FontWeight="Bold"
                            Background="{DynamicResource AccentPurpleBrush}"
                            Foreground="White"
                            BorderThickness="0"
                            Padding="12,8"
                            Margin="2,0"/>
                    
                    <Button Content="DEBUG CONSOLE" 
                            FontFamily="Consolas"
                            FontSize="11"
                            FontWeight="Bold"
                            Background="{DynamicResource SuccessBrush}"
                            Foreground="White"
                            BorderThickness="0"
                            Padding="12,8"
                            Margin="4,0,0,0"/>
                </UniformGrid>
                
                <!-- Technical Status -->
                <Border Background="{DynamicResource SecondaryDarkBrush}"
                        Padding="12,8"
                        CornerRadius="2">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" 
                                   Text="SYSTEM:" 
                                   FontFamily="Consolas"
                                   FontSize="10" 
                                   Foreground="{DynamicResource TextMutedBrush}"/>
                        
                        <TextBlock Grid.Column="1" 
                                   Text="Neural network infrastructure ready. Awaiting model initialization for inference operations." 
                                   FontFamily="Consolas"
                                   FontSize="10" 
                                   Foreground="{DynamicResource TextSecondaryBrush}"
                                   Margin="8,0"/>
                        
                        <TextBlock Grid.Column="2" 
                                   Text="v2.0.1" 
                                   FontFamily="Consolas"
                                   FontSize="9" 
                                   Foreground="{DynamicResource TextMutedBrush}"/>
                    </Grid>
                </Border>
            </StackPanel>
        </Border>
    </DataTemplate>
    
    <!-- Status Display Template - Simple -->
    <DataTemplate x:Key="StatusDisplayTemplate">
        <Border Margin="2" Padding="4" 
                Background="{DynamicResource SecondaryDarkBrush}"
                CornerRadius="2">
            <TextBlock Text="Developer Status Display" 
                       Foreground="{DynamicResource TextPrimaryBrush}"
                       FontSize="10"/>
        </Border>
    </DataTemplate>
    
    <!-- Generation Progress Template - Simple -->
    <DataTemplate x:Key="GenerationProgressTemplate">
        <Border Margin="2" Padding="4" 
                Background="{DynamicResource TertiaryDarkBrush}"
                CornerRadius="2">
            <TextBlock Text="Developer Generation Progress" 
                       Foreground="{DynamicResource TextPrimaryBrush}"
                       FontSize="10"/>
        </Border>
    </DataTemplate>
    
    <!-- DEVELOPER LoRACardTemplate - polished pro controls with badges and better spacing -->
    <DataTemplate x:Key="LoRACardTemplate">
        <Border Margin="6" Padding="12"
                Background="{DynamicResource SecondaryDarkBrush}"
                CornerRadius="8"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Header with enable, name and category badge -->
                <Grid Grid.Row="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <CheckBox Grid.Column="0" IsChecked="{Binding IsEnabled}" VerticalAlignment="Center"/>
                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,8,0">
                        <TextBlock Text="{Binding Name}" Foreground="{DynamicResource TextPrimaryBrush}" FontWeight="SemiBold"/>
                        <Border Background="{DynamicResource AccentPurpleBrush}" CornerRadius="10" Padding="8,2">
                            <TextBlock Text="{Binding Category}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource AccentTextBrush}"/>
                        </Border>
                    </StackPanel>
                    <TextBlock Grid.Column="2" Text="{Binding FormattedFileSize}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                </Grid>

                <!-- Metadata row: base model • library -->
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,6,0,0">
                    <TextBlock Text="{Binding BaseModel}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                    <TextBlock Text="  •  " Foreground="{DynamicResource TextMutedBrush}"/>
                    <TextBlock Text="{Binding LibraryDisplay}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                </StackPanel>

                <!-- Weight control -->
                <Grid Grid.Row="2" Margin="0,8,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="70"/>
                    </Grid.ColumnDefinitions>
                    <Slider Grid.Column="0" Minimum="0" Maximum="2" TickFrequency="0.05" IsSnapToTickEnabled="False"
                            Value="{Binding Weight}" IsEnabled="{Binding IsEnabled}"/>
                    <TextBox Grid.Column="1" Text="{Binding Weight, StringFormat={}{0:F2}}" Style="{DynamicResource DarkTextBoxStyle}" Padding="4"/>
                </Grid>

                <!-- File path (small) -->
                <TextBlock Grid.Row="3" Text="{Binding FileName}" Foreground="{DynamicResource TextMutedBrush}" FontSize="10" TextTrimming="CharacterEllipsis"/>

                <!-- Footer: Apply button right-aligned -->
                <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                    <Button Content="Apply" Style="{DynamicResource PrimaryButtonStyle}"
                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.ApplyLoRACommand}"
                            CommandParameter="{Binding}"/>
                </StackPanel>
                </Grid>
        </Border>
    </DataTemplate>

    <!-- ControlNet Card Template (scoped for Developer dictionary) -->
    <DataTemplate x:Key="ControlNetCardTemplate">
        <Border MinWidth="300" MaxWidth="360" Margin="0,0,12,12" Padding="16">
            <Border.Style>
                <Style TargetType="Border"
                       BasedOn="{StaticResource DarkCardStyle}">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsLoaded}"
                                     Value="True">
                            <Setter Property="BorderBrush"
                                    Value="{DynamicResource AccentRedBrush}"/>
                            <Setter Property="BorderThickness"
                                    Value="2"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Border.Style>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid Grid.Row="0" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="{Binding Name}" Style="{DynamicResource HeadingSmallStyle}"/>
                    <Border Grid.Column="1" Background="{DynamicResource AccentRedBrush}" CornerRadius="8" Padding="6,2" Margin="8,0,0,0">
                        <TextBlock Text="{Binding Type}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource ButtonTextBrush}"/>
                    </Border>
                    <TextBlock Grid.Column="2" Text="{Binding Version}" Style="{DynamicResource CaptionTextStyle}" Margin="8,0,0,0"/>
                </Grid>
                <Grid Grid.Row="1" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="Weight" Style="{DynamicResource CaptionTextStyle}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <Slider Grid.Column="1" Minimum="0" Maximum="2" Value="{Binding Weight}"/>
                    <TextBlock Grid.Column="2" Text="{Binding Weight, StringFormat=F2}" Style="{DynamicResource CaptionTextStyle}" Margin="8,0,0,0"/>
                    <TextBlock Grid.Column="3" Text="{Binding FileSize}" Style="{DynamicResource CaptionTextStyle}" Margin="8,0,0,0"/>
                </Grid>
                <Grid Grid.Row="2" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="Guidance Start" Style="{DynamicResource CaptionTextStyle}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <Slider Grid.Column="1" Minimum="0" Maximum="1" TickFrequency="0.01" Value="{Binding GuidanceStart}"/>
                    <TextBlock Grid.Column="2" Text="End" Style="{DynamicResource CaptionTextStyle}" VerticalAlignment="Center" Margin="12,0,8,0"/>
                    <Slider Grid.Column="3" Minimum="0" Maximum="1" TickFrequency="0.01" Value="{Binding GuidanceEnd}"/>
                </Grid>
                <Button Grid.Row="3" Content="Apply" Command="{Binding DataContext.ApplyControlNetCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" Style="{StaticResource PrimaryButtonStyle}"/>
            </Grid>
        </Border>
    </DataTemplate>

    <!-- DEVELOPER ControlNets ViewModel template -->
    <DataTemplate x:Key="DeveloperControlNetsViewModelTemplate">
        <Grid Background="{DynamicResource PrimaryDarkBrush}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" Style="{StaticResource DarkBorderStyle}" Margin="16,16,8,16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0" Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="ControlNets (Developer)" Style="{DynamicResource HeadingMediumStyle}"/>
                        <Button Grid.Column="1" Content="Refresh" Command="{Binding RefreshCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                    </Grid>

                    <Grid Grid.Row="1" Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <ComboBox Grid.Column="0" ItemsSource="{Binding PreprocessorTypes}" SelectedItem="{Binding PreprocessorType}" Style="{DynamicResource DarkComboBoxStyle}"/>
                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <TextBlock Text="Weight" Style="{DynamicResource CaptionTextStyle}" VerticalAlignment="Center"/>
                            <Slider Value="{Binding Weight}" Minimum="0" Maximum="2" Width="140" Margin="8,0,0,0"/>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Orientation="Horizontal">
                            <TextBox Text="{Binding InputImagePath}" Style="{DynamicResource DarkTextBoxStyle}" IsReadOnly="True" Width="220"/>
                            <Button Content="Browse" Command="{Binding SelectInputImageCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="8,0,0,0"/>
                        </StackPanel>
                    </Grid>

                    <ScrollViewer Grid.Row="2">
                        <ItemsControl ItemsSource="{Binding AvailableControlNets}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                        </ItemsControl>
                    </ScrollViewer>
            </Grid>
        </Border>

            <Border Grid.Column="1" Style="{StaticResource DarkBorderStyle}" Margin="8,16,16,16">
                <ScrollViewer>
                    <ItemsControl ItemsSource="{Binding AppliedControlNets}"/>
                </ScrollViewer>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- Float Parameter Template - With Slider -->
    <DataTemplate x:Key="FloatParameterTemplate">
        <Border Margin="2" Padding="4" 
                Background="{DynamicResource TertiaryDarkBrush}"
                CornerRadius="2">
            <StackPanel>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Grid.Column="0" 
                               Text="{Binding Name}" 
                               Foreground="{DynamicResource TextPrimaryBrush}"
                               FontSize="10"
                               VerticalAlignment="Center"/>
                    
                    <Slider Grid.Column="1" 
                            Margin="8,0"
                            Minimum="0" 
                            Maximum="1"
                            Value="{Binding Value}" 
                            VerticalAlignment="Center"/>
                    
                    <TextBlock Grid.Column="2" 
                               Text="{Binding Value, StringFormat=F2}" 
                               Foreground="{DynamicResource TextMutedBrush}"
                               FontSize="9"
                               MinWidth="40"
                               TextAlignment="Right"
                               VerticalAlignment="Center"/>
                </Grid>
            </StackPanel>
        </Border>
    </DataTemplate>
    
    <!-- Int Parameter Template - Simple -->
    <DataTemplate x:Key="IntParameterTemplate">
        <Border Margin="2" Padding="4" 
                Background="{DynamicResource TertiaryDarkBrush}"
                CornerRadius="2">
            <TextBlock Text="Developer Int Parameter" 
                       Foreground="{DynamicResource TextPrimaryBrush}"
                       FontSize="10"/>
        </Border>
    </DataTemplate>
    
    <!-- Bool Parameter Template - Simple -->
    <DataTemplate x:Key="BoolParameterTemplate">
        <Border Margin="2" Padding="4" 
                Background="{DynamicResource TertiaryDarkBrush}"
                CornerRadius="2">
            <TextBlock Text="Developer Bool Parameter" 
                       Foreground="{DynamicResource TextPrimaryBrush}"
                       FontSize="10"/>
        </Border>
    </DataTemplate>
<!-- Removed stray closing tag to maintain a single root ResourceDictionary -->
    <!-- Error Display Template - Simple -->
    <DataTemplate x:Key="ErrorDisplayTemplate">
        <Border Margin="2" Padding="4" 
                Background="{DynamicResource ErrorBrush}"
                CornerRadius="2">
            <TextBlock Text="Developer Error Display" 
                       Foreground="{DynamicResource TextPrimaryBrush}"
                       FontSize="10"/>
        </Border>
    </DataTemplate>
    <!-- VOICE SYNTHESIS SECTION TEMPLATES -->
    
    <!-- TTS Configuration Template - Developer Technical Mode -->
    <DataTemplate x:Key="TTSConfigurationTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="380"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="320"/>
            </Grid.ColumnDefinitions>
            
            <!-- Advanced Technical Controls -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                <StackPanel  Margin="8">
                    <!-- Engine Selection &amp; Config -->
                    <Expander Header="🔧 Engine Configuration" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="8" Margin="0,4,0,0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <TextBlock Grid.Row="0" Grid.ColumnSpan="2" Text="Engine: Piper TTS v1.2.0" 
                                           FontSize="10" FontWeight="SemiBold" Margin="0,0,0,6"/>
                                
                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Model Path:" FontSize="9" Margin="0,0,4,2"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="/models/en_US-lessac-high.onnx" 
                                           FontSize="9" Foreground="{DynamicResource TextMutedBrush}" 
                                           TextTrimming="CharacterEllipsis"/>
                                
                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Sample Rate:" FontSize="9" Margin="0,0,4,2"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" Text="22050 Hz" 
                                           FontSize="9" Foreground="{DynamicResource AccentRedBrush}"/>
                                
                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Buffer Size:" FontSize="9" Margin="0,0,4,2"/>
                                <TextBlock Grid.Row="3" Grid.Column="1" Text="512 samples" 
                                           FontSize="9" Foreground="{DynamicResource AccentRedBrush}"/>
                            </Grid>
                        </Border>
                    </Expander>
                    
                    <!-- Voice Model Parameters -->
                    <Expander Header="🎛️ Voice Model Parameters" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="8" Margin="0,4,0,0">
                            <StackPanel >
                                <!-- Voice Selection -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Voice Model:" FontSize="9" 
                                               VerticalAlignment="Center" Margin="0,0,6,0"/>
                                    <ComboBox Grid.Column="1" FontSize="9" 
                                              SelectedItem="{Binding SelectedVoice}" 
                                              ItemsSource="{Binding AvailableVoices}">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal" >
                                                    <TextBlock Text="{Binding ModelId}" FontSize="8" FontFamily="Consolas"/>
                                                    <TextBlock Text="{Binding QualityLevel}" FontSize="8" 
                                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                    <Button Grid.Column="2" Content="⚙" Width="20" Height="20" 
                                            FontSize="8" Margin="4,0,0,0" 
                                            Command="{Binding ConfigureVoiceCommand}"/>
                                </Grid>
                                
                                <!-- Technical Parameters -->
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Speech Rate (samples/sec)" FontSize="9"/>
                                        <TextBlock Text="{Binding SpeechRate, StringFormat={}{0:F3}}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding SpeechRate}" 
                                            Minimum="0.1" Maximum="4.0" 
                                            TickFrequency="0.1" Height="16"/>
                                </StackPanel>
                                
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="F0 Scaling Factor" FontSize="9"/>
                                        <TextBlock Text="{Binding F0Scale, StringFormat={}{0:F2}}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding F0Scale}" 
                                            Minimum="0.1" Maximum="3.0" 
                                            TickFrequency="0.05" Height="16"/>
                                </StackPanel>
                                
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Energy Scale" FontSize="9"/>
                                        <TextBlock Text="{Binding EnergyScale, StringFormat={}{0:F2}}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding EnergyScale}" 
                                            Minimum="0.1" Maximum="2.0" 
                                            TickFrequency="0.05" Height="16"/>
                                </StackPanel>
                                
                                <CheckBox Content="Enable noise scale" FontSize="9" 
                                          IsChecked="{Binding EnableNoiseScale}"/>
                                <CheckBox Content="Apply length regulation" FontSize="9" 
                                          IsChecked="{Binding ApplyLengthRegulation}"/>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Audio Processing Pipeline -->
                    <Expander Header="🔊 Audio Processing Pipeline" IsExpanded="False" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="8" Margin="0,4,0,0">
                            <StackPanel >
                                <CheckBox Content="Pre-emphasis filter (α = 0.97)" FontSize="9" 
                                          IsChecked="{Binding EnablePreEmphasis}"/>
                                <CheckBox Content="Spectral normalization" FontSize="9" 
                                          IsChecked="{Binding EnableSpectralNorm}"/>
                                <CheckBox Content="Post-processing vocoder" FontSize="9" 
                                          IsChecked="{Binding EnableVocoder}"/>
                                
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Window Size (FFT)" FontSize="9"/>
                                        <TextBlock Text="{Binding WindowSize}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <ComboBox SelectedItem="{Binding WindowSize}" FontSize="9">
                                        <ComboBoxItem Content="512"/>
                                        <ComboBoxItem Content="1024"/>
                                        <ComboBoxItem Content="2048"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Hop Length" FontSize="9"/>
                                        <TextBlock Text="{Binding HopLength}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <ComboBox SelectedItem="{Binding HopLength}" FontSize="9">
                                        <ComboBoxItem Content="128"/>
                                        <ComboBoxItem Content="256"/>
                                        <ComboBoxItem Content="512"/>
                                    </ComboBox>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- System Resource Monitor -->
                    <Expander Header="💻 System Monitor" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="8" Margin="0,4,0,0">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,4">
                                    <TextBlock Text="CPU Usage:" FontSize="9" Margin="0,0,6,0"/>
                                    <TextBlock Text="{Binding CpuUsage, StringFormat={}{0:F1}%}" 
                                               FontSize="9" Foreground="{DynamicResource AccentRedBrush}"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,4">
                                    <TextBlock Text="Memory:" FontSize="9" Margin="0,0,6,0"/>
                                    <TextBlock Text="{Binding MemoryUsage, StringFormat={}{0:F0} MB}" 
                                               FontSize="9" Foreground="{DynamicResource AccentRedBrush}"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,4">
                                    <TextBlock Text="Processing Latency:" FontSize="9" Margin="0,0,6,0"/>
                                    <TextBlock Text="{Binding ProcessingLatency, StringFormat={}{0:F1}ms}" 
                                               FontSize="9" Foreground="{DynamicResource AccentRedBrush}"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="3" Orientation="Horizontal">
                                    <TextBlock Text="Queue Depth:" FontSize="9" Margin="0,0,6,0"/>
                                    <TextBlock Text="{Binding QueueDepth}" 
                                               FontSize="9" Foreground="{DynamicResource AccentRedBrush}"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
            
            <!-- Text Input &amp; Waveform Analysis -->
            <Grid Grid.Column="1" Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="140"/>
                    <RowDefinition Height="80"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Text Input with Phonetic Analysis -->
                <Border Grid.Row="0" Background="{DynamicResource SecondaryDarkBrush}" 
                        CornerRadius="4" Padding="12">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" 
                                    Margin="0,0,0,8">
                            <TextBlock Text="📝 Text Input &amp; Analysis" 
                                       FontSize="12" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding TextStats, StringFormat={}Stats: {0}}" 
                                       FontSize="9" Foreground="{DynamicResource TextSecondaryBrush}"/>
                        </StackPanel>
                        
                        <TextBox Grid.Row="1" 
                                 Text="{Binding TextToSpeak, UpdateSourceTrigger=PropertyChanged}" 
                                 TextWrapping="Wrap" AcceptsReturn="True" 
                                 VerticalScrollBarVisibility="Auto" 
                                 Background="Transparent" BorderThickness="0" 
                                 FontSize="11" FontFamily="Consolas" Padding="4"/>
                        
                        <!-- Phonetic Preview -->
                        <Border Grid.Row="2" Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="6" Margin="0,8,0,0">
                            <StackPanel >
                                <TextBlock Text="🔤 Phonetic Representation (IPA):" 
                                           FontSize="9" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding PhoneticText}" 
                                           FontSize="10" FontFamily="Consolas" 
                                           Foreground="{DynamicResource AccentRedBrush}" 
                                           TextWrapping="Wrap" MaxHeight="40"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>
                
                <!-- Technical Waveform Analysis -->
                <Border Grid.Row="1" Background="{DynamicResource TertiaryDarkBrush}" 
                        CornerRadius="4" Margin="0,8,0,0" Padding="8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" 
                                    Margin="0,0,0,6">
                            <TextBlock Text="📊 Spectral Analysis" FontSize="10" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding SpectralPeaks, StringFormat={}Peaks: {0}}" 
                                       FontSize="8" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <TextBlock Text="{Binding FundamentalFreq, StringFormat={}F0: {0:F1}Hz}" 
                                       FontSize="8" Foreground="{DynamicResource AccentRedBrush}"/>
                        </StackPanel>
                        
                        <!-- Waveform &amp; Spectrogram placeholder -->
                        <Border Grid.Row="1" Background="{DynamicResource PrimaryDarkBrush}" 
                                CornerRadius="2">
                            <TextBlock Text="🌊 Real-time waveform + spectrogram visualization" 
                                       HorizontalAlignment="Center" VerticalAlignment="Center" 
                                       FontSize="10" Foreground="{DynamicResource TextMutedBrush}"/>
                        </Border>
                    </Grid>
                </Border>
                
                <!-- Processing Console -->
                <Border Grid.Row="2" Background="{DynamicResource PrimaryDarkBrush}" 
                        CornerRadius="4" Margin="0,8,0,0">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="6">
                        <TextBlock Text="{Binding ProcessingLog}" 
                                   FontFamily="Consolas" FontSize="8" 
                                   Foreground="{DynamicResource TextMutedBrush}"/>
                    </ScrollViewer>
                </Border>
                
                <!-- Technical Controls -->
                <StackPanel Grid.Row="3" Orientation="Horizontal" 
                           HorizontalAlignment="Center"  Margin="0,8,0,0">
                    <Button Content="🎵 Synthesize" 
                            Command="{Binding GenerateSpeechCommand}" 
                            Background="{DynamicResource AccentRedBrush}" 
                            Padding="12,4" FontSize="10" FontWeight="SemiBold"/>
                    <Button Content="⏹️ Stop" 
                            Command="{Binding StopSpeechCommand}" 
                            Background="{DynamicResource ErrorBrush}" 
                            Padding="10,4" FontSize="10"/>
                    <Button Content="💾 Export WAV" 
                            Command="{Binding ExportWavCommand}" 
                            Background="{DynamicResource SuccessBrush}" 
                            Padding="10,4" FontSize="10"/>
                    <Button Content="📊 Analyze" 
                            Command="{Binding AnalyzeCommand}" 
                            Padding="10,4" FontSize="10"/>
                </StackPanel>
            </Grid>
            
            <!-- Debug &amp; Performance Metrics -->
            <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
                <StackPanel  Margin="8">
                    <!-- Performance Metrics -->
                    <Expander Header="⚡ Performance Metrics" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="6" Margin="0,4,0,0">
                            <StackPanel >
                                <Grid>
                                    <TextBlock Text="Generation Time:" FontSize="9"/>
                                    <TextBlock Text="{Binding GenerationTime, StringFormat={}{0:F0}ms}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="RTF (Real-Time Factor):" FontSize="9"/>
                                    <TextBlock Text="{Binding RealTimeFactor, StringFormat={}{0:F2}x}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Audio Quality Score:" FontSize="9"/>
                                    <TextBlock Text="{Binding QualityScore, StringFormat={}{0:F1}/10}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Model Load Time:" FontSize="9"/>
                                    <TextBlock Text="{Binding ModelLoadTime, StringFormat={}{0:F0}ms}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Technical Logs -->
                    <Expander Header="🐛 Debug Console" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource PrimaryDarkBrush}" 
                                CornerRadius="2" Height="120" Margin="0,4,0,0">
                            <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="4">
                                <TextBlock Text="{Binding DebugLog}" 
                                           FontFamily="Consolas" FontSize="8" 
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                            </ScrollViewer>
                        </Border>
                    </Expander>
                    
                    <!-- Model Information -->
                    <Expander Header="🏷️ Model Info" IsExpanded="False" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="6" Margin="0,4,0,0">
                            <StackPanel >
                                <Grid>
                                    <TextBlock Text="Model Size:" FontSize="9"/>
                                    <TextBlock Text="{Binding ModelSize, StringFormat={}{0:F1} MB}" 
                                               HorizontalAlignment="Right" FontSize="9"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Parameters:" FontSize="9"/>
                                    <TextBlock Text="{Binding ModelParameters, StringFormat={}{0:N0}}" 
                                               HorizontalAlignment="Right" FontSize="9"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Language Support:" FontSize="9"/>
                                    <TextBlock Text="{Binding SupportedLanguages}" 
                                               HorizontalAlignment="Right" FontSize="9"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Training Data:" FontSize="9"/>
                                    <TextBlock Text="{Binding TrainingDataset}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               TextTrimming="CharacterEllipsis"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Recent Generations -->
                    <Expander Header="📚 Generation History" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="4" Margin="0,4,0,0">
                            <ItemsControl ItemsSource="{Binding RecentGenerations}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                                CornerRadius="2" Padding="4" Margin="0,1">
                                            <StackPanel >
                                                <TextBlock Text="{Binding TextPreview}" 
                                                           FontSize="8" FontFamily="Consolas" 
                                                           TextTrimming="CharacterEllipsis" 
                                                           MaxHeight="12"/>
                                                <Grid>
                                                    <TextBlock Text="{Binding Duration, StringFormat={}{0:F1}s}" 
                                                               FontSize="7" 
                                                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                    <StackPanel Orientation="Horizontal" 
                                                               HorizontalAlignment="Right" >
                                                        <Button Content="▶" Width="16" Height="14" 
                                                                FontSize="7" 
                                                                Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.PlayHistoryCommand}" 
                                                                CommandParameter="{Binding}"/>
                                                        <Button Content="📊" Width="16" Height="14" 
                                                                FontSize="7" 
                                                                Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.AnalyzeHistoryCommand}" 
                                                                CommandParameter="{Binding}"/>
                                                    </StackPanel>
                                                </Grid>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </DataTemplate>
<!-- Removed stray closing tag to maintain a single root ResourceDictionary -->
    <DataTemplate x:Key="VoiceCloningTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="360"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>
            
            <!-- Technical Clone Configuration -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                <StackPanel  Margin="8">
                    <!-- Training Configuration -->
                    <Expander Header="🧪 Training Configuration" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="8" Margin="0,4,0,0">
                            <StackPanel >
                                <!-- Model Architecture -->
                                <StackPanel>
                                    <TextBlock Text="Training Architecture:" FontSize="9" FontWeight="SemiBold" Margin="0,0,0,2"/>
                                    <ComboBox SelectedItem="{Binding TrainingArchitecture}" FontSize="9">
                                        <ComboBoxItem Content="Tacotron2 + HiFiGAN"/>
                                        <ComboBoxItem Content="FastSpeech2 + MB-MelGAN"/>
                                        <ComboBoxItem Content="VITS (End-to-End)"/>
                                        <ComboBoxItem Content="YourTTS (Multi-Speaker)"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <!-- Training Hyperparameters -->
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Learning Rate" FontSize="9"/>
                                        <TextBlock Text="{Binding LearningRate, StringFormat={}{0:E2}}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding LearningRate}" 
                                            Minimum="0.0001" Maximum="0.01" 
                                            TickFrequency="0.0001" Height="16"/>
                                </StackPanel>
                                
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Batch Size" FontSize="9"/>
                                        <TextBlock Text="{Binding BatchSize}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <ComboBox SelectedItem="{Binding BatchSize}" FontSize="9">
                                        <ComboBoxItem Content="8"/>
                                        <ComboBoxItem Content="16"/>
                                        <ComboBoxItem Content="32"/>
                                        <ComboBoxItem Content="64"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Max Epochs" FontSize="9"/>
                                        <TextBlock Text="{Binding MaxEpochs}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding MaxEpochs}" 
                                            Minimum="100" Maximum="2000" 
                                            TickFrequency="100" Height="16"/>
                                </StackPanel>
                                
                                <CheckBox Content="Enable mixed precision training" FontSize="9" 
                                          IsChecked="{Binding EnableMixedPrecision}"/>
                                <CheckBox Content="Use gradient clipping (norm=1.0)" FontSize="9" 
                                          IsChecked="{Binding UseGradientClipping}"/>
                                <CheckBox Content="Apply data augmentation" FontSize="9" 
                                          IsChecked="{Binding ApplyDataAugmentation}"/>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Audio Preprocessing -->
                    <Expander Header="🎛️ Audio Preprocessing" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="8" Margin="0,4,0,0">
                            <StackPanel >
                                <CheckBox Content="Apply normalization (-1.0 to 1.0)" FontSize="9" 
                                          IsChecked="{Binding NormalizeAudio}"/>
                                <CheckBox Content="Remove silence (threshold: -40dB)" FontSize="9" 
                                          IsChecked="{Binding RemoveSilence}"/>
                                <CheckBox Content="Apply noise reduction filter" FontSize="9" 
                                          IsChecked="{Binding ApplyNoiseReduction}"/>
                                
                                <StackPanel>
                                    <TextBlock Text="Target Sample Rate:" FontSize="9" Margin="0,0,0,2"/>
                                    <ComboBox SelectedItem="{Binding TargetSampleRate}" FontSize="9">
                                        <ComboBoxItem Content="16000 Hz"/>
                                        <ComboBoxItem Content="22050 Hz"/>
                                        <ComboBoxItem Content="44100 Hz"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Segment Length (seconds)" FontSize="9"/>
                                        <TextBlock Text="{Binding SegmentLength, StringFormat={}{0:F1}s}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding SegmentLength}" 
                                            Minimum="1.0" Maximum="10.0" 
                                            TickFrequency="0.5" Height="16"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Hardware Configuration -->
                    <Expander Header="💻 Hardware Config" IsExpanded="False" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="8" Margin="0,4,0,0">
                            <StackPanel >
                                <Grid>
                                    <TextBlock Text="Training Device:" FontSize="9"/>
                                    <TextBlock Text="{Binding TrainingDevice}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Memory Allocation:" FontSize="9"/>
                                    <TextBlock Text="{Binding MemoryAllocation, StringFormat={}{0} GB}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="CPU Threads:" FontSize="9"/>
                                    <TextBlock Text="{Binding CpuThreads}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
            
            <!-- Training Progress &amp; Analysis -->
            <Grid Grid.Column="1" Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="100"/>
                    <RowDefinition Height="120"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Sample Analysis &amp; Validation -->
                <Border Grid.Row="0" Background="{DynamicResource SecondaryDarkBrush}" 
                        CornerRadius="4" Padding="12">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" 
                                    Margin="0,0,0,8">
                            <TextBlock Text="🧬 Sample Analysis &amp; Validation" 
                                       FontSize="12" FontWeight="SemiBold"/>
                            <Border Background="{Binding ValidationStatus, Converter={StaticResource StatusToBrush}}" 
                                    Padding="4,1" CornerRadius="8">
                                <TextBlock Text="{Binding ValidationStatus}" 
                                           FontSize="9" Foreground="White"/>
                            </Border>
                        </StackPanel>
                        
                        <!-- Technical Audio Analysis -->
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0" >
                                <TextBlock Text="Audio Characteristics:" FontSize="10" FontWeight="SemiBold"/>
                                <Grid>
                                    <TextBlock Text="Sample Rate:" FontSize="9"/>
                                    <TextBlock Text="{Binding AudioSampleRate, StringFormat={}{0} Hz}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Bit Depth:" FontSize="9"/>
                                    <TextBlock Text="{Binding AudioBitDepth, StringFormat={}{0} bit}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Duration:" FontSize="9"/>
                                    <TextBlock Text="{Binding AudioDuration, StringFormat={}{0:F1}s}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="SNR:" FontSize="9"/>
                                    <TextBlock Text="{Binding SignalToNoiseRatio, StringFormat={}{0:F1} dB}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" >
                                <TextBlock Text="Voice Analysis:" FontSize="10" FontWeight="SemiBold"/>
                                <Grid>
                                    <TextBlock Text="F0 Range:" FontSize="9"/>
                                    <TextBlock Text="{Binding F0Range, StringFormat={}{0:F0}-{1:F0} Hz}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Formant Analysis:" FontSize="9"/>
                                    <TextBlock Text="{Binding FormantAnalysis}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Voice Quality:" FontSize="9"/>
                                    <TextBlock Text="{Binding VoiceQualityScore, StringFormat={}{0:F1}/10}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Emotional Tone:" FontSize="9"/>
                                    <TextBlock Text="{Binding DetectedEmotion}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                            </StackPanel>
                        </Grid>
                        
                        <!-- Quick Actions -->
                        <StackPanel Grid.Row="2" Orientation="Horizontal" 
                                   HorizontalAlignment="Center"  Margin="0,8,0,0">
                            <Button Content="▶ Play Sample" 
                                    Command="{Binding PlaySampleCommand}" 
                                    Background="{DynamicResource AccentRedBrush}" 
                                    Padding="8,4" FontSize="9"/>
                            <Button Content="📊 Analyze Spectral" 
                                    Command="{Binding AnalyzeSpectralCommand}" 
                                    Padding="8,4" FontSize="9"/>
                            <Button Content="🎯 Start Training" 
                                    Command="{Binding StartTrainingCommand}" 
                                    Background="{DynamicResource SuccessBrush}" 
                                    Padding="8,4" FontSize="9" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <!-- Real-time Training Metrics -->
                <Border Grid.Row="1" Background="{DynamicResource TertiaryDarkBrush}" 
                        CornerRadius="4" Padding="8" Margin="0,8,0,0"
                        Visibility="{Binding IsTraining, Converter={StaticResource BoolToVisibility}}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0" >
                            <TextBlock Text="📈 Loss Metrics" FontSize="10" FontWeight="SemiBold"/>
                            <Grid>
                                <TextBlock Text="Generator Loss:" FontSize="8"/>
                                <TextBlock Text="{Binding GeneratorLoss, StringFormat={}{0:F4}}" 
                                           HorizontalAlignment="Right" FontSize="8" 
                                           Foreground="{DynamicResource AccentRedBrush}"/>
                            </Grid>
                            <Grid>
                                <TextBlock Text="Discriminator Loss:" FontSize="8"/>
                                <TextBlock Text="{Binding DiscriminatorLoss, StringFormat={}{0:F4}}" 
                                           HorizontalAlignment="Right" FontSize="8" 
                                           Foreground="{DynamicResource AccentRedBrush}"/>
                            </Grid>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="1" >
                            <TextBlock Text="⏱️ Progress" FontSize="10" FontWeight="SemiBold"/>
                            <Grid>
                                <TextBlock Text="Epoch:" FontSize="8"/>
                                <TextBlock Text="{Binding CurrentEpoch, StringFormat={}{0}/{1}}" 
                                           HorizontalAlignment="Right" FontSize="8" 
                                           Foreground="{DynamicResource AccentRedBrush}"/>
                            </Grid>
                            <Grid>
                                <TextBlock Text="ETA:" FontSize="8"/>
                                <TextBlock Text="{Binding EstimatedTimeRemaining, StringFormat={}{0:hh\\:mm\\:ss}}" 
                                           HorizontalAlignment="Right" FontSize="8" 
                                           Foreground="{DynamicResource AccentRedBrush}"/>
                            </Grid>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="2" >
                            <TextBlock Text="💻 Performance" FontSize="10" FontWeight="SemiBold"/>
                            <Grid>
                                <TextBlock Text="GPU Usage:" FontSize="8"/>
                                <TextBlock Text="{Binding GpuUsage, StringFormat={}{0:F0}%}" 
                                           HorizontalAlignment="Right" FontSize="8" 
                                           Foreground="{DynamicResource AccentRedBrush}"/>
                            </Grid>
                            <Grid>
                                <TextBlock Text="Memory:" FontSize="8"/>
                                <TextBlock Text="{Binding GpuMemory, StringFormat={}{0:F1}GB}" 
                                           HorizontalAlignment="Right" FontSize="8" 
                                           Foreground="{DynamicResource AccentRedBrush}"/>
                            </Grid>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <!-- Training Console -->
                <Border Grid.Row="2" Background="{DynamicResource PrimaryDarkBrush}" 
                        CornerRadius="4" Margin="0,8,0,0">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="6">
                        <TextBlock Text="{Binding TrainingLog}" 
                                   FontFamily="Consolas" FontSize="8" 
                                   Foreground="{DynamicResource TextMutedBrush}"/>
                    </ScrollViewer>
                </Border>
                
                <!-- Training Controls -->
                <StackPanel Grid.Row="3" Orientation="Horizontal" 
                           HorizontalAlignment="Center"  Margin="0,8,0,0">
                    <Button Content="🚀 Start Training" 
                            Command="{Binding StartTrainingCommand}" 
                            Background="{DynamicResource AccentRedBrush}" 
                            Padding="12,4" FontSize="10" FontWeight="SemiBold"/>
                    <Button Content="⏸️ Pause" 
                            Command="{Binding PauseTrainingCommand}" 
                            Padding="10,4" FontSize="10"/>
                    <Button Content="⏹️ Stop" 
                            Command="{Binding StopTrainingCommand}" 
                            Background="{DynamicResource ErrorBrush}" 
                            Padding="10,4" FontSize="10"/>
                    <Button Content="💾 Checkpoint" 
                            Command="{Binding SaveCheckpointCommand}" 
                            Background="{DynamicResource SuccessBrush}" 
                            Padding="10,4" FontSize="10"/>
                </StackPanel>
            </Grid>
            
            <!-- Model Repository &amp; Management -->
            <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
                <StackPanel  Margin="8">
                    <!-- Clone Library -->
                    <Expander Header="🎭 Voice Clone Library" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="4" Margin="0,4,0,0">
                            <ItemsControl ItemsSource="{Binding VoiceClones}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                                CornerRadius="2" Padding="6" Margin="0,1">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                
                                                <StackPanel Grid.Row="0" Orientation="Horizontal" >
                                                    <TextBlock Text="{Binding Name}" FontSize="10" FontWeight="SemiBold"/>
                                                    <Border Background="{Binding StatusColor}" 
                                                            Padding="2,0" CornerRadius="6">
                                                        <TextBlock Text="{Binding Status}" FontSize="7" Foreground="White"/>
                                                    </Border>
                                                </StackPanel>
                                                
                                                <Grid Grid.Row="1" Margin="0,2,0,0">
                                                    <TextBlock Text="Quality Score:" FontSize="8"/>
                                                    <TextBlock Text="{Binding QualityScore, StringFormat={}{0:F1}}" 
                                                               HorizontalAlignment="Right" FontSize="8" 
                                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                                </Grid>
                                                
                                                <Grid Grid.Row="2">
                                                    <TextBlock Text="Training Time:" FontSize="8"/>
                                                    <TextBlock Text="{Binding TrainingDuration, StringFormat={}{0:hh\\:mm}}" 
                                                               HorizontalAlignment="Right" FontSize="8" 
                                                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                </Grid>
                                                
                                                <StackPanel Grid.Row="3" Orientation="Horizontal" 
                                                            Margin="0,4,0,0">
                                                    <Button Content="▶" Width="18" Height="16" FontSize="8" 
                                                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.TestCloneCommand}" 
                                                            CommandParameter="{Binding}"/>
                                                    <Button Content="📊" Width="18" Height="16" FontSize="8" 
                                                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.AnalyzeCloneCommand}" 
                                                            CommandParameter="{Binding}"/>
                                                    <Button Content="💾" Width="18" Height="16" FontSize="8" 
                                                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.ExportCloneCommand}" 
                                                            CommandParameter="{Binding}"/>
                                                    <Button Content="🗑" Width="18" Height="16" FontSize="8" 
                                                            Background="{DynamicResource ErrorBrush}" 
                                                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.DeleteCloneCommand}" 
                                                            CommandParameter="{Binding}"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Border>
                    </Expander>
                    
                    <!-- Training History -->
                    <Expander Header="📈 Training Sessions" IsExpanded="False" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="4" Margin="0,4,0,0">
                            <ItemsControl ItemsSource="{Binding TrainingHistory}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                                CornerRadius="2" Padding="4" Margin="0,1">
                                            <StackPanel >
                                                <Grid>
                                                    <TextBlock Text="{Binding SessionName}" FontSize="9" FontWeight="SemiBold"/>
                                                    <TextBlock Text="{Binding Date, StringFormat={}{0:MM/dd HH:mm}}" 
                                                               HorizontalAlignment="Right" FontSize="8" 
                                                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                </Grid>
                                                <Grid>
                                                    <TextBlock Text="Final Loss:" FontSize="8"/>
                                                    <TextBlock Text="{Binding FinalLoss, StringFormat={}{0:F4}}" 
                                                               HorizontalAlignment="Right" FontSize="8" 
                                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                                </Grid>
                                                <StackPanel Orientation="Horizontal"  Margin="0,2,0,0">
                                                    <Button Content="📊" Width="16" Height="14" FontSize="7" 
                                                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.ViewTrainingStatsCommand}" 
                                                            CommandParameter="{Binding}"/>
                                                    <Button Content="💾" Width="16" Height="14" FontSize="7" 
                                                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.ExportTrainingDataCommand}" 
                                                            CommandParameter="{Binding}"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </DataTemplate>
<!-- removed stray closing ResourceDictionary to keep a single root -->
    <DataTemplate x:Key="RealTimeSynthesisTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="320"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>
            
            <!-- Real-time Engine Controls -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                <StackPanel  Margin="8">
                    <!-- Engine Status -->
                    <Expander Header="⚡ Engine Status" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="8" Margin="0,4,0,0">
                            <StackPanel >
                                <Grid>
                                    <TextBlock Text="Engine State:" FontSize="9"/>
                                    <TextBlock Text="{Binding EngineState}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Audio Latency:" FontSize="9"/>
                                    <TextBlock Text="{Binding AudioLatency, StringFormat={}{0:F1}ms}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Buffer Underruns:" FontSize="9"/>
                                    <TextBlock Text="{Binding BufferUnderruns}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource ErrorBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Sample Rate:" FontSize="9"/>
                                    <TextBlock Text="{Binding CurrentSampleRate, StringFormat={}{0} Hz}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Real-time Parameters -->
                    <Expander Header="🎛️ Live Parameters" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="8" Margin="0,4,0,0">
                            <StackPanel >
                                <!-- Voice Model -->
                                <StackPanel>
                                    <TextBlock Text="Active Voice Model:" FontSize="9" FontWeight="SemiBold" Margin="0,0,0,2"/>
                                    <ComboBox SelectedItem="{Binding ActiveVoiceModel}" FontSize="9" 
                                              ItemsSource="{Binding LoadedVoiceModels}">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal" >
                                                    <TextBlock Text="{Binding Name}" FontSize="9"/>
                                                    <TextBlock Text="{Binding LoadTime, StringFormat={}({0:F0}ms)}" 
                                                               FontSize="8" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                </StackPanel>
                                
                                <!-- Real-time Sliders -->
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Speech Rate (RT)" FontSize="9"/>
                                        <TextBlock Text="{Binding LiveSpeechRate, StringFormat={}x{0:F2}}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding LiveSpeechRate}" 
                                            Minimum="0.25" Maximum="3.0" 
                                            TickFrequency="0.05" Height="16"/>
                                </StackPanel>
                                
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Pitch Shift (RT)" FontSize="9"/>
                                        <TextBlock Text="{Binding LivePitchShift, StringFormat={}{0:+0.0;-0.0;0.0} st}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding LivePitchShift}" 
                                            Minimum="-12.0" Maximum="12.0" 
                                            TickFrequency="0.5" Height="16"/>
                                </StackPanel>
                                
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Volume Gain (RT)" FontSize="9"/>
                                        <TextBlock Text="{Binding LiveVolumeGain, StringFormat={}{0:+0.0;-0.0;0.0} dB}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding LiveVolumeGain}" 
                                            Minimum="-20.0" Maximum="20.0" 
                                            TickFrequency="1.0" Height="16"/>
                                </StackPanel>
                                
                                <CheckBox Content="Enable low-latency mode" FontSize="9" 
                                          IsChecked="{Binding EnableLowLatency}"/>
                                <CheckBox Content="Apply real-time effects" FontSize="9" 
                                          IsChecked="{Binding EnableRealtimeEffects}"/>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Audio I/O Configuration -->
                    <Expander Header="🔌 Audio I/O Config" IsExpanded="False" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="8" Margin="0,4,0,0">
                            <StackPanel >
                                <StackPanel>
                                    <TextBlock Text="Output Device:" FontSize="9" Margin="0,0,0,2"/>
                                    <ComboBox SelectedItem="{Binding OutputDevice}" FontSize="9" 
                                              ItemsSource="{Binding AvailableOutputDevices}"/>
                                </StackPanel>
                                
                                <StackPanel>
                                    <TextBlock Text="Buffer Size:" FontSize="9" Margin="0,0,0,2"/>
                                    <ComboBox SelectedItem="{Binding BufferSize}" FontSize="9">
                                        <ComboBoxItem Content="64 samples"/>
                                        <ComboBoxItem Content="128 samples"/>
                                        <ComboBoxItem Content="256 samples"/>
                                        <ComboBoxItem Content="512 samples"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <CheckBox Content="Enable ASIO driver" FontSize="9" 
                                          IsChecked="{Binding UseAsioDriver}"/>
                                <CheckBox Content="Exclusive mode access" FontSize="9" 
                                          IsChecked="{Binding UseExclusiveMode}"/>
                            </StackPanel>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
            
            <!-- Live Text Processing &amp; Visualization -->
            <Grid Grid.Column="1" Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="100"/>
                    <RowDefinition Height="80"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Live Text Input with Processing Info -->
                <Border Grid.Row="0" Background="{DynamicResource SecondaryDarkBrush}" 
                        CornerRadius="4" Padding="12">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" 
                                    Margin="0,0,0,8">
                            <TextBlock Text="💬 Live Text Processing" 
                                       FontSize="12" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding ProcessingQueue, StringFormat={}Queue: {0} items}" 
                                       FontSize="9" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <TextBlock Text="{Binding CharacterCount, StringFormat={}Chars: {0}}" 
                                       FontSize="9" Foreground="{DynamicResource AccentRedBrush}"/>
                        </StackPanel>
                        
                        <TextBox Grid.Row="1" 
                                 Text="{Binding LiveText, UpdateSourceTrigger=PropertyChanged}" 
                                 TextWrapping="Wrap" AcceptsReturn="True" 
                                 VerticalScrollBarVisibility="Auto" 
                                 Background="Transparent" BorderThickness="0" 
                                 FontSize="11" FontFamily="Segoe UI" Padding="4"/>
                        
                        <!-- Processing Queue Status -->
                        <Border Grid.Row="2" Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="6" Margin="0,8,0,0">
                            <StackPanel >
                                <StackPanel Orientation="Horizontal" >
                                    <TextBlock Text="Processing Status:" FontSize="9" FontWeight="SemiBold"/>
                                    <TextBlock Text="{Binding ProcessingStatus}" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" >
                                    <TextBlock Text="{Binding TokensPerSecond, StringFormat={}Rate: {0:F1} tok/s}" 
                                               FontSize="8" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <TextBlock Text="{Binding AverageLatency, StringFormat={}Avg Latency: {0:F1}ms}" 
                                               FontSize="8" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>
                
                <!-- Real-time Audio Visualization -->
                <Border Grid.Row="1" Background="{DynamicResource TertiaryDarkBrush}" 
                        CornerRadius="4" Margin="0,8,0,0" Padding="8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" 
                                    Margin="0,0,0,6">
                            <TextBlock Text="📊 Live Audio Analysis" FontSize="10" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding CurrentF0, StringFormat={}F0: {0:F0}Hz}" 
                                       FontSize="8" Foreground="{DynamicResource AccentRedBrush}"/>
                            <TextBlock Text="{Binding PeakAmplitude, StringFormat={}Peak: {0:F1}dB}" 
                                       FontSize="8" Foreground="{DynamicResource AccentRedBrush}"/>
                        </StackPanel>
                        
                        <!-- Real-time waveform and spectrum analyzer placeholder -->
                        <Border Grid.Row="1" Background="{DynamicResource PrimaryDarkBrush}" 
                                CornerRadius="2">
                            <TextBlock Text="🌊 Live waveform + spectrum analyzer" 
                                       HorizontalAlignment="Center" VerticalAlignment="Center" 
                                       FontSize="10" Foreground="{DynamicResource TextMutedBrush}"/>
                        </Border>
                    </Grid>
                </Border>
                
                <!-- System Performance Monitor -->
                <Border Grid.Row="2" Background="{DynamicResource PrimaryDarkBrush}" 
                        CornerRadius="4" Margin="0,8,0,0" Padding="6">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0" >
                            <TextBlock Text="⚡ Performance" FontSize="9" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding CpuUsage, StringFormat={}CPU: {0:F0}%}" 
                                       FontSize="8" Foreground="{DynamicResource AccentRedBrush}"/>
                            <TextBlock Text="{Binding MemoryUsage, StringFormat={}RAM: {0:F0}MB}" 
                                       FontSize="8" Foreground="{DynamicResource AccentRedBrush}"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="1" >
                            <TextBlock Text="🔊 Audio" FontSize="9" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding OutputLatency, StringFormat={}Out Latency: {0:F1}ms}" 
                                       FontSize="8" Foreground="{DynamicResource AccentRedBrush}"/>
                            <TextBlock Text="{Binding DropoutCount, StringFormat={}Dropouts: {0}}" 
                                       FontSize="8" Foreground="{DynamicResource ErrorBrush}"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="2" >
                            <TextBlock Text="🎯 Quality" FontSize="9" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding QualityMetric, StringFormat={}Quality: {0:F1}}" 
                                       FontSize="8" Foreground="{DynamicResource AccentRedBrush}"/>
                            <TextBlock Text="{Binding ActiveConnections, StringFormat={}Connections: {0}}" 
                                       FontSize="8" Foreground="{DynamicResource AccentRedBrush}"/>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <!-- Real-time Controls -->
                <StackPanel Grid.Row="3" Orientation="Horizontal" 
                           HorizontalAlignment="Center"  Margin="0,8,0,0">
                    <Button Content="🎤 Start Stream" 
                            Command="{Binding StartStreamCommand}" 
                            Background="{DynamicResource AccentRedBrush}" 
                            Padding="12,4" FontSize="10" FontWeight="SemiBold"/>
                    <Button Content="⏸️ Pause" 
                            Command="{Binding PauseStreamCommand}" 
                            Padding="10,4" FontSize="10"/>
                    <Button Content="⏹️ Stop" 
                            Command="{Binding StopStreamCommand}" 
                            Background="{DynamicResource ErrorBrush}" 
                            Padding="10,4" FontSize="10"/>
                    <Button Content="🔄 Flush Queue" 
                            Command="{Binding FlushQueueCommand}" 
                            Padding="10,4" FontSize="10"/>
                    <Button Content="💾 Record Session" 
                            Command="{Binding RecordSessionCommand}" 
                            Background="{DynamicResource SuccessBrush}" 
                            Padding="10,4" FontSize="10"/>
                </StackPanel>
            </Grid>
            
            <!-- Advanced Monitoring &amp; Debug -->
            <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
                <StackPanel  Margin="8">
                    <!-- Session Statistics -->
                    <Expander Header="📈 Session Stats" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="6" Margin="0,4,0,0">
                            <StackPanel >
                                <Grid>
                                    <TextBlock Text="Session Duration:" FontSize="9"/>
                                    <TextBlock Text="{Binding SessionDuration, StringFormat={}{0:hh\\:mm\\:ss}}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Words Processed:" FontSize="9"/>
                                    <TextBlock Text="{Binding WordsProcessed}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Audio Generated:" FontSize="9"/>
                                    <TextBlock Text="{Binding AudioGenerated, StringFormat={}{0:F1}s}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Avg Processing Time:" FontSize="9"/>
                                    <TextBlock Text="{Binding AverageProcessingTime, StringFormat={}{0:F1}ms/word}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Live Processing Queue -->
                    <Expander Header="📝 Processing Queue" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="4" Margin="0,4,0,0">
                            <ItemsControl ItemsSource="{Binding ProcessingQueue}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                                CornerRadius="2" Padding="4" Margin="0,1">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="{Binding TextSegment}" 
                                                               FontSize="9" FontFamily="Consolas" 
                                                               TextTrimming="CharacterEllipsis" 
                                                               MaxHeight="14"/>
                                                    <StackPanel Orientation="Horizontal" >
                                                        <TextBlock Text="{Binding Status}" 
                                                                   FontSize="8" 
                                                                   Foreground="{Binding StatusColor}"/>
                                                        <TextBlock Text="{Binding ProcessingTime, StringFormat={}{0:F0}ms}" 
                                                                   FontSize="8" 
                                                                   Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                    </StackPanel>
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Column="1" Orientation="Horizontal" >
                                                    <Button Content="▶" Width="16" Height="14" FontSize="7" 
                                                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.PlaySegmentCommand}" 
                                                            CommandParameter="{Binding}"/>
                                                    <Button Content="✖" Width="16" Height="14" FontSize="7" 
                                                            Background="{DynamicResource ErrorBrush}" 
                                                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.CancelSegmentCommand}" 
                                                            CommandParameter="{Binding}"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Border>
                    </Expander>
                    
                    <!-- Debug Console -->
                    <Expander Header="🐛 Debug Log" IsExpanded="False" FontSize="11">
                        <Border Background="{DynamicResource PrimaryDarkBrush}" 
                                CornerRadius="2" Height="100" Margin="0,4,0,0">
                            <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="4">
                                <TextBlock Text="{Binding DebugLog}" 
                                           FontFamily="Consolas" FontSize="8" 
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                            </ScrollViewer>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </DataTemplate>
    <DataTemplate x:Key="AudioProcessingTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="340"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="280"/>
            </Grid.ColumnDefinitions>
            
            <!-- Advanced Processing Configuration -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                <StackPanel  Margin="8">
                    <!-- DSP Pipeline Configuration -->
                    <Expander Header="🔧 DSP Pipeline" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="8" Margin="0,4,0,0">
                            <StackPanel >
                                <CheckBox Content="Pre-emphasis filter (α=0.97)" FontSize="9" 
                                          IsChecked="{Binding EnablePreEmphasis}"/>
                                <CheckBox Content="Spectral noise gating" FontSize="9" 
                                          IsChecked="{Binding EnableSpectralGating}"/>
                                <CheckBox Content="Adaptive noise reduction" FontSize="9" 
                                          IsChecked="{Binding EnableAdaptiveNR}"/>
                                <CheckBox Content="Multi-band compressor" FontSize="9" 
                                          IsChecked="{Binding EnableCompressor}"/>
                                <CheckBox Content="Voice activity detection" FontSize="9" 
                                          IsChecked="{Binding EnableVAD}"/>
                                
                                <!-- Technical Parameters -->
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="FFT Window Size" FontSize="9"/>
                                        <TextBlock Text="{Binding FFTWindowSize}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <ComboBox SelectedItem="{Binding FFTWindowSize}" FontSize="9">
                                        <ComboBoxItem Content="512"/>
                                        <ComboBoxItem Content="1024"/>
                                        <ComboBoxItem Content="2048"/>
                                        <ComboBoxItem Content="4096"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Overlap Factor" FontSize="9"/>
                                        <TextBlock Text="{Binding OverlapFactor, StringFormat={}{0:F2}}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding OverlapFactor}" 
                                            Minimum="0.25" Maximum="0.75" 
                                            TickFrequency="0.05" Height="16"/>
                                </StackPanel>
                                
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Noise Floor (dBFS)" FontSize="9"/>
                                        <TextBlock Text="{Binding NoiseFloor, StringFormat={}{0:F1}}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding NoiseFloor}" 
                                            Minimum="-80.0" Maximum="-20.0" 
                                            TickFrequency="1.0" Height="16"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Advanced Enhancement -->
                    <Expander Header="✨ Advanced Enhancement" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="8" Margin="0,4,0,0">
                            <StackPanel >
                                <!-- AI Enhancement Models -->
                                <StackPanel>
                                    <TextBlock Text="AI Enhancement Model:" FontSize="9" FontWeight="SemiBold" Margin="0,0,0,2"/>
                                    <ComboBox SelectedItem="{Binding AIModel}" FontSize="9">
                                        <ComboBoxItem Content="RealESRGAN (Voice)"/>
                                        <ComboBoxItem Content="DeepFilterNet"/>
                                        <ComboBoxItem Content="Facebook Denoiser"/>
                                        <ComboBoxItem Content="Custom ONNX Model"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <!-- Enhancement Strength Controls -->
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Enhancement Strength" FontSize="9"/>
                                        <TextBlock Text="{Binding EnhancementStrength, StringFormat={}{0}%}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding EnhancementStrength}" 
                                            Minimum="0" Maximum="100" 
                                            TickFrequency="5" Height="16"/>
                                </StackPanel>
                                
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Noise Suppression" FontSize="9"/>
                                        <TextBlock Text="{Binding NoiseSuppressionLevel, StringFormat={}{0}%}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding NoiseSuppressionLevel}" 
                                            Minimum="0" Maximum="100" 
                                            TickFrequency="5" Height="16"/>
                                </StackPanel>
                                
                                <StackPanel>
                                    <Grid Margin="0,0,0,2">
                                        <TextBlock Text="Voice Clarity Boost" FontSize="9"/>
                                        <TextBlock Text="{Binding ClarityBoost, StringFormat={}{0:F1} dB}" 
                                                   HorizontalAlignment="Right" FontSize="9" 
                                                   Foreground="{DynamicResource AccentRedBrush}"/>
                                    </Grid>
                                    <Slider Value="{Binding ClarityBoost}" 
                                            Minimum="0.0" Maximum="12.0" 
                                            TickFrequency="0.5" Height="16"/>
                                </StackPanel>
                                
                                <CheckBox Content="Enable real-time preview" FontSize="9" 
                                          IsChecked="{Binding EnableRealtimePreview}"/>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Output Configuration -->
                    <Expander Header="💾 Output Configuration" IsExpanded="False" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="8" Margin="0,4,0,0">
                            <StackPanel >
                                <StackPanel>
                                    <TextBlock Text="Output Format:" FontSize="9" Margin="0,0,0,2"/>
                                    <ComboBox SelectedItem="{Binding OutputFormat}" FontSize="9">
                                        <ComboBoxItem Content="WAV (Uncompressed)"/>
                                        <ComboBoxItem Content="FLAC (Lossless)"/>
                                        <ComboBoxItem Content="MP3 (320 kbps)"/>
                                        <ComboBoxItem Content="OGG (Q10)"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel>
                                    <TextBlock Text="Bit Depth:" FontSize="9" Margin="0,0,0,2"/>
                                    <ComboBox SelectedItem="{Binding OutputBitDepth}" FontSize="9">
                                        <ComboBoxItem Content="16-bit"/>
                                        <ComboBoxItem Content="24-bit"/>
                                        <ComboBoxItem Content="32-bit float"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel>
                                    <TextBlock Text="Sample Rate:" FontSize="9" Margin="0,0,0,2"/>
                                    <ComboBox SelectedItem="{Binding OutputSampleRate}" FontSize="9">
                                        <ComboBoxItem Content="44100 Hz"/>
                                        <ComboBoxItem Content="48000 Hz"/>
                                        <ComboBoxItem Content="96000 Hz"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <CheckBox Content="Apply dithering" FontSize="9" 
                                          IsChecked="{Binding ApplyDithering}"/>
                                <CheckBox Content="Preserve metadata" FontSize="9" 
                                          IsChecked="{Binding PreserveMetadata}"/>
                            </StackPanel>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
            
            <!-- Processing Interface with Technical Analysis -->
            <Grid Grid.Column="1" Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="100"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- File Input with Technical Info -->
                <Border Grid.Row="0" Background="{DynamicResource SecondaryDarkBrush}" 
                        CornerRadius="4" Padding="16" Margin="0,0,0,8">
                    <StackPanel >
                        <TextBlock Text="🎵 Advanced Audio Processing" 
                                   FontSize="14" FontWeight="SemiBold"/>
                        
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                BorderBrush="{DynamicResource BorderBrush}" 
                                BorderThickness="2" 
                                CornerRadius="4" 
                                Padding="20" 
                                AllowDrop="True">
                            <StackPanel HorizontalAlignment="Center" >
                                <TextBlock Text="📁" FontSize="28" HorizontalAlignment="Center"/>
                                <TextBlock Text="Drop audio files for technical processing" 
                                           FontSize="12" HorizontalAlignment="Center"/>
                                <TextBlock Text="Supports: WAV, FLAC, OGG, M4A, AIFF, AU" 
                                           FontSize="10" 
                                           Foreground="{DynamicResource TextSecondaryBrush}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- File Technical Info -->
                        <Grid Visibility="{Binding HasInputFile, Converter={StaticResource BoolToVisibility}}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Sample Rate:" FontSize="9" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <TextBlock Text="{Binding InputSampleRate, StringFormat={}{0} Hz}" FontSize="10" FontWeight="SemiBold"/>
                            </StackPanel>
                            <StackPanel Grid.Column="1">
                                <TextBlock Text="Bit Depth:" FontSize="9" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <TextBlock Text="{Binding InputBitDepth, StringFormat={}{0} bit}" FontSize="10" FontWeight="SemiBold"/>
                            </StackPanel>
                            <StackPanel Grid.Column="2">
                                <TextBlock Text="Channels:" FontSize="9" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <TextBlock Text="{Binding InputChannels}" FontSize="10" FontWeight="SemiBold"/>
                            </StackPanel>
                            <StackPanel Grid.Column="3">
                                <TextBlock Text="Duration:" FontSize="9" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <TextBlock Text="{Binding InputDuration, StringFormat={}{0:mm\\:ss\\.ff}}" FontSize="10" FontWeight="SemiBold"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- Technical Waveform Analysis -->
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Original Analysis -->
                    <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="4" Padding="8" Margin="0,0,4,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <StackPanel Grid.Row="0" Orientation="Horizontal"  Margin="0,0,0,6">
                                <TextBlock Text="📥 Original Analysis" FontSize="11" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding OriginalFileSize, StringFormat={}{0:F1} MB}" 
                                           FontSize="9" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </StackPanel>
                            
                            <!-- Waveform + Spectrogram placeholder -->
                            <Border Grid.Row="1" Background="{DynamicResource PrimaryDarkBrush}" 
                                    CornerRadius="2" MinHeight="120">
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" >
                                    <TextBlock Text="🌊" FontSize="20"/>
                                    <TextBlock Text="Waveform" FontSize="9" 
                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                    <TextBlock Text="+ Spectrogram" FontSize="8" 
                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Technical Metrics -->
                            <Border Grid.Row="2" Background="{DynamicResource SecondaryDarkBrush}" 
                                    CornerRadius="2" Padding="6" Margin="0,6,0,0">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0" >
                                        <Grid>
                                            <TextBlock Text="RMS:" FontSize="8"/>
                                            <TextBlock Text="{Binding OriginalRMS, StringFormat={}{0:F1} dBFS}" 
                                                       HorizontalAlignment="Right" FontSize="8" 
                                                       Foreground="{DynamicResource AccentRedBrush}"/>
                                        </Grid>
                                        <Grid>
                                            <TextBlock Text="Peak:" FontSize="8"/>
                                            <TextBlock Text="{Binding OriginalPeak, StringFormat={}{0:F1} dBFS}" 
                                                       HorizontalAlignment="Right" FontSize="8" 
                                                       Foreground="{DynamicResource AccentRedBrush}"/>
                                        </Grid>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1" >
                                        <Grid>
                                            <TextBlock Text="SNR:" FontSize="8"/>
                                            <TextBlock Text="{Binding OriginalSNR, StringFormat={}{0:F1} dB}" 
                                                       HorizontalAlignment="Right" FontSize="8" 
                                                       Foreground="{DynamicResource AccentRedBrush}"/>
                                        </Grid>
                                        <Grid>
                                            <TextBlock Text="THD:" FontSize="8"/>
                                            <TextBlock Text="{Binding OriginalTHD, StringFormat={}{0:F3}%}" 
                                                       HorizontalAlignment="Right" FontSize="8" 
                                                       Foreground="{DynamicResource AccentRedBrush}"/>
                                        </Grid>
                                    </StackPanel>
                                </Grid>
                            </Border>
                            
                            <Button Grid.Row="3" Content="▶ Play Original" 
                                    Command="{Binding PlayOriginalCommand}" 
                                    HorizontalAlignment="Stretch" Margin="0,4,0,0"
                                    Padding="6,4" FontSize="9"/>
                        </Grid>
                    </Border>
                    
                    <!-- Processed Analysis -->
                    <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="4" Padding="8" Margin="4,0,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <StackPanel Grid.Row="0" Orientation="Horizontal"  Margin="0,0,0,6">
                                <TextBlock Text="✨ Enhanced Analysis" FontSize="11" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding ProcessedFileSize, StringFormat={}{0:F1} MB}" 
                                           FontSize="9" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </StackPanel>
                            
                            <!-- Enhanced waveform + spectrogram placeholder -->
                            <Border Grid.Row="1" Background="{DynamicResource PrimaryDarkBrush}" 
                                    CornerRadius="2" MinHeight="120">
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" >
                                    <TextBlock Text="⚡" FontSize="20"/>
                                    <TextBlock Text="Enhanced" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                    <TextBlock Text="+ Analysis" FontSize="8" 
                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Enhanced Technical Metrics -->
                            <Border Grid.Row="2" Background="{DynamicResource SecondaryDarkBrush}" 
                                    CornerRadius="2" Padding="6" Margin="0,6,0,0">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0" >
                                        <Grid>
                                            <TextBlock Text="RMS:" FontSize="8"/>
                                            <TextBlock Text="{Binding ProcessedRMS, StringFormat={}{0:F1} dBFS}" 
                                                       HorizontalAlignment="Right" FontSize="8" 
                                                       Foreground="{DynamicResource AccentRedBrush}"/>
                                        </Grid>
                                        <Grid>
                                            <TextBlock Text="Peak:" FontSize="8"/>
                                            <TextBlock Text="{Binding ProcessedPeak, StringFormat={}{0:F1} dBFS}" 
                                                       HorizontalAlignment="Right" FontSize="8" 
                                                       Foreground="{DynamicResource AccentRedBrush}"/>
                                        </Grid>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1" >
                                        <Grid>
                                            <TextBlock Text="SNR:" FontSize="8"/>
                                            <TextBlock Text="{Binding ProcessedSNR, StringFormat={}{0:F1} dB}" 
                                                       HorizontalAlignment="Right" FontSize="8" 
                                                       Foreground="{DynamicResource AccentRedBrush}"/>
                                        </Grid>
                                        <Grid>
                                            <TextBlock Text="THD:" FontSize="8"/>
                                            <TextBlock Text="{Binding ProcessedTHD, StringFormat={}{0:F3}%}" 
                                                       HorizontalAlignment="Right" FontSize="8" 
                                                       Foreground="{DynamicResource AccentRedBrush}"/>
                                        </Grid>
                                    </StackPanel>
                                </Grid>
                            </Border>
                            
                            <Button Grid.Row="3" Content="▶ Play Enhanced" 
                                    Command="{Binding PlayProcessedCommand}" 
                                    HorizontalAlignment="Stretch" Margin="0,4,0,0"
                                    Background="{DynamicResource AccentRedBrush}" 
                                    Padding="6,4" FontSize="9"/>
                        </Grid>
                    </Border>
                </Grid>
                
                <!-- Processing Progress with Technical Details -->
                <Border Grid.Row="2" Background="{DynamicResource SecondaryDarkBrush}" 
                        CornerRadius="4" Padding="8" Margin="0,8,0,0"
                        Visibility="{Binding IsProcessing, Converter={StaticResource BoolToVisibility}}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal"  Margin="0,0,0,6">
                            <TextBlock Text="🔄 Processing Audio..." FontSize="11" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding ProcessingProgress, StringFormat={}{0:P0}}" 
                                       FontSize="11" Foreground="{DynamicResource AccentRedBrush}"/>
                            <TextBlock Text="{Binding ProcessingSpeed, StringFormat={}Speed: {0:F1}x RT}" 
                                       FontSize="9" Foreground="{DynamicResource TextSecondaryBrush}"/>
                        </StackPanel>
                        
                        <ProgressBar Grid.Row="1" Value="{Binding ProcessingProgress}" 
                                     Height="8" Background="{DynamicResource PrimaryDarkBrush}" 
                                     Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,6"/>
                        
                        <StackPanel Grid.Row="2" Orientation="Horizontal" >
                            <TextBlock Text="{Binding CurrentProcessingStep}" 
                                       FontSize="9" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <TextBlock Text="{Binding ETA, StringFormat={}ETA: {0:mm\\:ss}}" 
                                       FontSize="9" Foreground="{DynamicResource TextSecondaryBrush}"/>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <!-- Technical Processing Controls -->
                <StackPanel Grid.Row="3" Orientation="Horizontal" 
                           HorizontalAlignment="Center"  Margin="0,8,0,0">
                    <Button Content="🎯 Process Audio" 
                            Command="{Binding ProcessAudioCommand}" 
                            Background="{DynamicResource AccentRedBrush}" 
                            Padding="16,6" FontSize="10" FontWeight="SemiBold"/>
                    <Button Content="📊 Analyze" 
                            Command="{Binding AnalyzeCommand}" 
                            Padding="12,6" FontSize="10"/>
                    <Button Content="💾 Export" 
                            Command="{Binding ExportCommand}" 
                            Background="{DynamicResource SuccessBrush}" 
                            Padding="12,6" FontSize="10"/>
                    <Button Content="🔄 Reset" 
                            Command="{Binding ResetCommand}" 
                            Padding="12,6" FontSize="10"/>
                </StackPanel>
            </Grid>
            
            <!-- Technical Analysis &amp; History -->
            <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
                <StackPanel  Margin="8">
                    <!-- Performance Analysis -->
                    <Expander Header="📊 Analysis Results" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="6" Margin="0,4,0,0">
                            <StackPanel >
                                <Grid>
                                    <TextBlock Text="Processing Time:" FontSize="9"/>
                                    <TextBlock Text="{Binding ProcessingTime, StringFormat={}{0:F1}s}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Quality Improvement:" FontSize="9"/>
                                    <TextBlock Text="{Binding QualityImprovement, StringFormat={}{0:+F1;-F1;0} dB}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Noise Reduction:" FontSize="9"/>
                                    <TextBlock Text="{Binding NoiseReduction, StringFormat={}{0:F1} dB}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Dynamic Range:" FontSize="9"/>
                                    <TextBlock Text="{Binding DynamicRange, StringFormat={}{0:F1} dB}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="File Size Change:" FontSize="9"/>
                                    <TextBlock Text="{Binding FileSizeChange, StringFormat={}{0:+P1;-P1;No change}}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </Expander>
                    
                    <!-- Processing History -->
                    <Expander Header="📚 Processing History" IsExpanded="True" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="4" Margin="0,4,0,0">
                            <ItemsControl ItemsSource="{Binding ProcessingHistory}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{DynamicResource SecondaryDarkBrush}" 
                                                CornerRadius="2" Padding="6" Margin="0,1">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                
                                                <TextBlock Grid.Row="0" Text="{Binding FileName}" 
                                                           FontSize="9" FontWeight="SemiBold" 
                                                           TextTrimming="CharacterEllipsis"/>
                                                
                                                <StackPanel Grid.Row="1" Orientation="Horizontal"  Margin="0,2,0,0">
                                                    <TextBlock Text="{Binding ProcessingType}" 
                                                               FontSize="8" 
                                                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                    <TextBlock Text="{Binding ProcessingDate, StringFormat={}{0:MM/dd HH:mm}}" 
                                                               FontSize="8" 
                                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                                </StackPanel>
                                                
                                                <Grid Grid.Row="2" Margin="0,2,0,0">
                                                    <TextBlock Text="Quality Gain:" FontSize="8"/>
                                                    <TextBlock Text="{Binding QualityGain, StringFormat={}{0:+F1;-F1;0}dB}" 
                                                               HorizontalAlignment="Right" FontSize="8" 
                                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                                </Grid>
                                                
                                                <StackPanel Grid.Row="3" Orientation="Horizontal" 
                                                            Margin="0,4,0,0">
                                                    <Button Content="▶" Width="18" Height="16" FontSize="8" 
                                                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.PlayHistoryCommand}" 
                                                            CommandParameter="{Binding}"/>
                                                    <Button Content="📊" Width="18" Height="16" FontSize="8" 
                                                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.AnalyzeHistoryCommand}" 
                                                            CommandParameter="{Binding}"/>
                                                    <Button Content="💾" Width="18" Height="16" FontSize="8" 
                                                            Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.SaveHistoryCommand}" 
                                                            CommandParameter="{Binding}"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Border>
                    </Expander>
                    
                    <!-- System Resources -->
                    <Expander Header="💻 System Resources" IsExpanded="False" FontSize="11">
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="2" Padding="6" Margin="0,4,0,0">
                            <StackPanel >
                                <Grid>
                                    <TextBlock Text="CPU Usage:" FontSize="9"/>
                                    <TextBlock Text="{Binding CpuUsage, StringFormat={}{0:F0}%}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Memory Usage:" FontSize="9"/>
                                    <TextBlock Text="{Binding MemoryUsage, StringFormat={}{0:F0} MB}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="GPU Acceleration:" FontSize="9"/>
                                    <TextBlock Text="{Binding GpuAcceleration}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                </Grid>
                                <Grid>
                                    <TextBlock Text="Temp Directory:" FontSize="9"/>
                                    <TextBlock Text="{Binding TempSpaceUsed, StringFormat={}{0:F1} GB}" 
                                               HorizontalAlignment="Right" FontSize="9" 
                                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </DataTemplate>

    <!-- Text to Image View - Developer Mode -->
    <DataTemplate x:Key="DeveloperText2ImageViewModelTemplate">
        <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="400"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="350"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel: Advanced Controls -->
            <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8,0,0,8" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔧 Advanced Generation" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Prompts -->
                        <TextBox Text="{Binding Prompt}" Style="{DynamicResource DarkTextBoxStyle}" MinHeight="80" TextWrapping="Wrap" FontFamily="Consolas" Tag="Advanced prompting syntax" Margin="0,0,0,8"/>
                        <TextBox Text="{Binding NegativePrompt}" Style="{DynamicResource DarkTextBoxStyle}" MinHeight="50" TextWrapping="Wrap" FontFamily="Consolas" Tag="Negative prompt" Margin="0,0,0,16"/>

                        <!-- Parameters -->
                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="50"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Steps:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <Slider Grid.Column="1" Value="{Binding Steps}" Minimum="1" Maximum="150" Margin="4,0"/>
                            <TextBox Grid.Column="2" Text="{Binding Steps}" Style="{DynamicResource DarkTextBoxStyle}"/>
                        </Grid>

                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="50"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="CFG:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <Slider Grid.Column="1" Value="{Binding CfgScale}" Minimum="0" Maximum="30" Margin="4,0"/>
                            <TextBox Grid.Column="2" Text="{Binding CfgScale, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}"/>
                        </Grid>

                        <ComboBox ItemsSource="{Binding AvailableSamplers}" SelectedItem="{Binding SelectedSampler}" Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8"/>
                        
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox Text="{Binding Seed}" Style="{DynamicResource DarkTextBoxStyle}" FontFamily="Consolas"/>
                            <Button Grid.Column="1" Content="🎲" Command="{Binding RandomizeSeedCommand}" Style="{DynamicResource SecondaryButtonStyle}" Width="28" Margin="4,0,0,0"/>
                        </Grid>

                        <Button Content="🎨 Generate" Command="{Binding GenerateCommand}" Style="{DynamicResource PrimaryButtonStyle}" Padding="0,12" FontWeight="SemiBold" IsEnabled="{Binding CanGenerate}"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- Center Panel: Preview -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="80"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" Margin="0,0,0,8">
                        <Grid>
                            <Image Source="{Binding GeneratedImageSource}" Stretch="Uniform" Visibility="{Binding HasGeneratedImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasGeneratedImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                <TextBlock Text="🖼️" FontSize="48" HorizontalAlignment="Center" Opacity="0.3"/>
                                <TextBlock Text="Generation Canvas" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                            </StackPanel>
                            
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <StackPanel>
                                    <TextBlock Text="Processing..." Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                    <ProgressBar Value="{Binding GenerationProgress}" Height="6" Width="200" Background="{DynamicResource TertiaryDarkBrush}" Foreground="{DynamicResource AccentRedBrush}"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Border>

                    <!-- Debug Log -->
                    <Border Grid.Row="1" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="8">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <TextBlock Text="{Binding GenerationStatus}" FontFamily="Consolas" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </Border>

            <!-- Right Panel: Tools -->
            <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="0,8,8,0" Padding="16">
                <StackPanel>
                    <TextBlock Text="🔬 Advanced Tools" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>
                    <Button Content="🔄 Batch Generate" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                    <Button Content="📊 Analytics" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                    <Button Content="📤 Export" Style="{DynamicResource SecondaryButtonStyle}"/>
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>

    <!-- Image to Image View - Developer Mode -->
    <DataTemplate x:Key="DeveloperImage2ImageViewModelTemplate">
        <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="380"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="320"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel: Advanced Controls -->
            <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8,0,0,8" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔧 Advanced Image Processing" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Image Input -->
                        <Expander Header="📁 Source Image" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Border Background="{DynamicResource SecondaryDarkBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" CornerRadius="4" Padding="12" AllowDrop="True">
                                    <StackPanel HorizontalAlignment="Center">
                                        <StackPanel Visibility="{Binding HasSourceImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                            <TextBlock Text="📁" FontSize="20" HorizontalAlignment="Center" Margin="0,0,0,6"/>
                                            <Button Content="Load Image" Command="{Binding LoadImageCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                                        </StackPanel>
                                        <StackPanel Visibility="{Binding HasSourceImage, Converter={StaticResource BooleanToVisibilityConverter}}">
                                            <Image Source="{Binding SourceImageSource}" MaxHeight="100" Stretch="Uniform" Margin="0,0,0,6"/>
                                            <TextBlock Text="{Binding SourceImageInfo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" FontFamily="Consolas"/>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,6,0,0">
                                                <Button Content="✂️" Command="{Binding CropImageCommand}" Style="{DynamicResource GhostButtonStyle}" ToolTip="Crop" Margin="0,0,2,0"/>
                                                <Button Content="🔄" Command="{Binding RotateImageCommand}" Style="{DynamicResource GhostButtonStyle}" ToolTip="Rotate" Margin="0,0,2,0"/>
                                                <Button Content="📏" Command="{Binding ResizeImageCommand}" Style="{DynamicResource GhostButtonStyle}" ToolTip="Resize" Margin="0,0,2,0"/>
                                                <Button Content="🗑️" Command="{Binding ClearImageCommand}" Style="{DynamicResource GhostButtonStyle}" ToolTip="Clear"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Expander>

                        <!-- Prompt Engineering -->
                        <Expander Header="📝 Transformation Prompts" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <TextBox Text="{Binding Prompt, UpdateSourceTrigger=PropertyChanged}" Style="{DynamicResource DarkTextBoxStyle}" MinHeight="80" TextWrapping="Wrap" AcceptsReturn="True" FontFamily="Consolas" Tag="Main transformation prompt" Margin="0,0,0,8"/>
                                <TextBox Text="{Binding NegativePrompt, UpdateSourceTrigger=PropertyChanged}" Style="{DynamicResource DarkTextBoxStyle}" MinHeight="50" TextWrapping="Wrap" FontFamily="Consolas" Tag="Negative prompt" Margin="0,0,0,8"/>
                                <StackPanel Orientation="Horizontal">
                                    <Button Content="📋" Command="{Binding CopyPromptCommand}" CommandParameter="{Binding Prompt}" Style="{DynamicResource GhostButtonStyle}" Margin="0,0,4,0"/>
                                    <Button Content="⭐" Command="{Binding AddToFavoritesCommand}" Style="{DynamicResource GhostButtonStyle}" Margin="0,0,4,0"/>
                                    <Button Content="🎲" Style="{DynamicResource GhostButtonStyle}"/>
                                </StackPanel>
                            </StackPanel>
                        </Expander>

                        <!-- Core Parameters -->
                        <Expander Header="⚙️ Generation Parameters" IsExpanded="True" Margin="0,0,0,12">
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="12" Margin="0,8,0,0">
                                <StackPanel>
                                    <!-- Strength -->
                                    <Grid Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="50"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Strength:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding Strength}" Minimum="0" Maximum="1" TickFrequency="0.01" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding Strength, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>

                                    <!-- Steps -->
                                    <Grid Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="50"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Steps:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding Steps}" Minimum="1" Maximum="100" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding Steps}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>

                                    <!-- CFG -->
                                    <Grid Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="50"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="CFG:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding CfgScale}" Minimum="0" Maximum="30" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding CfgScale, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>

                                    <!-- Sampler -->
                                    <Grid Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Sampler:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <ComboBox Grid.Column="1" ItemsSource="{Binding AvailableSamplers}" SelectedItem="{Binding SelectedSampler}" Style="{DynamicResource DarkComboBoxStyle}" Margin="4,0,0,0"/>
                                    </Grid>

                                    <!-- Seed -->
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Seed:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <TextBox Grid.Column="1" Text="{Binding Seed}" Style="{DynamicResource DarkTextBoxStyle}" FontFamily="Consolas" Margin="4,0,2,0"/>
                                        <Button Grid.Column="2" Content="🎲" Command="{Binding RandomizeSeedCommand}" Style="{DynamicResource SecondaryButtonStyle}" Width="24"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Expander>

                        <!-- Advanced Options -->
                        <Expander Header="🔬 Advanced Options" IsExpanded="False" Margin="0,0,0,16">
                            <StackPanel Margin="0,8,0,0">
                                <CheckBox Content="Enable Inpainting" IsChecked="{Binding UseInpainting}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,4"/>
                                <CheckBox Content="Enable Outpainting" IsChecked="{Binding UseOutpainting}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,8"/>
                                
                                <TextBlock Text="Mask Blur" Margin="0,0,0,4" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Value="{Binding MaskBlur}" Minimum="0" Maximum="32" TickFrequency="1"/>
                                    <TextBox Grid.Column="1" Text="{Binding MaskBlur, StringFormat=F0}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" Margin="4,0,0,0"/>
                                </Grid>

                                <TextBlock Text="Batch Size" Margin="0,0,0,4" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Value="{Binding BatchSize}" Minimum="1" Maximum="8" TickFrequency="1" IsSnapToTickEnabled="True"/>
                                    <TextBox Grid.Column="1" Text="{Binding BatchSize}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" Margin="4,0,0,0"/>
                                </Grid>
                            </StackPanel>
                        </Expander>

                        <!-- Generation Controls -->
                        <StackPanel>
                            <Button Content="🎨 Generate" Command="{Binding GenerateCommand}" Style="{DynamicResource PrimaryButtonStyle}" Padding="0,12" FontWeight="SemiBold" IsEnabled="{Binding CanGenerate}" Margin="0,0,0,6"/>
                            <Button Content="⏹ Cancel" Command="{Binding CancelCommand}" Style="{DynamicResource SecondaryButtonStyle}" Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- Center Panel: Comparison & Canvas -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="100"/>
                    </Grid.RowDefinitions>

                    <!-- Before/After Comparison -->
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Source Image -->
                        <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" Margin="0,0,8,0">
                            <Grid>
                                <Image Source="{Binding SourceImageSource}" Stretch="Uniform" Visibility="{Binding HasSourceImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasSourceImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                    <TextBlock Text="📷" FontSize="48" HorizontalAlignment="Center" Opacity="0.3"/>
                                    <TextBlock Text="Source Image" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock Text="BEFORE" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="8" FontWeight="SemiBold"/>
                            </Grid>
                        </Border>

                        <!-- Result Image -->
                        <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" Margin="8,0,0,0">
                            <Grid>
                                <Image Source="{Binding GeneratedImageSource}" Stretch="Uniform" Visibility="{Binding HasGeneratedImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasGeneratedImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                    <TextBlock Text="✨" FontSize="48" HorizontalAlignment="Center" Opacity="0.3"/>
                                    <TextBlock Text="Result" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                </StackPanel>
                                
                                <!-- Progress Overlay -->
                                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="12" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <StackPanel>
                                        <TextBlock Text="Processing..." Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,0,0,6"/>
                                        <ProgressBar Value="{Binding GenerationProgress}" Height="4" Width="150" Background="{DynamicResource TertiaryDarkBrush}" Foreground="{DynamicResource AccentRedBrush}"/>
                                    </StackPanel>
                                </Border>
                                <TextBlock Text="AFTER" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="8" FontWeight="SemiBold"/>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Debug Log -->
                    <Border Grid.Row="1" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="8" Margin="0,8,0,0">
                        <StackPanel>
                            <TextBlock Text="🔍 Debug Log" Style="{DynamicResource CaptionTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"/>
                            <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="60">
                                <TextBlock Text="{Binding GenerationStatus}" FontFamily="Consolas" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap"/>
                            </ScrollViewer>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <!-- Right Panel: Advanced Tools & Analytics -->
            <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="0,8,8,0" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔬 Advanced Tools" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Batch Processing -->
                        <Expander Header="🔄 Batch Processing" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Batch Operations" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                <Button Content="🚀 Batch Transform" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                                <Button Content="📊 Compare Results" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                                <TextBlock Text="{Binding BatchEstimate}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" FontFamily="Consolas"/>
                            </StackPanel>
                        </Expander>

                        <!-- Mask Tools -->
                        <Expander Header="🖌️ Mask Tools" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <Button Content="🖌️ Paint" Style="{DynamicResource GhostButtonStyle}" Margin="0,0,4,0"/>
                                    <Button Content="🧽 Erase" Style="{DynamicResource GhostButtonStyle}" Margin="0,0,4,0"/>
                                    <Button Content="🗑️ Clear" Style="{DynamicResource GhostButtonStyle}"/>
                                </StackPanel>
                                <TextBlock Text="Brush Size" Margin="0,0,0,4" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <Slider Value="20" Minimum="1" Maximum="100" Margin="0,0,0,8"/>
                                <CheckBox Content="Auto-mask detection" Style="{DynamicResource DarkCheckBoxStyle}"/>
                            </StackPanel>
                        </Expander>

                        <!-- Analytics -->
                        <Expander Header="📊 Analytics" IsExpanded="False" Margin="0,0,0,16">
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="8" Margin="0,8,0,0">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Total:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="{Binding GenerationHistory.Count}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="Success:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="95%" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource SuccessBrush}"/>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Expander>

                        <!-- Quick Actions -->
                        <StackPanel>
                            <Button Content="📤 Export Settings" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                            <Button Content="📥 Import Settings" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                            <Button Content="🗑️ Clear All" Command="{Binding ClearHistoryCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </DataTemplate>

    <!-- Inpainting View - Developer Mode -->
    <DataTemplate x:Key="DeveloperInpaintingViewModelTemplate">
        <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="350"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel: Advanced Controls -->
            <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8,0,0,8" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔧 Advanced Inpainting" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Image Input -->
                        <Expander Header="📁 Source Image" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="Load Image" Command="{Binding LoadImageCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="8" Visibility="{Binding HasSourceImage, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <StackPanel>
                                        <Image Source="{Binding SourceImageSource}" MaxHeight="80" Stretch="Uniform" Margin="0,0,0,4"/>
                                        <TextBlock Text="{Binding SourceImageInfo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" FontFamily="Consolas"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Expander>

                        <!-- Advanced Brush Tools -->
                        <Expander Header="🖌️ Advanced Brush Tools" IsExpanded="True" Margin="0,0,0,12">
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="12" Margin="0,8,0,0">
                                <StackPanel>
                                    <!-- Brush Mode -->
                                    <ComboBox ItemsSource="{Binding BrushModes}" SelectedItem="{Binding SelectedBrushMode}" Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8"/>
                                    
                                    <!-- Size -->
                                    <Grid Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="60"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="40"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Size:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding BrushSize}" Minimum="1" Maximum="200" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding BrushSize, StringFormat=F0}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>

                                    <!-- Hardness -->
                                    <Grid Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="60"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="40"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Hard:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding BrushHardness}" Minimum="0" Maximum="1" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding BrushHardness, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>

                                    <!-- Opacity -->
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="60"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="40"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Opacity:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding BrushOpacity}" Minimum="0" Maximum="1" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding BrushOpacity, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Expander>

                        <!-- Generation Parameters -->
                        <Expander Header="⚙️ Generation Parameters" IsExpanded="True" Margin="0,0,0,12">
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="12" Margin="0,8,0,0">
                                <StackPanel>
                                    <!-- Strength -->
                                    <Grid Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="60"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="40"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Strength:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding Strength}" Minimum="0" Maximum="1" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding Strength, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>

                                    <!-- Steps -->
                                    <Grid Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="60"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="40"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Steps:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding Steps}" Minimum="1" Maximum="100" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding Steps}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>

                                    <!-- CFG -->
                                    <Grid Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="60"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="40"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="CFG:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding CfgScale}" Minimum="0" Maximum="30" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding CfgScale, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>

                                    <!-- Mask Blur -->
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="60"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="40"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Blur:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding MaskBlur}" Minimum="0" Maximum="32" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding MaskBlur}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Expander>

                        <!-- Prompts -->
                        <TextBox Text="{Binding Prompt}" Style="{DynamicResource DarkTextBoxStyle}" MinHeight="60" TextWrapping="Wrap" FontFamily="Consolas" Tag="Inpainting prompt" Margin="0,0,0,8"/>
                        <TextBox Text="{Binding NegativePrompt}" Style="{DynamicResource DarkTextBoxStyle}" MinHeight="40" TextWrapping="Wrap" FontFamily="Consolas" Tag="Negative prompt" Margin="0,0,0,16"/>

                        <!-- Generate Button -->
                        <Button Content="🎨 Generate" Command="{Binding GenerateCommand}" Style="{DynamicResource PrimaryButtonStyle}" Padding="0,12" FontWeight="SemiBold" IsEnabled="{Binding CanGenerate}"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- Center Panel: Advanced Canvas -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="80"/>
                    </Grid.RowDefinitions>

                    <!-- Canvas Toolbar -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,8">
                        <Button Content="🖌️" Command="{Binding SetBrushModeCommand}" CommandParameter="Paint" Style="{DynamicResource GhostButtonStyle}" Margin="0,0,2,0"/>
                        <Button Content="🧽" Command="{Binding SetBrushModeCommand}" CommandParameter="Erase" Style="{DynamicResource GhostButtonStyle}" Margin="0,0,2,0"/>
                        <Button Content="↶" Command="{Binding UndoMaskCommand}" Style="{DynamicResource GhostButtonStyle}" Margin="0,0,2,0"/>
                        <Button Content="↷" Command="{Binding RedoMaskCommand}" Style="{DynamicResource GhostButtonStyle}" Margin="0,0,8,0"/>
                        <Button Content="📥" Command="{Binding ImportMaskCommand}" Style="{DynamicResource GhostButtonStyle}" Margin="0,0,2,0"/>
                        <Button Content="📤" Command="{Binding ExportMaskCommand}" Style="{DynamicResource GhostButtonStyle}" Margin="0,0,2,0"/>
                        <Button Content="🗑️" Command="{Binding ClearMaskCommand}" Style="{DynamicResource GhostButtonStyle}"/>
                    </StackPanel>

                    <!-- Canvas -->
                    <Border Grid.Row="1" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                        <Grid>
                            <Image Source="{Binding SourceImageSource}" Stretch="Uniform" Visibility="{Binding HasSourceImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            <Image Source="{Binding MaskImageSource}" Stretch="Uniform" Opacity="0.7" Visibility="{Binding HasMask, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            <Image Source="{Binding GeneratedImageSource}" Stretch="Uniform" Visibility="{Binding HasGeneratedImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasSourceImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                <TextBlock Text="🖼️" FontSize="48" HorizontalAlignment="Center" Opacity="0.3"/>
                                <TextBlock Text="Advanced Inpainting Canvas" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                            </StackPanel>
                            
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <StackPanel>
                                    <TextBlock Text="Processing..." Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                    <ProgressBar Value="{Binding GenerationProgress}" Height="6" Width="200" Background="{DynamicResource TertiaryDarkBrush}" Foreground="{DynamicResource AccentRedBrush}"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Border>

                    <!-- Debug Panel -->
                    <Border Grid.Row="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="8" Margin="0,8,0,0">
                        <StackPanel>
                            <TextBlock Text="🔍 Debug Info" Style="{DynamicResource CaptionTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"/>
                            <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="50">
                                <TextBlock Text="{Binding GenerationStatus}" FontFamily="Consolas" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </ScrollViewer>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <!-- Right Panel: Advanced Tools -->
            <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="0,8,8,0" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔬 Advanced Tools" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Mask Layers -->
                        <Expander Header="🗂️ Mask Layers" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="+ Add Layer" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                                <ScrollViewer MaxHeight="150">
                                    <ItemsControl ItemsSource="{Binding MaskLayers}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="6" Margin="0,0,0,4">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="{Binding Name}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextPrimaryBrush}" VerticalAlignment="Center"/>
                                                        <CheckBox Grid.Column="1" IsChecked="{Binding IsVisible}" Style="{DynamicResource DarkCheckBoxStyle}"/>
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </StackPanel>
                        </Expander>

                        <!-- Batch Processing -->
                        <Expander Header="🔄 Batch Processing" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="🚀 Batch Inpaint" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                                <Button Content="📊 Compare Results" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                                <TextBlock Text="Multi-prompt processing" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                            </StackPanel>
                        </Expander>

                        <!-- Advanced Options -->
                        <Expander Header="🔬 Advanced Options" IsExpanded="False" Margin="0,0,0,16">
                            <StackPanel Margin="0,8,0,0">
                                <CheckBox Content="Multi-layer blending" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,4"/>
                                <CheckBox Content="Edge feathering" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,4"/>
                                <CheckBox Content="Content-aware fill" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,8"/>
                                <ComboBox ItemsSource="{Binding AvailableModels}" SelectedItem="{Binding SelectedModel}" Style="{DynamicResource DarkComboBoxStyle}"/>
                            </StackPanel>
                        </Expander>

                        <!-- Quick Actions -->
                        <StackPanel>
                            <Button Content="📤 Export Settings" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                            <Button Content="📥 Import Settings" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                            <Button Content="🗑️ Clear All" Command="{Binding ClearHistoryCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </DataTemplate>

    <!-- Upscaling View - Developer Mode -->
    <DataTemplate x:Key="DeveloperUpscalingViewModelTemplate">
        <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="380"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel: Advanced Controls -->
            <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8,0,0,8" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔧 Advanced Upscaling" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Image Input -->
                        <Expander Header="📁 Image Input" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <Button Content="Single Image" Command="{Binding LoadImageCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                                    <Button Content="Batch Load" Command="{Binding LoadMultipleImagesCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                                </StackPanel>
                                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="8" Visibility="{Binding HasSourceImage, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <StackPanel>
                                        <Image Source="{Binding SourceImageSource}" MaxHeight="80" Stretch="Uniform" Margin="0,0,0,4"/>
                                        <TextBlock Text="{Binding SourceImageInfo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" FontFamily="Consolas" FontSize="10"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Expander>

                        <!-- Upscaling Parameters -->
                        <Expander Header="⚙️ Upscaling Parameters" IsExpanded="True" Margin="0,0,0,12">
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="12" Margin="0,8,0,0">
                                <StackPanel>
                                    <!-- Scale Factor -->
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="70"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="50"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Scale:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding ScaleFactor}" Minimum="1.0" Maximum="16.0" TickFrequency="0.1" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding ScaleFactor, UpdateSourceTrigger=PropertyChanged, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>

                                    <!-- Model -->
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="70"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Model:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <ComboBox Grid.Column="1" ItemsSource="{Binding AvailableModels}" SelectedItem="{Binding SelectedModel}" Style="{DynamicResource DarkComboBoxStyle}" Margin="4,0,0,0"/>
                                    </Grid>

                                    <!-- Tile Size -->
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="70"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="50"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Tile Size:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding TileSize}" Minimum="128" Maximum="2048" TickFrequency="128" IsSnapToTickEnabled="True" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding TileSize}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>

                                    <!-- Tile Overlap -->
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="70"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="50"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Overlap:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding TileOverlap}" Minimum="8" Maximum="256" TickFrequency="8" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding TileOverlap}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Expander>

                        <!-- Post-Processing -->
                        <Expander Header="🎨 Post-Processing" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <CheckBox Content="Face Enhancement" IsChecked="{Binding EnableFaceEnhancement}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,8"/>
                                
                                <CheckBox Content="Denoising" IsChecked="{Binding EnableDenoising}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,4"/>
                                <Grid Margin="0,0,0,8" Visibility="{Binding EnableDenoising, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Value="{Binding DenoisingStrength}" Minimum="0" Maximum="1" TickFrequency="0.1"/>
                                    <TextBox Grid.Column="1" Text="{Binding DenoisingStrength, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" Margin="4,0,0,0"/>
                                </Grid>

                                <CheckBox Content="Sharpening" IsChecked="{Binding EnableSharpening}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,4"/>
                                <Grid Visibility="{Binding EnableSharpening, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Value="{Binding SharpeningAmount}" Minimum="0" Maximum="1" TickFrequency="0.1"/>
                                    <TextBox Grid.Column="1" Text="{Binding SharpeningAmount, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" Margin="4,0,0,0"/>
                                </Grid>
                            </StackPanel>
                        </Expander>

                        <!-- Batch Settings -->
                        <Expander Header="🔄 Batch Processing" IsExpanded="False" Margin="0,0,0,16">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Naming Pattern" Margin="0,0,0,4" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <TextBox Text="{Binding CustomNamingPattern}" Style="{DynamicResource DarkTextBoxStyle}" FontFamily="Consolas" Margin="0,0,0,8"/>
                                <TextBlock Text="Variables: {name}, {scale}, {model}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" FontSize="9"/>
                            </StackPanel>
                        </Expander>

                        <!-- Generate Button -->
                        <Button Content="🔍 Upscale" Command="{Binding UpscaleCommand}" Style="{DynamicResource PrimaryButtonStyle}" Padding="0,12" FontWeight="SemiBold" IsEnabled="{Binding CanUpscale}"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- Center Panel: Comparison & Monitoring -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="100"/>
                    </Grid.RowDefinitions>

                    <!-- Before/After Comparison -->
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Original -->
                        <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" Margin="0,0,8,0">
                            <Grid>
                                <Image Source="{Binding SourceImageSource}" Stretch="Uniform" Visibility="{Binding HasSourceImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasSourceImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                    <TextBlock Text="📷" FontSize="48" HorizontalAlignment="Center" Opacity="0.3"/>
                                    <TextBlock Text="Original Image" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock Text="ORIGINAL" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="8" FontWeight="SemiBold"/>
                            </Grid>
                        </Border>

                        <!-- Upscaled -->
                        <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" Margin="8,0,0,0">
                            <Grid>
                                <Image Source="{Binding UpscaledImageSource}" Stretch="Uniform" Visibility="{Binding HasUpscaledImage, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasUpscaledImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                    <TextBlock Text="✨" FontSize="48" HorizontalAlignment="Center" Opacity="0.3"/>
                                    <TextBlock Text="Upscaled Result" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                </StackPanel>
                                
                                <!-- Progress Overlay -->
                                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding IsUpscaling, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <StackPanel>
                                        <TextBlock Text="Processing..." Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,0,0,6"/>
                                        <ProgressBar Value="{Binding UpscalingProgress}" Height="4" Width="150" Background="{DynamicResource TertiaryDarkBrush}" Foreground="{DynamicResource AccentRedBrush}"/>
                                    </StackPanel>
                                </Border>
                                <TextBlock Text="UPSCALED" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="8" FontWeight="SemiBold"/>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Performance Monitor -->
                    <Border Grid.Row="1" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,8,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Memory Usage" Style="{DynamicResource CaptionTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"/>
                                <TextBlock Text="{Binding MemoryUsageText}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontFamily="Consolas"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                <TextBlock Text="GPU Utilization" Style="{DynamicResource CaptionTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"/>
                                <TextBlock Text="{Binding GpuUtilizationText}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontFamily="Consolas"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="2" HorizontalAlignment="Right">
                                <TextBlock Text="Processing Status" Style="{DynamicResource CaptionTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"/>
                                <TextBlock Text="{Binding UpscalingStatus}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontFamily="Consolas" FontSize="9" TextTrimming="CharacterEllipsis"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </Border>

            <!-- Right Panel: Advanced Tools & Analytics -->
            <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="0,8,8,0" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔬 Advanced Tools" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Custom Model Loading -->
                        <Expander Header="🧠 Custom Models" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="📥 Load Custom Model" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                                <TextBlock Text="Model Performance" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Speed:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                        <TextBlock Text="Fast" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource SuccessBrush}"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Quality:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                        <TextBlock Text="High" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Expander>

                        <!-- Batch Operations -->
                        <Expander Header="🔄 Batch Operations" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="🚀 Batch Upscale" Command="{Binding BatchUpscaleCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                                <Button Content="📊 Performance Report" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                                <TextBlock Text="Queue Status" Style="{DynamicResource CaptionTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"/>
                                <TextBlock Text="{Binding ProcessingQueue.Count, StringFormat='{}{0} images in queue'}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </Expander>

                        <!-- Analytics -->
                        <Expander Header="📊 Analytics" IsExpanded="False" Margin="0,0,0,16">
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="8" Margin="0,8,0,0">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Total:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="{Binding UpscalingHistory.Count}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="Avg Time:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="2.3s" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}"/>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Expander>

                        <!-- Quick Actions -->
                        <StackPanel>
                            <Button Content="📤 Export Settings" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                            <Button Content="📥 Import Settings" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                            <Button Content="🗑️ Clear All" Command="{Binding ClearHistoryCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </DataTemplate>

    <!-- Text2Video View - Developer Mode -->
    <DataTemplate x:Key="DeveloperText2VideoViewModelTemplate">
        <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="380"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel: Advanced Controls -->
            <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8,0,0,8" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔧 Advanced Video Generation" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Prompt Engineering -->
                        <Expander Header="📝 Prompt Engineering" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <TextBox Text="{Binding Prompt, UpdateSourceTrigger=PropertyChanged}" TextWrapping="Wrap" AcceptsReturn="True" MinHeight="80" Style="{DynamicResource DarkTextBoxStyle}" Margin="0,0,0,8"/>
                                <TextBlock Text="Negative Prompt" Style="{DynamicResource CaptionTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                                <TextBox Text="{Binding NegativePrompt, UpdateSourceTrigger=PropertyChanged}" TextWrapping="Wrap" AcceptsReturn="True" MinHeight="60" Style="{DynamicResource DarkTextBoxStyle}"/>
                            </StackPanel>
                        </Expander>

                        <!-- Generation Parameters -->
                        <Expander Header="⚙️ Generation Parameters" IsExpanded="True" Margin="0,0,0,12">
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="12" Margin="0,8,0,0">
                                <StackPanel>
                                    <!-- Steps -->
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="70"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="50"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Steps:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding Steps}" Minimum="10" Maximum="50" TickFrequency="5" IsSnapToTickEnabled="True" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding Steps}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>

                                    <!-- CFG Scale -->
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="70"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="50"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="CFG:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding CfgScale}" Minimum="1" Maximum="20" TickFrequency="0.5" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding CfgScale, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>

                                    <!-- Model -->
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="70"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Model:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <ComboBox Grid.Column="1" ItemsSource="{Binding AvailableModels}" SelectedItem="{Binding SelectedModel}" Style="{DynamicResource DarkComboBoxStyle}" Margin="4,0,0,0"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Expander>

                        <!-- Video Configuration -->
                        <Expander Header="🎬 Video Configuration" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <!-- Duration & Frame Rate -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0" Margin="0,0,4,0">
                                        <TextBlock Text="Duration (s)" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,2"/>
                                        <TextBox Text="{Binding DurationSeconds, UpdateSourceTrigger=PropertyChanged}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Margin="4,0,0,0">
                                        <TextBlock Text="Frame Rate" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,2"/>
                                        <ComboBox ItemsSource="{Binding FrameRateOptions}" SelectedItem="{Binding FrameRate}" Style="{DynamicResource DarkComboBoxStyle}"/>
                                    </StackPanel>
                                </Grid>

                                <!-- Resolution -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0" Margin="0,0,4,0">
                                        <TextBlock Text="Aspect Ratio" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,2"/>
                                        <ComboBox ItemsSource="{Binding AspectRatios}" SelectedItem="{Binding AspectRatio}" Style="{DynamicResource DarkComboBoxStyle}"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Margin="4,0,0,0">
                                        <TextBlock Text="Resolution" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,2"/>
                                        <TextBox Text="{Binding Resolution}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" IsReadOnly="True"/>
                                    </StackPanel>
                                </Grid>

                                <!-- Style -->
                                <StackPanel>
                                    <TextBlock Text="Style Preset" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,2"/>
                                    <ComboBox ItemsSource="{Binding StylePresets}" SelectedItem="{Binding SelectedStyle}" Style="{DynamicResource DarkComboBoxStyle}"/>
                                </StackPanel>
                            </StackPanel>
                        </Expander>

                        <!-- Motion & Camera Controls -->
                        <Expander Header="🎥 Motion &amp; Camera" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <!-- Motion Strength -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Motion:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <Slider Grid.Column="1" Value="{Binding MotionStrength}" Minimum="0" Maximum="1" TickFrequency="0.05" Margin="4,0"/>
                                    <TextBox Grid.Column="2" Text="{Binding MotionStrength, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                </Grid>

                                <!-- Camera Movement -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Camera:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <ComboBox Grid.Column="1" ItemsSource="{Binding CameraMovements}" SelectedItem="{Binding CameraMovement}" Style="{DynamicResource DarkComboBoxStyle}" Margin="4,0,0,0"/>
                                </Grid>
                            </StackPanel>
                        </Expander>

                        <!-- Seed Control -->
                        <Expander Header="🎲 Seed Control" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <CheckBox Content="Use Random Seed" IsChecked="{Binding UseRandomSeed}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,8"/>
                                <Grid Visibility="{Binding UseRandomSeed, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Text="{Binding Seed}" Style="{DynamicResource DarkTextBoxStyle}" FontFamily="Consolas" Margin="0,0,4,0"/>
                                    <Button Grid.Column="1" Content="🎲" Command="{Binding RandomizeSeedCommand}" Style="{DynamicResource GhostButtonStyle}" Padding="8" ToolTip="Generate Random Seed"/>
                                </Grid>
                            </StackPanel>
                        </Expander>

                        <!-- Batch Processing -->
                        <Expander Header="🔄 Batch Processing" IsExpanded="False" Margin="0,0,0,16">
                            <StackPanel Margin="0,8,0,0">
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Count:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <TextBox Grid.Column="1" Text="{Binding BatchCount}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" Margin="4,0,0,0"/>
                                </Grid>
                                <Button Content="🚀 Batch Generate" Command="{Binding BatchGenerateCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="0,8" IsEnabled="{Binding CanGenerate}"/>
                            </StackPanel>
                        </Expander>

                        <!-- Generate Button -->
                        <Button Content="🎬 Generate Video" Command="{Binding GenerateCommand}" Style="{DynamicResource PrimaryButtonStyle}" Padding="0,12" FontWeight="SemiBold" IsEnabled="{Binding CanGenerate}"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- Center Panel: Video Player & Debug -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="120"/>
                    </Grid.RowDefinitions>

                    <!-- Video Preview -->
                    <Border Grid.Row="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                        <Grid>
                            <!-- Video Player -->
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasGeneratedVideo, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <TextBlock Text="🎬" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12" Foreground="{DynamicResource AccentRedBrush}"/>
                                <TextBlock Text="Video Generated" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                <TextBlock Text="{Binding VideoInfoText}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" FontFamily="Consolas" Margin="0,4,0,0"/>
                            </StackPanel>

                            <!-- Empty State -->
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasGeneratedVideo, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                <TextBlock Text="🎬" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,16" Opacity="0.3"/>
                                <TextBlock Text="Advanced Video Preview" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                <TextBlock Text="Real-time generation monitoring" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                            </StackPanel>

                            <!-- Generation Progress -->
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <StackPanel HorizontalAlignment="Center" MinWidth="350">
                                    <TextBlock Text="🎬 Processing Video..." Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                    <Grid Margin="0,0,0,6">
                                        <ProgressBar Value="{Binding GenerationProgress}" Height="6" Background="{DynamicResource TertiaryDarkBrush}" Foreground="{DynamicResource AccentRedBrush}"/>
                                        <TextBlock Text="{Binding GenerationProgress, StringFormat='{}{0:F1}%'}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold" FontFamily="Consolas"/>
                                    </Grid>
                                    <TextBlock Text="{Binding GenerationStatus}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" FontFamily="Consolas"/>
                                </StackPanel>
                            </Border>

                            <!-- Debug Info Overlay -->
                            <StackPanel VerticalAlignment="Top" HorizontalAlignment="Left" Margin="12" Background="{DynamicResource SecondaryDarkBrush}" Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <Border CornerRadius="4" Padding="8" Background="{DynamicResource TertiaryDarkBrush}">
                                    <StackPanel>
                                        <TextBlock Text="DEBUG INFO" Style="{DynamicResource CaptionTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,4"/>
                                        <TextBlock Text="{Binding EstimatedTimeText, StringFormat='Est. Time: {0}'}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontFamily="Consolas" FontSize="9"/>
                                        <TextBlock Text="{Binding FileSizeText, StringFormat='File Size: {0}'}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontFamily="Consolas" FontSize="9"/>
                                        <TextBlock Text="{Binding TotalFrames, StringFormat='Frames: {0:F0}'}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontFamily="Consolas" FontSize="9"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Advanced Controls -->
                    <StackPanel Grid.Row="1" Margin="0,12,0,0">
                        <!-- Playback Controls -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,8">
                            <Button Content="▶️" Command="{Binding PlayCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="10,6" Margin="0,0,2,0"/>
                            <Button Content="⏸️" Command="{Binding PauseCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="10,6" Margin="0,0,2,0"/>
                            <Button Content="⏹️" Command="{Binding StopCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="10,6" Margin="0,0,8,0"/>
                            <Button Content="📹" Command="{Binding LoadVideoCommand}" Style="{DynamicResource GhostButtonStyle}" Padding="10,6" ToolTip="Load Reference Video"/>
                        </StackPanel>

                        <!-- Timeline with Frame Numbers -->
                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="50"/>
                            </Grid.ColumnDefinitions>
                            <TextBox Grid.Column="0" Text="{Binding CurrentFrame, StringFormat=F0}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" FontFamily="Consolas" FontSize="10" Margin="0,0,4,0"/>
                            <Slider Grid.Column="1" Value="{Binding CurrentFrame}" Maximum="{Binding TotalFrames}" TickFrequency="1" IsSnapToTickEnabled="True" Height="20"/>
                            <TextBox Grid.Column="2" Text="{Binding TotalFrames, StringFormat=F0}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" FontFamily="Consolas" FontSize="10" Margin="4,0,0,0" IsReadOnly="True"/>
                        </Grid>

                        <!-- Export Options -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Visibility="{Binding HasGeneratedVideo, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <ComboBox ItemsSource="{Binding ExportFormats}" SelectedItem="{Binding ExportFormat}" Style="{DynamicResource DarkComboBoxStyle}" Width="80" Margin="0,0,4,0"/>
                            <ComboBox ItemsSource="{Binding ExportQualities}" SelectedItem="{Binding ExportQuality}" Style="{DynamicResource DarkComboBoxStyle}" Width="80" Margin="0,0,4,0"/>
                            <Button Content="💾 Save" Command="{Binding SaveCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,2,0"/>
                            <Button Content="📤 Export" Command="{Binding ExportCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Debug Console -->
                    <Border Grid.Row="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,8,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Text="🔍 Debug Console" Style="{DynamicResource CaptionTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,6"/>
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                <TextBlock Text="{Binding GenerationStatus}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontFamily="Consolas" FontSize="10" TextWrapping="Wrap"/>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                </Grid>
            </Border>

            <!-- Right Panel: Advanced Tools & Analytics -->
            <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="0,8,8,0" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔬 Advanced Tools" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Custom Models -->
                        <Expander Header="🧠 Custom Models" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="📥 Load Custom Model" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                                <TextBlock Text="Model Performance" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Speed:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                        <TextBlock Text="Fast" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource SuccessBrush}"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Quality:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                        <TextBlock Text="High" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Expander>

                        <!-- Generation Queue -->
                        <Expander Header="🔄 Generation Queue" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="📋 View Queue" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                                <Button Content="🗑️ Clear Queue" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                                <TextBlock Text="Queue Status" Style="{DynamicResource CaptionTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"/>
                                <TextBlock Text="{Binding GenerationQueue.Count, StringFormat='{}{0} items in queue'}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </Expander>

                        <!-- Analytics -->
                        <Expander Header="📊 Analytics" IsExpanded="False" Margin="0,0,0,16">
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="8" Margin="0,8,0,0">
                                <StackPanel>
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Total:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="{Binding GenerationHistory.Count}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontFamily="Consolas"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="Avg Time:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="45s" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontFamily="Consolas"/>
                                        </StackPanel>
                                    </Grid>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Success:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="98%" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource SuccessBrush}" FontFamily="Consolas"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="Total Size:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="2.3 GB" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontFamily="Consolas"/>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Expander>

                        <!-- Quick Actions -->
                        <StackPanel>
                            <Button Content="📤 Export Settings" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                            <Button Content="📥 Import Settings" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                            <Button Content="🗑️ Clear All" Command="{Binding ClearHistoryCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </DataTemplate>

    <!-- Video2Video View - Developer Mode -->
    <DataTemplate x:Key="DeveloperVideo2VideoViewModelTemplate">
        <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="380"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel: Advanced Controls -->
            <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8,0,0,8" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔧 Advanced Video Transformation" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Video Input -->
                        <Expander Header="📹 Video Input" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <Button Content="Single Video" Command="{Binding LoadVideoCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                                    <Button Content="Batch Load" Command="{Binding LoadMultipleVideosCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                                </StackPanel>
                                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="8" Visibility="{Binding HasSourceVideo, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <StackPanel>
                                        <TextBlock Text="🎞️" FontSize="16" HorizontalAlignment="Center" Margin="0,0,0,4" Foreground="{DynamicResource AccentRedBrush}"/>
                                        <TextBlock Text="{Binding SourceVideoInfo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" FontFamily="Consolas" FontSize="10"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Expander>

                        <!-- Transformation Parameters -->
                        <Expander Header="⚙️ Transformation Parameters" IsExpanded="True" Margin="0,0,0,12">
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="12" Margin="0,8,0,0">
                                <StackPanel>
                                    <TextBox Text="{Binding Prompt, UpdateSourceTrigger=PropertyChanged}" TextWrapping="Wrap" AcceptsReturn="True" MinHeight="60" Style="{DynamicResource DarkTextBoxStyle}" Margin="0,0,0,8"/>
                                    <TextBox Text="{Binding NegativePrompt, UpdateSourceTrigger=PropertyChanged}" TextWrapping="Wrap" AcceptsReturn="True" MinHeight="40" Style="{DynamicResource DarkTextBoxStyle}"/>
                                </StackPanel>
                            </Border>
                        </Expander>

                        <!-- Advanced Settings -->
                        <Expander Header="🎛️ Advanced Settings" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <!-- Strength -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Strength:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <Slider Grid.Column="1" Value="{Binding Strength}" Minimum="0.1" Maximum="2.0" TickFrequency="0.05" Margin="4,0"/>
                                    <TextBox Grid.Column="2" Text="{Binding Strength, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                </Grid>

                                <!-- Denoising -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Denoising:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <Slider Grid.Column="1" Value="{Binding DenoisingStrength}" Minimum="0" Maximum="1" TickFrequency="0.05" Margin="4,0"/>
                                    <TextBox Grid.Column="2" Text="{Binding DenoisingStrength, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                </Grid>

                                <!-- Guidance -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Guidance:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <Slider Grid.Column="1" Value="{Binding GuidanceScale}" Minimum="1" Maximum="20" TickFrequency="0.5" Margin="4,0"/>
                                    <TextBox Grid.Column="2" Text="{Binding GuidanceScale, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                </Grid>

                                <!-- Steps -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Steps:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <Slider Grid.Column="1" Value="{Binding Steps}" Minimum="10" Maximum="50" TickFrequency="5" IsSnapToTickEnabled="True" Margin="4,0"/>
                                    <TextBox Grid.Column="2" Text="{Binding Steps}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                </Grid>
                            </StackPanel>
                        </Expander>

                        <!-- Temporal Consistency -->
                        <Expander Header="⏱️ Temporal Consistency" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <CheckBox Content="Maintain Temporal Consistency" IsChecked="{Binding MaintainTemporalConsistency}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,8"/>
                                <Grid Visibility="{Binding MaintainTemporalConsistency, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Temporal:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <Slider Grid.Column="1" Value="{Binding TemporalConsistencyStrength}" Minimum="0" Maximum="1" TickFrequency="0.05" Margin="4,0"/>
                                    <TextBox Grid.Column="2" Text="{Binding TemporalConsistencyStrength, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                </Grid>
                            </StackPanel>
                        </Expander>

                        <!-- Model & Style -->
                        <Expander Header="🧠 Model &amp; Style" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <ComboBox ItemsSource="{Binding AvailableModels}" SelectedItem="{Binding SelectedModel}" Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8"/>
                                <ComboBox ItemsSource="{Binding StylePresets}" SelectedItem="{Binding SelectedStyle}" Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8"/>
                                <ComboBox ItemsSource="{Binding StyleTransferModes}" SelectedItem="{Binding StyleTransferMode}" Style="{DynamicResource DarkComboBoxStyle}"/>
                            </StackPanel>
                        </Expander>

                        <!-- Seed Control -->
                        <Expander Header="🎲 Seed Control" IsExpanded="False" Margin="0,0,0,16">
                            <StackPanel Margin="0,8,0,0">
                                <CheckBox Content="Use Random Seed" IsChecked="{Binding UseRandomSeed}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,8"/>
                                <Grid Visibility="{Binding UseRandomSeed, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Text="{Binding Seed}" Style="{DynamicResource DarkTextBoxStyle}" FontFamily="Consolas" Margin="0,0,4,0"/>
                                    <Button Grid.Column="1" Content="🎲" Command="{Binding RandomizeSeedCommand}" Style="{DynamicResource GhostButtonStyle}" Padding="8"/>
                                </Grid>
                            </StackPanel>
                        </Expander>

                        <!-- Process Button -->
                        <Button Content="🎞️ Transform Video" Command="{Binding ProcessVideoCommand}" Style="{DynamicResource PrimaryButtonStyle}" Padding="0,12" FontWeight="SemiBold" IsEnabled="{Binding CanProcess}"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- Center Panel: Video Comparison & Debug -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="100"/>
                    </Grid.RowDefinitions>

                    <!-- Video Comparison -->
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Source Video -->
                        <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" Margin="0,0,8,0">
                            <Grid>
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasSourceVideo, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <TextBlock Text="📹" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8" Foreground="{DynamicResource AccentRedBrush}"/>
                                    <TextBlock Text="Source Video" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                    <Button Content="▶️ Play" Command="{Binding PlaySourceCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,8,0,0"/>
                                </StackPanel>
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasSourceVideo, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                    <TextBlock Text="📹" FontSize="48" HorizontalAlignment="Center" Opacity="0.3"/>
                                    <TextBlock Text="Source Video" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock Text="SOURCE" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="8" FontWeight="SemiBold"/>
                            </Grid>
                        </Border>

                        <!-- Transformed Video -->
                        <Border Grid.Column="1" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" Margin="8,0,0,0">
                            <Grid>
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasOutputVideo, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <TextBlock Text="✨" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8" Foreground="{DynamicResource AccentRedBrush}"/>
                                    <TextBlock Text="Transformed" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                    <Button Content="▶️ Play" Command="{Binding PlayOutputCommand}" Style="{DynamicResource PrimaryButtonStyle}" Margin="0,8,0,0"/>
                                </StackPanel>
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasOutputVideo, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                    <TextBlock Text="✨" FontSize="48" HorizontalAlignment="Center" Opacity="0.3"/>
                                    <TextBlock Text="Transformed Result" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                </StackPanel>
                                
                                <!-- Progress Overlay -->
                                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding IsProcessing, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <StackPanel>
                                        <TextBlock Text="Processing..." Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,0,0,6"/>
                                        <ProgressBar Value="{Binding ProcessingProgress}" Height="4" Width="150" Background="{DynamicResource TertiaryDarkBrush}" Foreground="{DynamicResource AccentRedBrush}"/>
                                    </StackPanel>
                                </Border>
                                <TextBlock Text="TRANSFORMED" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="8" FontWeight="SemiBold"/>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Video Controls -->
                    <StackPanel Grid.Row="1" Margin="0,12,0,0">
                        <!-- Playback Controls -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,8">
                            <Button Content="▶️" Command="{Binding PlaySourceCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="10,6" Margin="0,0,2,0"/>
                            <Button Content="⏸️" Command="{Binding PauseCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="10,6" Margin="0,0,2,0"/>
                            <Button Content="⏹️" Command="{Binding StopCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="10,6" Margin="0,0,8,0"/>
                            <Button Content="⚖️" Command="{Binding CompareCommand}" Style="{DynamicResource GhostButtonStyle}" Padding="10,6" ToolTip="Compare Videos"/>
                        </StackPanel>

                        <!-- Timeline with Frame Numbers -->
                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="50"/>
                            </Grid.ColumnDefinitions>
                            <TextBox Grid.Column="0" Text="{Binding CurrentFrame, StringFormat=F0}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" FontFamily="Consolas" FontSize="10" Margin="0,0,4,0"/>
                            <Slider Grid.Column="1" Value="{Binding CurrentFrame}" Maximum="{Binding TotalFrames}" TickFrequency="1" IsSnapToTickEnabled="True" Height="20"/>
                            <TextBox Grid.Column="2" Text="{Binding TotalFrames, StringFormat=F0}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" FontFamily="Consolas" FontSize="10" Margin="4,0,0,0" IsReadOnly="True"/>
                        </Grid>

                        <!-- Export Options -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Visibility="{Binding HasOutputVideo, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <ComboBox ItemsSource="{Binding ExportFormats}" SelectedItem="{Binding ExportFormat}" Style="{DynamicResource DarkComboBoxStyle}" Width="80" Margin="0,0,4,0"/>
                            <ComboBox ItemsSource="{Binding ExportQualities}" SelectedItem="{Binding ExportQuality}" Style="{DynamicResource DarkComboBoxStyle}" Width="80" Margin="0,0,4,0"/>
                            <Button Content="💾 Save" Command="{Binding SaveCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,2,0"/>
                            <Button Content="📤 Export" Command="{Binding ExportCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Debug Console -->
                    <Border Grid.Row="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,8,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Text="🔍 Processing Log" Style="{DynamicResource CaptionTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,6"/>
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                <TextBlock Text="{Binding ProcessingStatus}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontFamily="Consolas" FontSize="10" TextWrapping="Wrap"/>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                </Grid>
            </Border>

            <!-- Right Panel: Advanced Tools -->
            <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="0,8,8,0" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔬 Advanced Tools" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Custom Models -->
                        <Expander Header="🧠 Custom Models" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="📥 Load Custom Model" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                                <TextBlock Text="Model Performance" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Speed:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                        <TextBlock Text="Fast" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource SuccessBrush}"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Quality:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                        <TextBlock Text="High" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Expander>

                        <!-- Batch Operations -->
                        <Expander Header="🔄 Batch Operations" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="🚀 Batch Process" Command="{Binding BatchProcessCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                                <Button Content="📊 Performance Report" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                                <TextBlock Text="Queue Status" Style="{DynamicResource CaptionTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"/>
                                <TextBlock Text="{Binding ProcessingQueue.Count, StringFormat='{}{0} videos in queue'}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </Expander>

                        <!-- Analytics -->
                        <Expander Header="📊 Analytics" IsExpanded="False" Margin="0,0,0,16">
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="8" Margin="0,8,0,0">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Total:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="{Binding TransformationHistory.Count}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontFamily="Consolas"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="Avg Time:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="2.1m" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontFamily="Consolas"/>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Expander>

                        <!-- Quick Actions -->
                        <StackPanel>
                            <Button Content="📤 Export Settings" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                            <Button Content="📥 Import Settings" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                            <Button Content="🗑️ Clear All" Command="{Binding ClearHistoryCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </DataTemplate>

    <!-- MotionControl View - Developer Mode -->
    <DataTemplate x:Key="DeveloperMotionControlViewModelTemplate">
        <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="380"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel: Advanced Controls -->
            <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8,0,0,8" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔧 Advanced Motion Control" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Video Input -->
                        <Expander Header="📹 Video Input" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="Load Video" Command="{Binding LoadVideoCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="8" Visibility="{Binding HasSourceVideo, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <TextBlock Text="Video loaded for motion analysis" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                                </Border>
                            </StackPanel>
                        </Expander>

                        <!-- Motion Parameters -->
                        <Expander Header="🎥 Motion Parameters" IsExpanded="True" Margin="0,0,0,12">
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="12" Margin="0,8,0,0">
                                <StackPanel>
                                    <!-- Pan Controls -->
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="50"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Pan X:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding PanX}" Minimum="-5" Maximum="5" TickFrequency="0.01" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding PanX, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>

                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="50"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Pan Y:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding PanY}" Minimum="-5" Maximum="5" TickFrequency="0.01" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding PanY, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>

                                    <!-- Zoom & Rotation -->
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="50"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Zoom:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding Zoom}" Minimum="0.1" Maximum="10.0" TickFrequency="0.01" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding Zoom, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>

                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="50"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Rotate:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <Slider Grid.Column="1" Value="{Binding Rotation}" Minimum="-360" Maximum="360" TickFrequency="1" Margin="4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding Rotation, StringFormat=F0}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Expander>

                        <!-- Advanced Settings -->
                        <Expander Header="⚙️ Advanced Settings" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <CheckBox Content="Enable Object Tracking" IsChecked="{Binding EnableObjectTracking}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,8"/>
                                <CheckBox Content="Physics Simulation" IsChecked="{Binding EnablePhysicsSimulation}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,8"/>
                                
                                <!-- Motion Blur -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="60"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Blur:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <Slider Grid.Column="1" Value="{Binding MotionBlur}" Minimum="0" Maximum="2" TickFrequency="0.01" Margin="4,0"/>
                                    <TextBox Grid.Column="2" Text="{Binding MotionBlur, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                </Grid>

                                <!-- Smoothing -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="60"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Smooth:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <Slider Grid.Column="1" Value="{Binding MotionSmoothing}" Minimum="0" Maximum="1" TickFrequency="0.01" Margin="4,0"/>
                                    <TextBox Grid.Column="2" Text="{Binding MotionSmoothing, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                </Grid>
                            </StackPanel>
                        </Expander>

                        <!-- Path Type -->
                        <Expander Header="📐 Motion Path" IsExpanded="False" Margin="0,0,0,16">
                            <StackPanel Margin="0,8,0,0">
                                <ComboBox ItemsSource="{Binding MotionPathTypes}" SelectedItem="{Binding MotionPathType}" Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8"/>
                                <Button Content="🔄 Generate Path" Command="{Binding GenerateMotionPathCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                            </StackPanel>
                        </Expander>

                        <!-- Apply Motion Button -->
                        <Button Content="🎥 Apply Motion" Command="{Binding ApplyMotionCommand}" Style="{DynamicResource PrimaryButtonStyle}" Padding="0,12" FontWeight="SemiBold" IsEnabled="{Binding CanApplyMotion}"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- Center Panel: Motion Visualization -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Motion Canvas -->
                    <Border Grid.Row="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                        <Grid>
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasMotionPath, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <TextBlock Text="🎥" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12" Foreground="{DynamicResource AccentRedBrush}"/>
                                <TextBlock Text="Advanced Motion Path" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                <TextBlock Text="{Binding MotionSummary}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" FontFamily="Consolas" Margin="0,4,0,0"/>
                            </StackPanel>

                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasMotionPath, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                <TextBlock Text="🎥" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,16" Opacity="0.3"/>
                                <TextBlock Text="Advanced Motion Canvas" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                            </StackPanel>

                            <!-- Processing Progress -->
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding IsProcessing, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <StackPanel>
                                    <TextBlock Text="Processing..." Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,0,0,6"/>
                                    <ProgressBar Value="{Binding ProcessingProgress}" Height="4" Width="150" Background="{DynamicResource TertiaryDarkBrush}" Foreground="{DynamicResource AccentRedBrush}"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Border>

                    <!-- Timeline Controls -->
                    <StackPanel Grid.Row="1" Margin="0,12,0,0">
                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="50"/>
                            </Grid.ColumnDefinitions>
                            <TextBox Grid.Column="0" Text="{Binding TimelinePosition, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" FontFamily="Consolas" FontSize="10" Margin="0,0,4,0"/>
                            <Slider Grid.Column="1" Value="{Binding TimelinePosition}" Maximum="{Binding TimelineDuration}" TickFrequency="0.1" Height="20"/>
                            <TextBox Grid.Column="2" Text="{Binding TimelineDuration, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" FontFamily="Consolas" FontSize="10" Margin="4,0,0,0" IsReadOnly="True"/>
                        </Grid>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <Button Content="🎯 Keyframe" Command="{Binding AddKeyframeCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,2,0"/>
                            <Button Content="👁️ Preview" Command="{Binding PreviewMotionCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,2,0"/>
                            <Button Content="💾 Save Preset" Command="{Binding SaveMotionPresetCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,2,0"/>
                            <Button Content="🔄 Reset" Command="{Binding ResetMotionCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Right Panel: Advanced Tools -->
            <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="0,8,8,0" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔬 Advanced Tools" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Keyframe Management -->
                        <Expander Header="🎯 Keyframes" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="{Binding KeyframeCount, StringFormat='Keyframes: {0}'}" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                <ScrollViewer MaxHeight="150" VerticalScrollBarVisibility="Auto">
                                    <ItemsControl ItemsSource="{Binding MotionKeyframes}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="6" Margin="0,0,0,2">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <StackPanel Grid.Column="0">
                                                            <TextBlock Text="{Binding TimeText}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontWeight="SemiBold" FontFamily="Consolas"/>
                                                            <TextBlock Text="{Binding ParametersText}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontSize="9" FontFamily="Consolas"/>
                                                        </StackPanel>
                                                        <Button Grid.Column="1" Content="🗑️" Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.RemoveKeyframeCommand}" CommandParameter="{Binding}" Style="{DynamicResource GhostButtonStyle}" Padding="2"/>
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </StackPanel>
                        </Expander>

                        <!-- Tracking Points -->
                        <Expander Header="📍 Tracking" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <CheckBox Content="Show Motion Vectors" IsChecked="{Binding ShowMotionVectors}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,4"/>
                                <CheckBox Content="Show Tracking Points" IsChecked="{Binding ShowTrackingPoints}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,8"/>
                                <TextBlock Text="{Binding TrackingPoints.Count, StringFormat='Tracking Points: {0}'}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontFamily="Consolas"/>
                            </StackPanel>
                        </Expander>

                        <!-- Physics -->
                        <Expander Header="🌍 Physics" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <CheckBox Content="Enable Physics" IsChecked="{Binding EnablePhysicsSimulation}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,8"/>
                                <Grid Margin="0,0,0,4" Visibility="{Binding EnablePhysicsSimulation, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Gravity:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <Slider Grid.Column="1" Value="{Binding GravityStrength}" Minimum="0" Maximum="20" TickFrequency="0.1" Margin="4,0"/>
                                    <TextBox Grid.Column="2" Text="{Binding GravityStrength, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                </Grid>
                                <CheckBox Content="Collision Detection" IsChecked="{Binding EnableCollisionDetection}" Style="{DynamicResource DarkCheckBoxStyle}"/>
                            </StackPanel>
                        </Expander>

                        <!-- Quick Actions -->
                        <StackPanel>
                            <Button Content="📤 Export Motion" Command="{Binding ExportMotionDataCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                            <Button Content="📥 Import Motion" Command="{Binding ImportMotionDataCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </DataTemplate>

    <!-- TemporalEffects View - Developer Mode -->
    <DataTemplate x:Key="DeveloperTemporalEffectsViewModelTemplate">
        <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="380"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel: Advanced Controls -->
            <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8,0,0,8" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔧 Advanced Temporal Effects" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Video Input -->
                        <Expander Header="📹 Video Input" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="Load Video" Command="{Binding LoadVideoCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                            </StackPanel>
                        </Expander>

                        <!-- Effect Configuration -->
                        <Expander Header="⚙️ Effect Configuration" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <ComboBox ItemsSource="{Binding AvailableEffects}" SelectedItem="{Binding SelectedEffect}" Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8"/>
                                
                                <!-- Speed Controls -->
                                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="8" Margin="0,0,0,8" Visibility="{Binding IsSpeedChangeSelected, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,4">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="50"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="40"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="Speed:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                            <Slider Grid.Column="1" Value="{Binding SpeedMultiplier}" Minimum="0.01" Maximum="16.0" TickFrequency="0.01" Margin="4,0"/>
                                            <TextBox Grid.Column="2" Text="{Binding SpeedMultiplier, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                        </Grid>
                                        <CheckBox Content="Preserve Duration" IsChecked="{Binding PreserveOriginalDuration}" Style="{DynamicResource DarkCheckBoxStyle}"/>
                                    </StackPanel>
                                </Border>

                                <!-- Frame Interpolation -->
                                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="8" Margin="0,0,0,8" Visibility="{Binding IsFrameInterpolationSelected, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,4">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="50"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="40"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="FPS:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                            <Slider Grid.Column="1" Value="{Binding TargetFrameRate}" Minimum="12" Maximum="240" TickFrequency="1" IsSnapToTickEnabled="True" Margin="4,0"/>
                                            <TextBox Grid.Column="2" Text="{Binding TargetFrameRate}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                        </Grid>
                                        <ComboBox ItemsSource="{Binding InterpolationMethods}" SelectedItem="{Binding InterpolationMethod}" Style="{DynamicResource DarkComboBoxStyle}"/>
                                    </StackPanel>
                                </Border>

                                <!-- Color Grading -->
                                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="8" Visibility="{Binding IsColorGradingSelected, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <StackPanel>
                                        <ComboBox ItemsSource="{Binding ColorGradingPresets}" SelectedItem="{Binding ColorGrading}" Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,4"/>
                                        <Grid Margin="0,0,0,2">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="50"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="40"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="Sat:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                            <Slider Grid.Column="1" Value="{Binding Saturation}" Minimum="0" Maximum="2" TickFrequency="0.01" Margin="4,0"/>
                                            <TextBox Grid.Column="2" Text="{Binding Saturation, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                        </Grid>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="50"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="40"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="Bright:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                            <Slider Grid.Column="1" Value="{Binding Brightness}" Minimum="-1" Maximum="1" TickFrequency="0.01" Margin="4,0"/>
                                            <TextBox Grid.Column="2" Text="{Binding Brightness, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                        </Grid>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Expander>

                        <!-- Processing Priority -->
                        <Expander Header="⚡ Processing" IsExpanded="False" Margin="0,0,0,16">
                            <StackPanel Margin="0,8,0,0">
                                <ComboBox ItemsSource="{Binding ProcessingPriorities}" SelectedItem="{Binding ProcessingPriority}" Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8"/>
                                <CheckBox Content="Enable Temporal Filtering" IsChecked="{Binding EnableTemporalFiltering}" Style="{DynamicResource DarkCheckBoxStyle}"/>
                            </StackPanel>
                        </Expander>

                        <!-- Apply Effect Button -->
                        <Button Content="⏱️ Apply Effect" Command="{Binding ApplyEffectCommand}" Style="{DynamicResource PrimaryButtonStyle}" Padding="0,12" FontWeight="SemiBold" IsEnabled="{Binding CanApplyEffect}"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- Center Panel: Timeline Editor -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="100"/>
                    </Grid.RowDefinitions>

                    <!-- Effect Preview -->
                    <Border Grid.Row="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                        <Grid>
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasPreview, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <TextBlock Text="⏱️" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12" Foreground="{DynamicResource AccentRedBrush}"/>
                                <TextBlock Text="Advanced Temporal Effect" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                <TextBlock Text="{Binding SpeedText}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" FontFamily="Consolas" Margin="0,4,0,0"/>
                            </StackPanel>

                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasPreview, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                <TextBlock Text="⏱️" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,16" Opacity="0.3"/>
                                <TextBlock Text="Advanced Timeline Editor" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                            </StackPanel>

                            <!-- Processing Progress -->
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding IsProcessing, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <StackPanel>
                                    <TextBlock Text="Processing..." Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,0,0,6"/>
                                    <ProgressBar Value="{Binding ProcessingProgress}" Height="4" Width="150" Background="{DynamicResource TertiaryDarkBrush}" Foreground="{DynamicResource AccentRedBrush}"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Border>

                    <!-- Timeline Controls -->
                    <StackPanel Grid.Row="1" Margin="0,12,0,0">
                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="50"/>
                            </Grid.ColumnDefinitions>
                            <TextBox Grid.Column="0" Text="{Binding TimelinePosition, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" FontFamily="Consolas" FontSize="10" Margin="0,0,4,0"/>
                            <Slider Grid.Column="1" Value="{Binding TimelinePosition}" Maximum="{Binding TimelineDuration}" TickFrequency="0.01" Height="20"/>
                            <TextBox Grid.Column="2" Text="{Binding TimelineDuration, StringFormat=F2}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" FontFamily="Consolas" FontSize="10" Margin="4,0,0,0" IsReadOnly="True"/>
                        </Grid>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <Button Content="👁️ Preview" Command="{Binding PreviewEffectCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,2,0"/>
                            <Button Content="📋 Add to Timeline" Command="{Binding AddToTimelineCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,2,0"/>
                            <Button Content="💾 Export" Command="{Binding ExportEffectCommand}" Style="{DynamicResource SecondaryButtonStyle}" IsEnabled="{Binding CanExport}"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Debug Console -->
                    <Border Grid.Row="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,8,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Text="🔍 Processing Log" Style="{DynamicResource CaptionTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,6"/>
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                <TextBlock Text="{Binding ProcessingStatus}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontFamily="Consolas" FontSize="10" TextWrapping="Wrap"/>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                </Grid>
            </Border>

            <!-- Right Panel: Advanced Tools -->
            <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="0,8,8,0" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔬 Advanced Tools" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Timeline Clips -->
                        <Expander Header="🎬 Timeline" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="{Binding TimelineClips.Count, StringFormat='Clips: {0}'}" Style="{DynamicResource BodyTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                <ScrollViewer MaxHeight="120" VerticalScrollBarVisibility="Auto">
                                    <ItemsControl ItemsSource="{Binding TimelineClips}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="6" Margin="0,0,0,2">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <StackPanel Grid.Column="0">
                                                            <TextBlock Text="{Binding Name}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontWeight="SemiBold"/>
                                                            <TextBlock Text="{Binding TimeRange}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontSize="9" FontFamily="Consolas"/>
                                                        </StackPanel>
                                                        <Button Grid.Column="1" Content="🗑️" Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.RemoveFromTimelineCommand}" CommandParameter="{Binding}" Style="{DynamicResource GhostButtonStyle}" Padding="2"/>
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </StackPanel>
                        </Expander>

                        <!-- Templates -->
                        <Expander Header="📋 Templates" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="💾 Save Template" Command="{Binding SaveTemplateCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                                <ScrollViewer MaxHeight="100" VerticalScrollBarVisibility="Auto">
                                    <ItemsControl ItemsSource="{Binding EffectTemplates}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Button Content="{Binding Name}" Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.LoadTemplateCommand}" CommandParameter="{Binding}" Style="{DynamicResource GhostButtonStyle}" Padding="4" Margin="0,0,0,2" HorizontalContentAlignment="Left"/>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </StackPanel>
                        </Expander>

                        <!-- Analytics -->
                        <Expander Header="📊 Analytics" IsExpanded="False" Margin="0,0,0,16">
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="8" Margin="0,8,0,0">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Total:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="{Binding EffectHistory.Count}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontFamily="Consolas"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="Avg Time:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="1.2m" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontFamily="Consolas"/>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Expander>

                        <!-- Quick Actions -->
                        <StackPanel>
                            <Button Content="📤 Export Settings" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                            <Button Content="📥 Import Settings" Style="{DynamicResource SecondaryButtonStyle}"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </DataTemplate>

    <!-- ThreeDModels View - Developer Mode -->
    <DataTemplate x:Key="DeveloperThreeDModelsViewModelTemplate">
        <Grid Background="{DynamicResource SecondaryDarkBrush}" Margin="12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="320"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel: Model Library & Tools -->
            <Border Grid.Column="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8,0,0,8" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔧 Advanced 3D Tools" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Model Library -->
                        <Expander Header="📚 Model Library" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <TextBox Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged}" Style="{DynamicResource DarkTextBoxStyle}" Margin="0,0,0,8"/>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <Button Content="📥 Import" Command="{Binding ImportModelCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,4,0"/>
                                    <Button Content="📥 Batch" Command="{Binding ImportMultipleModelsCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                                </StackPanel>
                                <ComboBox ItemsSource="{Binding ModelCategories}" SelectedItem="{Binding SelectedCategory}" Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8"/>
                                <ComboBox ItemsSource="{Binding SortOptions}" SelectedItem="{Binding SortOrder}" Style="{DynamicResource DarkComboBoxStyle}"/>
                            </StackPanel>
                        </Expander>

                        <!-- Viewport Settings -->
                        <Expander Header="👁️ Viewport Settings" IsExpanded="True" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <CheckBox Content="Show Wireframe" IsChecked="{Binding ShowWireframe}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,4"/>
                                <CheckBox Content="Show Normals" IsChecked="{Binding ShowNormals}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,4"/>
                                <CheckBox Content="Show Textures" IsChecked="{Binding ShowTextures}" Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,0,0,8"/>
                                
                                <!-- Lighting -->
                                <Grid Margin="0,0,0,4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="60"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Ambient:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <Slider Grid.Column="1" Value="{Binding AmbientLight}" Minimum="0" Maximum="1" TickFrequency="0.1" Margin="4,0"/>
                                    <TextBox Grid.Column="2" Text="{Binding AmbientLight, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                </Grid>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="60"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Direct:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <Slider Grid.Column="1" Value="{Binding DirectionalLight}" Minimum="0" Maximum="2" TickFrequency="0.1" Margin="4,0"/>
                                    <TextBox Grid.Column="2" Text="{Binding DirectionalLight, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center"/>
                                </Grid>
                            </StackPanel>
                        </Expander>

                        <!-- Model Operations -->
                        <Expander Header="🔧 Model Operations" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="✅ Validate Model" Command="{Binding ValidateModelCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4" IsEnabled="{Binding HasSelectedModel}"/>
                                <Button Content="⚡ Optimize Model" Command="{Binding OptimizeModelCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4" IsEnabled="{Binding HasSelectedModel}"/>
                                <Button Content="🔄 Batch Convert" Command="{Binding BatchConvertCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                            </StackPanel>
                        </Expander>

                        <!-- LOD Management -->
                        <Expander Header="📊 LOD Management" IsExpanded="False" Margin="0,0,0,16">
                            <StackPanel Margin="0,8,0,0">
                                <ComboBox ItemsSource="{Binding LodLevels}" SelectedItem="{Binding SelectedLodLevel}" Style="{DynamicResource DarkComboBoxStyle}" Margin="0,0,0,8"/>
                                <TextBlock Text="LOD 0: 100% detail" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,2"/>
                                <TextBlock Text="LOD 1: 75% detail" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,2"/>
                                <TextBlock Text="LOD 2: 50% detail" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </Expander>

                        <!-- Load Model Button -->
                        <Button Content="🎯 Load Model" Command="{Binding LoadModelCommand}" Style="{DynamicResource PrimaryButtonStyle}" Padding="0,12" FontWeight="SemiBold" IsEnabled="{Binding CanLoadModel}"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- Center Panel: 3D Viewport -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" Padding="16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="80"/>
                    </Grid.RowDefinitions>

                    <!-- 3D Viewport -->
                    <Border Grid.Row="0" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                        <Grid>
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasSelectedModel, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <TextBlock Text="🎯" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12" Foreground="{DynamicResource AccentRedBrush}"/>
                                <TextBlock Text="Advanced 3D Viewport" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                <TextBlock Text="{Binding ModelInfoText}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" FontFamily="Consolas" Margin="0,4,0,0"/>
                            </StackPanel>

                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding HasSelectedModel, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                <TextBlock Text="🎯" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,16" Opacity="0.3"/>
                                <TextBlock Text="Advanced 3D Viewport" Style="{DynamicResource HeadingMediumStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                                <TextBlock Text="Professional mesh inspection and editing" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                            </StackPanel>

                            <!-- Loading Progress -->
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="6" Padding="16" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <StackPanel>
                                    <TextBlock Text="Processing..." Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,0,0,6"/>
                                    <TextBlock Text="{Binding LoadingStatus}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" FontFamily="Consolas"/>
                                </StackPanel>
                            </Border>

                            <!-- Debug Info Overlay -->
                            <StackPanel VerticalAlignment="Top" HorizontalAlignment="Left" Margin="12" Background="{DynamicResource SecondaryDarkBrush}" Visibility="{Binding HasSelectedModel, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <Border CornerRadius="4" Padding="8" Background="{DynamicResource TertiaryDarkBrush}">
                                    <StackPanel>
                                        <TextBlock Text="MESH INFO" Style="{DynamicResource CaptionTextStyle}" FontWeight="SemiBold" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,4"/>
                                        <TextBlock Text="{Binding PolyCount, StringFormat='Polygons: {0:N0}'}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontFamily="Consolas" FontSize="9"/>
                                        <TextBlock Text="{Binding VertexCount, StringFormat='Vertices: {0:N0}'}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontFamily="Consolas" FontSize="9"/>
                                        <TextBlock Text="{Binding TextureCount, StringFormat='Textures: {0}'}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontFamily="Consolas" FontSize="9"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Advanced Controls -->
                    <StackPanel Grid.Row="1" Margin="0,12,0,0">
                        <!-- Viewport Controls -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,8">
                            <Button Content="🔄" Command="{Binding ResetViewportCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="8,6" Margin="0,0,2,0"/>
                            <Button Content="🔍" Command="{Binding FitToViewCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="8,6" Margin="0,0,2,0"/>
                            <Button Content="▶️" Command="{Binding PlayAnimationCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="8,6" Margin="0,0,2,0" Visibility="{Binding CanPlayAnimation, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            <Button Content="⏸️" Command="{Binding PauseAnimationCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="8,6" Margin="0,0,2,0" Visibility="{Binding CanPlayAnimation, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            <Button Content="⏹️" Command="{Binding StopAnimationCommand}" Style="{DynamicResource SecondaryButtonStyle}" Padding="8,6" Visibility="{Binding CanPlayAnimation, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                        </StackPanel>

                        <!-- Transform Controls -->
                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="X:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <Slider Grid.Column="1" Value="{Binding ViewportRotationX}" Minimum="-180" Maximum="180" TickFrequency="1" Margin="4,0"/>
                            <TextBlock Grid.Column="2" Text="Y:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <Slider Grid.Column="3" Value="{Binding ViewportRotationY}" Minimum="-180" Maximum="180" TickFrequency="1" Margin="4,0"/>
                            <TextBlock Grid.Column="4" Text="Z:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <Slider Grid.Column="5" Value="{Binding ViewportRotationZ}" Minimum="-180" Maximum="180" TickFrequency="1" Margin="4,0,0,0"/>
                        </Grid>

                        <!-- Export Options -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Visibility="{Binding HasSelectedModel, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <ComboBox ItemsSource="{Binding ExportFormats}" SelectedItem="{Binding ExportFormat}" Style="{DynamicResource DarkComboBoxStyle}" Width="80" Margin="0,0,4,0"/>
                            <ComboBox ItemsSource="{Binding ExportQualities}" SelectedItem="{Binding ExportQuality}" Style="{DynamicResource DarkComboBoxStyle}" Width="80" Margin="0,0,4,0"/>
                            <Button Content="📤 Export" Command="{Binding ExportModelCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Model List -->
                    <Border Grid.Row="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,8,0,0">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <ItemsControl ItemsSource="{Binding FilteredModels}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="6" Margin="0,0,0,2">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="{Binding Name}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextPrimaryBrush}" FontWeight="SemiBold"/>
                                                    <TextBlock Text="{Binding ModelInfo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontSize="9" FontFamily="Consolas"/>
                                                </StackPanel>
                                                <TextBlock Grid.Column="1" Text="{Binding Format}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource AccentRedBrush}" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </Border>

            <!-- Right Panel: Advanced Properties -->
            <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="0,8,8,0" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🔬 Advanced Properties" Style="{DynamicResource HeadingSmallStyle}" Foreground="{DynamicResource AccentRedBrush}" Margin="0,0,0,16"/>

                        <!-- Mesh Analysis -->
                        <Expander Header="📊 Mesh Analysis" IsExpanded="True" Margin="0,0,0,12" Visibility="{Binding HasSelectedModel, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="8" Margin="0,8,0,0">
                                <StackPanel>
                                    <Grid Margin="0,0,0,4">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Polygons:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="{Binding PolyCount:N0}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontFamily="Consolas"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="Vertices:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="{Binding VertexCount:N0}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontFamily="Consolas"/>
                                        </StackPanel>
                                    </Grid>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Textures:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="{Binding TextureCount}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontFamily="Consolas"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="File Size:" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}"/>
                                            <TextBlock Text="{Binding FileSizeText}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontFamily="Consolas"/>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Expander>

                        <!-- Material Editor -->
                        <Expander Header="🎨 Material Editor" IsExpanded="False" Margin="0,0,0,12">
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="➕ Create Material" Command="{Binding CreateMaterialCommand}" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,8"/>
                                <ScrollViewer MaxHeight="150" VerticalScrollBarVisibility="Auto">
                                    <ItemsControl ItemsSource="{Binding AvailableMaterials}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="6" Margin="0,0,0,2">
                                                    <StackPanel>
                                                        <TextBlock Text="{Binding Name}" Style="{DynamicResource BodyTextStyle}" Foreground="{DynamicResource TextPrimaryBrush}" FontWeight="SemiBold"/>
                                                        <TextBlock Text="{Binding MaterialInfo}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontSize="9"/>
                                                    </StackPanel>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </StackPanel>
                        </Expander>

                        <!-- Animation Timeline -->
                        <Expander Header="🎬 Animation Timeline" IsExpanded="False" Margin="0,0,0,12" Visibility="{Binding CanPlayAnimation, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <StackPanel Margin="0,8,0,0">
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Grid.Column="0" Text="{Binding AnimationProgress, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" FontFamily="Consolas" FontSize="10" Margin="0,0,4,0"/>
                                    <Slider Grid.Column="1" Value="{Binding AnimationProgress}" Maximum="{Binding AnimationDuration}" TickFrequency="0.1"/>
                                    <TextBox Grid.Column="2" Text="{Binding AnimationDuration, StringFormat=F1}" Style="{DynamicResource DarkTextBoxStyle}" HorizontalContentAlignment="Center" FontFamily="Consolas" FontSize="10" Margin="4,0,0,0" IsReadOnly="True"/>
                                </Grid>
                                <ScrollViewer MaxHeight="80" VerticalScrollBarVisibility="Auto">
                                    <ItemsControl ItemsSource="{Binding ModelAnimations}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="{DynamicResource SecondaryDarkBrush}" CornerRadius="4" Padding="4" Margin="0,0,0,2">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Column="0" Text="{Binding Name}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource AccentRedBrush}" FontWeight="SemiBold"/>
                                                        <TextBlock Grid.Column="1" Text="{Binding DurationText}" Style="{DynamicResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontFamily="Consolas"/>
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </StackPanel>
                        </Expander>

                        <!-- Quick Actions -->
                        <StackPanel>
                            <Button Content="📤 Export Settings" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                            <Button Content="📥 Import Settings" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,4"/>
                            <Button Content="🔄 Refresh Library" Command="{Binding RefreshModelsCommand}" Style="{DynamicResource SecondaryButtonStyle}"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="Image2ImageTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="320"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>
            
            <!-- Technical Controls Panel -->
            <Border Grid.Column="0" 
                    Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="6,0,0,6" 
                    Padding="12">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- Developer Header with System Status -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="INPAINTING DEV" 
                                           Style="{DynamicResource HeadingMediumStyle}"
                                           FontFamily="Consolas"
                                           FontWeight="Bold"/>
                                <TextBlock Text="Advanced Pipeline Controls" 
                                           Style="{DynamicResource CaptionTextStyle}"
                                           Foreground="{DynamicResource TextMutedBrush}"
                                           FontFamily="Consolas"/>
                            </StackPanel>
                            <Border Grid.Column="1"
                                    Background="{DynamicResource SuccessBrush}"
                                    Padding="6,2"
                                    CornerRadius="2">
                                <TextBlock Text="ONLINE" 
                                           Foreground="{DynamicResource TextPrimaryBrush}"
                                           FontFamily="Consolas"
                                           FontSize="8"
                                           FontWeight="Bold"/>
                            </Border>
                        </Grid>
                        
                        <!-- Pipeline Configuration -->
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                Padding="10" 
                                CornerRadius="4"
                                Margin="0,0,0,8">
                            <StackPanel>
                                <TextBlock Text="PIPELINE CONFIG" 
                                           Style="{DynamicResource CodeTextStyle}"
                                           FontWeight="Bold"
                                           FontSize="9"
                                           Foreground="{DynamicResource AccentRedBrush}"
                                           Margin="0,0,0,6"/>
                                
                                <!-- Model Selection -->
                                <Grid Margin="0,0,0,6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="MODEL:" 
                                               Style="{DynamicResource CodeTextStyle}"
                                               FontSize="8" Width="50"/>
                                    <ComboBox Grid.Column="1" 
                                              ItemsSource="{Binding AvailableModels}"
                                              SelectedItem="{Binding SelectedModel}"
                                              FontFamily="Consolas" FontSize="9"/>
                                </Grid>
                                
                                <!-- Scheduler Selection -->
                                <Grid Margin="0,0,0,6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="SCHED:" 
                                               Style="{DynamicResource CodeTextStyle}"
                                               FontSize="8" Width="50"/>
                                    <ComboBox Grid.Column="1" 
                                              ItemsSource="{Binding AvailableSchedulers}"
                                              SelectedItem="{Binding SelectedScheduler}"
                                              FontFamily="Consolas" FontSize="9"/>
                                </Grid>
                                
                                <!-- Quick Actions -->
                                <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                    <Button Content="🔧 CONFIG" 
                                            Style="{DynamicResource GhostButtonStyle}"
                                            Padding="6,2" FontSize="8"
                                            Command="{Binding OpenConfigCommand}"
                                            Margin="0,0,4,0"/>
                                    <Button Content="📊 STATS" 
                                            Style="{DynamicResource GhostButtonStyle}"
                                            Padding="6,2" FontSize="8"
                                            Command="{Binding ShowStatsCommand}"
                                            Margin="0,0,4,0"/>
                                    <Button Content="🔄 RELOAD" 
                                            Style="{DynamicResource GhostButtonStyle}"
                                            Padding="6,2" FontSize="8"
                                            Command="{Binding ReloadPipelineCommand}"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- Advanced Parameters -->
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                Padding="10" 
                                CornerRadius="4"
                                Margin="0,0,0,8">
                            <StackPanel>
                                <TextBlock Text="TECHNICAL PARAMETERS" 
                                           Style="{DynamicResource CodeTextStyle}"
                                           FontWeight="Bold"
                                           FontSize="9"
                                           Foreground="{DynamicResource AccentRedBrush}"
                                           Margin="0,0,0,6"/>
                                
                                <!-- Core Parameters Grid -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Steps -->
                                    <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,4,4">
                                        <TextBlock Text="STEPS" Style="{DynamicResource CodeTextStyle}" FontSize="7"/>
                                        <TextBox Text="{Binding Steps}" FontFamily="Consolas" FontSize="9" 
                                                 Style="{DynamicResource DarkTextBoxStyle}" Padding="2"/>
                                    </StackPanel>
                                    
                                    <!-- CFG Scale -->
                                    <StackPanel Grid.Row="0" Grid.Column="1" Margin="4,0,0,4">
                                        <TextBlock Text="CFG" Style="{DynamicResource CodeTextStyle}" FontSize="7"/>
                                        <TextBox Text="{Binding CfgScale}" FontFamily="Consolas" FontSize="9" 
                                                 Style="{DynamicResource DarkTextBoxStyle}" Padding="2"/>
                                    </StackPanel>
                                    
                                    <!-- Strength -->
                                    <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,4,4">
                                        <TextBlock Text="STRENGTH" Style="{DynamicResource CodeTextStyle}" FontSize="7"/>
                                        <TextBox Text="{Binding Strength}" FontFamily="Consolas" FontSize="9" 
                                                 Style="{DynamicResource DarkTextBoxStyle}" Padding="2"/>
                                    </StackPanel>
                                    
                                    <!-- Seed -->
                                    <StackPanel Grid.Row="1" Grid.Column="1" Margin="4,0,0,4">
                                        <TextBlock Text="SEED" Style="{DynamicResource CodeTextStyle}" FontSize="7"/>
                                        <TextBox Text="{Binding Seed}" FontFamily="Consolas" FontSize="9" 
                                                 Style="{DynamicResource DarkTextBoxStyle}" Padding="2"/>
                                    </StackPanel>
                                    
                                    <!-- Mask Blur -->
                                    <StackPanel Grid.Row="2" Grid.Column="0" Margin="0,0,4,4">
                                        <TextBlock Text="BLUR" Style="{DynamicResource CodeTextStyle}" FontSize="7"/>
                                        <TextBox Text="{Binding MaskBlur}" FontFamily="Consolas" FontSize="9" 
                                                 Style="{DynamicResource DarkTextBoxStyle}" Padding="2"/>
                                    </StackPanel>
                                    
                                    <!-- Batch Size -->
                                    <StackPanel Grid.Row="2" Grid.Column="1" Margin="4,0,0,4">
                                        <TextBlock Text="BATCH" Style="{DynamicResource CodeTextStyle}" FontSize="7"/>
                                        <TextBox Text="{Binding BatchSize}" FontFamily="Consolas" FontSize="9" 
                                                 Style="{DynamicResource DarkTextBoxStyle}" Padding="2"/>
                                    </StackPanel>
                                </Grid>
                                
                                <!-- Prompt Engineering -->
                                <StackPanel Margin="0,6,0,0">
                                    <TextBlock Text="PROMPT" Style="{DynamicResource CodeTextStyle}" FontSize="7" Margin="0,0,0,2"/>
                                    <TextBox Text="{Binding Prompt}" FontFamily="Consolas" FontSize="9" 
                                             Style="{DynamicResource DarkTextBoxStyle}" 
                                             MinHeight="60" TextWrapping="Wrap" Padding="4"/>
                                </StackPanel>
                                
                                <!-- Negative Prompt -->
                                <StackPanel Margin="0,6,0,0">
                                    <TextBlock Text="NEG_PROMPT" Style="{DynamicResource CodeTextStyle}" FontSize="7" Margin="0,0,0,2"/>
                                    <TextBox Text="{Binding NegativePrompt}" FontFamily="Consolas" FontSize="9" 
                                             Style="{DynamicResource DarkTextBoxStyle}" 
                                             MinHeight="40" TextWrapping="Wrap" Padding="4"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- Execution Controls -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <Button Content="⚡ EXECUTE" 
                                    Command="{Binding GenerateCommand}"
                                    Style="{DynamicResource PrimaryButtonStyle}"
                                    Padding="12,6" FontFamily="Consolas" FontSize="9"
                                    Margin="0,0,4,0"/>
                            <Button Content="⏹️ ABORT" 
                                    Command="{Binding AbortCommand}"
                                    Style="{DynamicResource GhostButtonStyle}"
                                    Padding="8,6" FontFamily="Consolas" FontSize="9"/>
                        </StackPanel>
                        
                        <!-- System Monitoring -->
                        <Border Background="{DynamicResource PrimaryDarkBrush}" 
                                Padding="8" 
                                CornerRadius="4"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1">
                            <StackPanel>
                                <TextBlock Text="SYSTEM MONITOR" 
                                           Style="{DynamicResource CodeTextStyle}"
                                           FontWeight="Bold"
                                           FontSize="8"
                                           Foreground="{DynamicResource WarningBrush}"
                                           Margin="0,0,0,6"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- GPU Usage -->
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="GPU:" 
                                               Style="{DynamicResource CodeTextStyle}" FontSize="8" Width="40"/>
                                    <ProgressBar Grid.Row="0" Grid.Column="1" 
                                                 Value="{Binding GpuUsage}" Maximum="100" 
                                                 Height="12" Margin="4,0"/>
                                    <TextBlock Grid.Row="0" Grid.Column="2" 
                                               Text="{Binding GpuUsage, StringFormat={}{0:F0}%}" 
                                               Style="{DynamicResource CodeTextStyle}" FontSize="8" Width="30"/>
                                    
                                    <!-- VRAM Usage -->
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="VRAM:" 
                                               Style="{DynamicResource CodeTextStyle}" FontSize="8"/>
                                    <ProgressBar Grid.Row="1" Grid.Column="1" 
                                                 Value="{Binding VramUsage}" Maximum="{Binding VramTotal}" 
                                                 Height="12" Margin="4,0"/>
                                    <TextBlock Grid.Row="1" Grid.Column="2" 
                                               Text="{Binding VramUsage, StringFormat={}{0:F0}MB}" 
                                               Style="{DynamicResource CodeTextStyle}" FontSize="8"/>
                                    
                                    <!-- Generation Time -->
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="TIME:" 
                                               Style="{DynamicResource CodeTextStyle}" FontSize="8"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" 
                                               Text="{Binding LastGenerationTime, StringFormat={}{0:F2}s}" 
                                               Style="{DynamicResource CodeTextStyle}" FontSize="8" Margin="4,0"/>
                                    <TextBlock Grid.Row="2" Grid.Column="2" 
                                               Text="{Binding IterationsPerSecond, StringFormat={}{0:F1} it/s}" 
                                               Style="{DynamicResource CodeTextStyle}" FontSize="8"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Border>
            
            <!-- Technical Canvas with Debug Overlays -->
            <Border Grid.Column="1" 
                    Background="{DynamicResource TertiaryDarkBrush}" 
                    Padding="8">
                <Grid>
                    <!-- Main Canvas -->
                    <Border Background="{DynamicResource PrimaryDarkBrush}"
                            CornerRadius="4"
                            BorderBrush="{DynamicResource BorderBrush}"
                            BorderThickness="2">
                        <Grid>
                            <Image Source="{Binding SourceImageSource}" 
                                   Stretch="Uniform"
                                   Visibility="{Binding HasSourceImage, Converter={StaticResource BoolToVisibility}}"/>
                            
                            <!-- Technical Placeholder -->
                            <StackPanel HorizontalAlignment="Center" 
                                        VerticalAlignment="Center"
                                        Visibility="{Binding HasSourceImage, Converter={StaticResource BoolToVisibility}, ConverterParameter=Inverted}">
                                <TextBlock Text="█▓▒░" 
                                           FontFamily="Consolas"
                                           FontSize="48" 
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,8"
                                           Opacity="0.3"/>
                                <TextBlock Text="AWAITING SOURCE IMAGE" 
                                           Style="{DynamicResource HeadingSmallStyle}"
                                           FontFamily="Consolas"
                                           HorizontalAlignment="Center"
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="LOAD → MASK → EXECUTE" 
                                           Style="{DynamicResource CaptionTextStyle}"
                                           FontFamily="Consolas"
                                           HorizontalAlignment="Center"
                                           Foreground="{DynamicResource TextMutedBrush}"
                                           Margin="0,4,0,0"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- Debug Info Overlay -->
                    <Border Background="{DynamicResource PrimaryDarkBrush}"
                            BorderBrush="{DynamicResource SuccessBrush}"
                            BorderThickness="1"
                            CornerRadius="2"
                            Padding="6"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Top"
                            Margin="12"
                            Opacity="0.9">
                        <StackPanel>
                            <TextBlock Text="{Binding ImageDimensions, StringFormat={}DIM: {0}}" 
                                       Style="{DynamicResource CodeTextStyle}"
                                       FontSize="8" FontFamily="Consolas"/>
                            <TextBlock Text="{Binding MaskCoverage, StringFormat={}MSK: {0:F1}%}" 
                                       Style="{DynamicResource CodeTextStyle}"
                                       FontSize="8" FontFamily="Consolas"/>
                            <TextBlock Text="{Binding ZoomLevel, StringFormat={}ZOM: {0:F0}%}" 
                                       Style="{DynamicResource CodeTextStyle}"
                                       FontSize="8" FontFamily="Consolas"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Technical Tools -->
                    <StackPanel HorizontalAlignment="Right" 
                                VerticalAlignment="Bottom"
                                Margin="12">
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                            <Button Content="📁" Command="{Binding LoadImageCommand}"
                                    Style="{DynamicResource GhostButtonStyle}" Padding="6" FontSize="10"/>
                            <Button Content="🖌️" Command="{Binding SetBrushModeCommand}"
                                    Style="{DynamicResource GhostButtonStyle}" Padding="6" FontSize="10" Margin="2,0"/>
                            <Button Content="🧽" Command="{Binding SetEraseModeCommand}"
                                    Style="{DynamicResource GhostButtonStyle}" Padding="6" FontSize="10" Margin="2,0"/>
                            <Button Content="🗑️" Command="{Binding ClearMaskCommand}"
                                    Style="{DynamicResource GhostButtonStyle}" Padding="6" FontSize="10"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Button Content="🔍+" Command="{Binding ZoomInCommand}"
                                    Style="{DynamicResource GhostButtonStyle}" Padding="6" FontSize="10"/>
                            <Button Content="🔍-" Command="{Binding ZoomOutCommand}"
                                    Style="{DynamicResource GhostButtonStyle}" Padding="6" FontSize="10" Margin="2,0"/>
                            <Button Content="🎯" Command="{Binding FitToScreenCommand}"
                                    Style="{DynamicResource GhostButtonStyle}" Padding="6" FontSize="10" Margin="2,0"/>
                            <Button Content="🔄" Command="{Binding ResetViewCommand}"
                                    Style="{DynamicResource GhostButtonStyle}" Padding="6" FontSize="10"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- Technical Analysis and Debug Panel -->
            <Border Grid.Column="2" 
                    Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="0,6,6,0" 
                    Padding="12">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- Debug Console -->
                        <TextBlock Text="DEBUG CONSOLE" 
                                   Style="{DynamicResource HeadingMediumStyle}"
                                   FontFamily="Consolas"
                                   Margin="0,0,0,8"/>
                        
                        <!-- Live Metrics -->
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                Padding="8" 
                                CornerRadius="4"
                                Margin="0,0,0,8">
                            <StackPanel>
                                <TextBlock Text="LIVE METRICS" 
                                           Style="{DynamicResource CodeTextStyle}"
                                           FontWeight="Bold"
                                           FontSize="8"
                                           Foreground="{DynamicResource AccentRedBrush}"
                                           Margin="0,0,0,4"/>
                                
                                <TextBlock Text="{Binding GenerationTime, StringFormat={}Generation: {0}ms}" 
                                           Style="{DynamicResource CodeTextStyle}"
                                           FontSize="9" FontFamily="Consolas"/>
                                <TextBlock Text="{Binding TokensPerSecond, StringFormat={}Speed: {0:F1} it/s}" 
                                           Style="{DynamicResource CodeTextStyle}"
                                           FontSize="9" FontFamily="Consolas"/>
                                <TextBlock Text="{Binding MemoryUsage, StringFormat={}VRAM: {0}MB}" 
                                           Style="{DynamicResource CodeTextStyle}"
                                           FontSize="9" FontFamily="Consolas"/>
                                <TextBlock Text="{Binding PipelineStatus}" 
                                           Style="{DynamicResource CodeTextStyle}"
                                           FontSize="9" FontFamily="Consolas"
                                           Foreground="{DynamicResource SuccessBrush}"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- JSON Configuration -->
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                Padding="8" 
                                CornerRadius="4"
                                Margin="0,0,0,8">
                            <StackPanel>
                                <Grid Margin="0,0,0,4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="PIPELINE JSON" 
                                               Style="{DynamicResource CodeTextStyle}"
                                               FontWeight="Bold"
                                               FontSize="8"
                                               Foreground="{DynamicResource AccentRedBrush}"/>
                                    <Button Grid.Column="1" Content="📋" 
                                            Style="{DynamicResource GhostButtonStyle}"
                                            Padding="4,2" FontSize="8"
                                            Command="{Binding CopyJsonCommand}"/>
                                </Grid>
                                
                                <ScrollViewer MaxHeight="120" 
                                              VerticalScrollBarVisibility="Auto"
                                              HorizontalScrollBarVisibility="Auto">
                                    <TextBlock Text="{Binding JsonConfiguration}" 
                                               FontFamily="Consolas"
                                               FontSize="8"
                                               Foreground="{DynamicResource SuccessBrush}"
                                               TextWrapping="NoWrap"/>
                                </ScrollViewer>
                            </StackPanel>
                        </Border>
                        
                        <!-- Results Analysis -->
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                Padding="8" 
                                CornerRadius="4"
                                Margin="0,0,0,8">
                            <StackPanel>
                                <TextBlock Text="RESULT ANALYSIS" 
                                           Style="{DynamicResource CodeTextStyle}"
                                           FontWeight="Bold"
                                           FontSize="8"
                                           Foreground="{DynamicResource AccentRedBrush}"
                                           Margin="0,0,0,4"/>
                                
                                <Border Background="{DynamicResource PrimaryDarkBrush}"
                                        Height="100"
                                        CornerRadius="2"
                                        Margin="0,0,0,4">
                                    <Image Source="{Binding GeneratedImageSource}" 
                                           Stretch="Uniform"
                                           Visibility="{Binding HasGeneratedImage, Converter={StaticResource BoolToVisibility}}"/>
                                </Border>
                                
                                <StackPanel>
                                    <TextBlock Text="{Binding ResultDimensions, StringFormat={}OUT: {0}}" 
                                               Style="{DynamicResource CodeTextStyle}"
                                               FontSize="8" FontFamily="Consolas"/>
                                    <TextBlock Text="{Binding FileSize, StringFormat={}SIZE: {0}KB}" 
                                               Style="{DynamicResource CodeTextStyle}"
                                               FontSize="8" FontFamily="Consolas"/>
                                    <TextBlock Text="{Binding ColorDepth, StringFormat={}DEPTH: {0}}" 
                                               Style="{DynamicResource CodeTextStyle}"
                                               FontSize="8" FontFamily="Consolas"/>
                                </StackPanel>
                                
                                <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                    <Button Content="💾 SAVE" 
                                            Style="{DynamicResource GhostButtonStyle}"
                                            Padding="6,2" FontSize="8"
                                            Command="{Binding SaveCommand}"
                                            Margin="0,0,2,0"/>
                                    <Button Content="📊 ANALYZE" 
                                            Style="{DynamicResource GhostButtonStyle}"
                                            Padding="6,2" FontSize="8"
                                            Command="{Binding AnalyzeCommand}"
                                            Margin="0,0,2,0"/>
                                    <Button Content="🔬 INSPECT" 
                                            Style="{DynamicResource GhostButtonStyle}"
                                            Padding="6,2" FontSize="8"
                                            Command="{Binding InspectCommand}"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- Debug Log -->
                        <Border Background="{DynamicResource PrimaryDarkBrush}" 
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                Padding="6" 
                                CornerRadius="2">
                            <StackPanel>
                                <TextBlock Text="DEBUG LOG" 
                                           Style="{DynamicResource CodeTextStyle}"
                                           FontWeight="Bold"
                                           FontSize="8"
                                           Foreground="{DynamicResource WarningBrush}"
                                           Margin="0,0,0,4"/>
                                
                                <ScrollViewer MaxHeight="100" 
                                              VerticalScrollBarVisibility="Auto">
                                    <ItemsControl ItemsSource="{Binding DebugLog}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding}" 
                                                           FontFamily="Consolas"
                                                           FontSize="7"
                                                           Foreground="{DynamicResource TextMutedBrush}"
                                                           TextWrapping="NoWrap"/>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </DataTemplate>
    
    <!-- Upscaling Template - Developer Mode -->
    <DataTemplate x:Key="UpscalingTemplate">
        <StackPanel>
            <TextBlock Text="Upscaling - Developer Mode" 
                       Foreground="{DynamicResource TextPrimaryBrush}" 
                       FontSize="12" FontWeight="Bold"/>
            <Button Content="Load Image" Command="{Binding LoadImageCommand}"/>
            <ComboBox ItemsSource="{Binding AvailableScaleFactors}" SelectedValue="{Binding ScaleFactor}"/>
            <Button Content="Upscale" Command="{Binding GenerateCommand}"/>
        </StackPanel>
    </DataTemplate>
    <!-- VIDEO SECTION TEMPLATES -->
    <!-- Text2Video Template - Developer Mode -->
    <DataTemplate x:Key="Text2VideoTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="380"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>
            
            <!-- Technical Controls Panel -->
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="8,0,0,8" Padding="12">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🎬 Text2Video Engine" 
                                   Style="{DynamicResource HeadingSmallStyle}"
                                   Foreground="{DynamicResource AccentRedBrush}"
                                   Margin="0,0,0,12"/>
                        
                        <!-- Engine Configuration -->
                        <Expander Header="🔧 Engine Configuration" IsExpanded="True" FontSize="11" Margin="0,0,0,8">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Engine: AnimateDiff v3.0" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <TextBlock Text="Model: stable-video-diffusion-img2vid-xt-1-1" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <TextBlock Text="VRAM: 8.2GB / 24GB" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <TextBlock Text="Precision: FP16" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Motion Prompt Engineering -->
                        <Expander Header="✏️ Motion Prompt Engineering" IsExpanded="True" FontSize="11" Margin="0,0,0,8">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Base Prompt:" FontSize="10" Margin="0,0,0,2"/>
                                <TextBox Text="{Binding BasePrompt}" 
                                         Background="{DynamicResource TertiaryDarkBrush}"
                                         Foreground="{DynamicResource TextPrimaryBrush}"
                                         MinHeight="60" TextWrapping="Wrap" AcceptsReturn="True"
                                         FontSize="11" Margin="0,0,0,8"/>
                                
                                <TextBlock Text="Motion Keywords:" FontSize="10" Margin="0,0,0,2"/>
                                <TextBox Text="{Binding MotionPrompt}" 
                                         Background="{DynamicResource TertiaryDarkBrush}"
                                         Foreground="{DynamicResource TextPrimaryBrush}"
                                         MinHeight="40" TextWrapping="Wrap"
                                         FontSize="11" Margin="0,0,0,8"/>
                                
                                <TextBlock Text="Negative Prompt:" FontSize="10" Margin="0,0,0,2"/>
                                <TextBox Text="{Binding NegativePrompt}" 
                                         Background="{DynamicResource TertiaryDarkBrush}"
                                         Foreground="{DynamicResource TextPrimaryBrush}"
                                         MinHeight="30" TextWrapping="Wrap"
                                         FontSize="11" Margin="0,0,0,12"/>
                                
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Prompt Adherence" FontSize="10" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding CFGScale}" FontSize="10" 
                                             Background="{DynamicResource TertiaryDarkBrush}"
                                             HorizontalAlignment="Stretch"/>
                                </Grid>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Technical Video Parameters -->
                        <Expander Header="⚙️ Video Parameters" IsExpanded="True" FontSize="11" Margin="0,0,0,8">
                            <StackPanel Margin="0,8,0,0">
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Duration (frames)" FontSize="10" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding FrameCount}" FontSize="10" 
                                             Background="{DynamicResource TertiaryDarkBrush}"/>
                                </Grid>
                                
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Frame Rate (fps)" FontSize="10" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Column="1" FontSize="10" 
                                              Style="{DynamicResource DarkComboBoxStyle}">
                                        <ComboBoxItem Content="8" IsSelected="True"/>
                                        <ComboBoxItem Content="12"/>
                                        <ComboBoxItem Content="16"/>
                                        <ComboBoxItem Content="24"/>
                                    </ComboBox>
                                </Grid>
                                
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Resolution" FontSize="10" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Column="1" FontSize="10" 
                                              Style="{DynamicResource DarkComboBoxStyle}">
                                        <ComboBoxItem Content="512x512"/>
                                        <ComboBoxItem Content="768x768" IsSelected="True"/>
                                        <ComboBoxItem Content="1024x576"/>
                                        <ComboBoxItem Content="1024x1024"/>
                                    </ComboBox>
                                </Grid>
                                
                                <TextBlock Text="Motion Intensity" FontSize="10" Margin="0,8,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Value="{Binding MotionIntensity}" 
                                            Minimum="0" Maximum="2" 
                                            TickFrequency="0.1" 
                                            TickPlacement="BottomRight"/>
                                    <TextBlock Grid.Column="1" 
                                               Text="{Binding MotionIntensity, StringFormat=F1}" 
                                               FontSize="10" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"/>
                                </Grid>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Sampling and Optimization -->
                        <Expander Header="🔬 Sampling &amp; Optimization" IsExpanded="False" FontSize="11" Margin="0,0,0,8">
                            <StackPanel Margin="0,8,0,0">
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Steps" FontSize="10" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding Steps}" FontSize="10" 
                                             Background="{DynamicResource TertiaryDarkBrush}"/>
                                </Grid>
                                
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Sampler" FontSize="10" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Column="1" FontSize="10" 
                                              Style="{DynamicResource DarkComboBoxStyle}">
                                        <ComboBoxItem Content="DPM++ 2M" IsSelected="True"/>
                                        <ComboBoxItem Content="Euler a"/>
                                        <ComboBoxItem Content="DDIM"/>
                                        <ComboBoxItem Content="LMS"/>
                                    </ComboBox>
                                </Grid>
                                
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Seed" FontSize="10" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding Seed}" FontSize="10" 
                                             Background="{DynamicResource TertiaryDarkBrush}"/>
                                </Grid>
                                
                                <CheckBox Content="Use CPU Offload" FontSize="10" 
                                          IsChecked="{Binding UseCPUOffload}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                                <CheckBox Content="Enable Memory Efficient Attention" FontSize="10" 
                                          IsChecked="{Binding UseMemoryEfficientAttention}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Generation Controls -->
                        <Button Content="🚀 Generate Video" 
                                Command="{Binding GenerateCommand}"
                                Style="{DynamicResource PrimaryButtonStyle}"
                                Padding="0,12" FontSize="12" FontWeight="SemiBold"
                                Margin="0,12,0,8"/>
                        
                        <Button Content="⏹️ Stop Generation" 
                                Command="{Binding StopGenerationCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" IsEnabled="{Binding IsGenerating}"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>
            
            <!-- Video Preview and Analysis Panel -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" 
                    Padding="16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="120"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Video Preview -->
                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="4" 
                            Margin="0,0,0,12">
                        <Grid>
                            <MediaElement Source="{Binding GeneratedVideoSource}" 
                                          LoadedBehavior="Manual"
                                          Stretch="Uniform"
                                          Visibility="{Binding HasGeneratedVideo, Converter={StaticResource BoolToVisibility}}"/>
                            <StackPanel HorizontalAlignment="Center" 
                                       VerticalAlignment="Center"
                                       Visibility="{Binding HasGeneratedVideo, Converter={StaticResource BoolToVisibility}, ConverterParameter=Inverted}">
                                <TextBlock Text="🎥" FontSize="48" 
                                           HorizontalAlignment="Center" 
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="Generated video preview" 
                                           FontSize="14" 
                                           HorizontalAlignment="Center" 
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="Technical analysis will appear here" 
                                           FontSize="11" 
                                           HorizontalAlignment="Center" 
                                           Foreground="{DynamicResource TextMutedBrush}" 
                                           Margin="0,4,0,0"/>
                            </StackPanel>
                            
                            <!-- Progress Overlay -->
                            <Border Background="{DynamicResource PrimaryDarkBrush}" 
                                    Opacity="0.9" 
                                    CornerRadius="4" 
                                    Visibility="{Binding IsGenerating, Converter={StaticResource BoolToVisibility}}">
                                <StackPanel HorizontalAlignment="Center" 
                                           VerticalAlignment="Center">
                                    <TextBlock Text="⚙️ Generating Video..." 
                                               FontSize="16" 
                                               FontWeight="SemiBold" 
                                               HorizontalAlignment="Center" 
                                               Margin="0,0,0,8"/>
                                    <ProgressBar Value="{Binding GenerationProgress}" 
                                                 Width="300" Height="8" 
                                                 Margin="0,0,0,8"/>
                                    <TextBlock Text="{Binding GenerationStatus}" 
                                               FontSize="11" 
                                               HorizontalAlignment="Center" 
                                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Border>
                    
                    <!-- Playback Controls -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" 
                               HorizontalAlignment="Center" 
                               Margin="0,0,0,8"
                               Visibility="{Binding HasGeneratedVideo, Converter={StaticResource BoolToVisibility}}">
                        <Button Content="▶️" Command="{Binding PlayCommand}" 
                                Style="{DynamicResource SecondaryButtonStyle}" 
                                Width="40" Height="32" FontSize="12" Margin="0,0,4,0"/>
                        <Button Content="⏸️" Command="{Binding PauseCommand}" 
                                Style="{DynamicResource SecondaryButtonStyle}" 
                                Width="40" Height="32" FontSize="12" Margin="0,0,4,0"/>
                        <Button Content="⏹️" Command="{Binding StopCommand}" 
                                Style="{DynamicResource SecondaryButtonStyle}" 
                                Width="40" Height="32" FontSize="12" Margin="0,0,8,0"/>
                        <StackPanel Orientation="Horizontal" 
                                   VerticalAlignment="Center" 
                                   Margin="8,0,0,0">
                            <TextBlock Text="{Binding CurrentFrame}" FontSize="11" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <TextBlock Text="/" FontSize="11" Foreground="{DynamicResource TextSecondaryBrush}" Margin="2,0"/>
                            <TextBlock Text="{Binding TotalFrames}" FontSize="11" Foreground="{DynamicResource TextSecondaryBrush}"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- Technical Analysis Console -->
                    <Border Grid.Row="2" Background="{DynamicResource SecondaryDarkBrush}" 
                            CornerRadius="4" Padding="8">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <StackPanel>
                                <TextBlock Text="📊 Generation Analysis" 
                                           FontSize="11" FontWeight="SemiBold" 
                                           Foreground="{DynamicResource AccentRedBrush}" 
                                           Margin="0,0,0,6"/>
                                <TextBlock Text="{Binding TechnicalLog}" 
                                           FontSize="10" 
                                           FontFamily="Consolas" 
                                           Foreground="{DynamicResource TextSecondaryBrush}" 
                                           TextWrapping="Wrap"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </Border>
            
            <!-- Generation History and Export Panel -->
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="0,8,8,0" Padding="12">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- History Header -->
                    <TextBlock Grid.Row="0" Text="🗂️ Generation History" 
                               Style="{DynamicResource HeadingSmallStyle}"
                               Foreground="{DynamicResource AccentRedBrush}"
                               Margin="0,0,0,12"/>
                    
                    <!-- History List -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <ItemsControl ItemsSource="{Binding GenerationHistory}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                            CornerRadius="4" Padding="8" Margin="0,0,0,8">
                                        <StackPanel>
                                            <TextBlock Text="{Binding Timestamp, StringFormat=HH:mm:ss}" 
                                                       FontSize="10" 
                                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                                            <TextBlock Text="{Binding Prompt}" 
                                                       FontSize="11" 
                                                       TextTrimming="CharacterEllipsis" 
                                                       MaxHeight="40" 
                                                       TextWrapping="Wrap"/>
                                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                <StackPanel Orientation="Horizontal" Margin="0,0,8,0">
                                                    <TextBlock Text="{Binding Duration}" FontSize="10" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="s" FontSize="10" Foreground="{DynamicResource TextMutedBrush}"/>
                                                </StackPanel>
                                                <TextBlock Text="{Binding Resolution}" FontSize="10" 
                                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    
                    <!-- Export Controls -->
                    <StackPanel Grid.Row="2" Margin="0,8,0,0">
                        <Button Content="💾 Export Video" 
                                Command="{Binding ExportVideoCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" 
                                IsEnabled="{Binding HasGeneratedVideo}"/>
                        <Button Content="📋 Copy Parameters" 
                                Command="{Binding CopyParametersCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" Margin="0,4,0,0"/>
                        <Button Content="🗑️ Clear History" 
                                Command="{Binding ClearHistoryCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" Margin="0,4,0,0"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </DataTemplate>
<!-- removed stray closing ResourceDictionary -->
    <!-- Video2Video Template - Developer Mode -->
    <DataTemplate x:Key="Video2VideoTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="380"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>
            
            <!-- Technical Controls Panel -->
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="8,0,0,8" Padding="12">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🎬 Video2Video Engine" 
                                   Style="{DynamicResource HeadingSmallStyle}"
                                   Foreground="{DynamicResource AccentRedBrush}"
                                   Margin="0,0,0,12"/>
                        
                        <!-- Source Video Input -->
                        <Expander Header="📹 Source Video Analysis" IsExpanded="True" FontSize="11" Margin="0,0,0,8">
                            <StackPanel Margin="0,8,0,0">
                                <Button Content="📁 Load Source Video" 
                                        Command="{Binding LoadVideoCommand}"
                                        Style="{DynamicResource SecondaryButtonStyle}"
                                        Padding="0,8" FontSize="11" Margin="0,0,0,8"/>
                                
                                <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                        CornerRadius="4" Padding="8" 
                                        Visibility="{Binding HasSourceVideo, Converter={StaticResource BoolToVisibility}}">
                                    <StackPanel>
                                        <TextBlock Text="Source Analysis:" FontSize="10" FontWeight="SemiBold" Margin="0,0,0,4"/>
                                        <TextBlock Text="{Binding SourceVideoInfo.Resolution}" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <TextBlock Text="{Binding SourceVideoInfo.Duration}" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding SourceVideoInfo.FrameRate}" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                            <TextBlock Text=" fps" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        </StackPanel>
                                        <TextBlock Text="{Binding SourceVideoInfo.Codec}" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Transformation Prompt Engineering -->
                        <Expander Header="✏️ Transformation Prompt" IsExpanded="True" FontSize="11" Margin="0,0,0,8">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Transformation Description:" FontSize="10" Margin="0,0,0,2"/>
                                <TextBox Text="{Binding TransformationPrompt}" 
                                         Background="{DynamicResource TertiaryDarkBrush}"
                                         Foreground="{DynamicResource TextPrimaryBrush}"
                                         MinHeight="60" TextWrapping="Wrap" AcceptsReturn="True"
                                         FontSize="11" Margin="0,0,0,8"/>
                                
                                <TextBlock Text="Style Transfer:" FontSize="10" Margin="0,0,0,2"/>
                                <TextBox Text="{Binding StylePrompt}" 
                                         Background="{DynamicResource TertiaryDarkBrush}"
                                         Foreground="{DynamicResource TextPrimaryBrush}"
                                         MinHeight="40" TextWrapping="Wrap"
                                         FontSize="11" Margin="0,0,0,8"/>
                                
                                <TextBlock Text="Preservation Mask:" FontSize="10" Margin="0,0,0,2"/>
                                <TextBox Text="{Binding PreservationPrompt}" 
                                         Background="{DynamicResource TertiaryDarkBrush}"
                                         Foreground="{DynamicResource TextPrimaryBrush}"
                                         MinHeight="30" TextWrapping="Wrap"
                                         FontSize="11" Margin="0,0,0,12"/>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Video2Video Parameters -->
                        <Expander Header="⚙️ Transformation Parameters" IsExpanded="True" FontSize="11" Margin="0,0,0,8">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Denoising Strength" FontSize="10" Margin="0,0,0,2"/>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Value="{Binding DenoisingStrength}" 
                                            Minimum="0" Maximum="1" 
                                            TickFrequency="0.1" 
                                            TickPlacement="BottomRight"/>
                                    <TextBlock Grid.Column="1" 
                                               Text="{Binding DenoisingStrength, StringFormat=F2}" 
                                               FontSize="10" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"/>
                                </Grid>
                                
                                <TextBlock Text="Temporal Consistency" FontSize="10" Margin="0,0,0,2"/>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Value="{Binding TemporalConsistency}" 
                                            Minimum="0" Maximum="1" 
                                            TickFrequency="0.1" 
                                            TickPlacement="BottomRight"/>
                                    <TextBlock Grid.Column="1" 
                                               Text="{Binding TemporalConsistency, StringFormat=F2}" 
                                               FontSize="10" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"/>
                                </Grid>
                                
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Processing Mode" FontSize="10" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Column="1" FontSize="10" 
                                              Style="{DynamicResource DarkComboBoxStyle}">
                                        <ComboBoxItem Content="Frame-by-Frame" IsSelected="True"/>
                                        <ComboBoxItem Content="Temporal Batches"/>
                                        <ComboBoxItem Content="Full Sequence"/>
                                    </ComboBox>
                                </Grid>
                                
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Batch Size" FontSize="10" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding BatchSize}" FontSize="10" 
                                             Background="{DynamicResource TertiaryDarkBrush}"/>
                                </Grid>
                                
                                <CheckBox Content="Preserve Original Timing" FontSize="10" 
                                          IsChecked="{Binding PreserveOriginalTiming}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                                <CheckBox Content="Auto Keyframe Detection" FontSize="10" 
                                          IsChecked="{Binding AutoKeyframeDetection}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                                <CheckBox Content="Motion-Adaptive Processing" FontSize="10" 
                                          IsChecked="{Binding MotionAdaptiveProcessing}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Advanced Controls -->
                        <Expander Header="🔬 Advanced Controls" IsExpanded="False" FontSize="11" Margin="0,0,0,8">
                            <StackPanel Margin="0,8,0,0">
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Steps per Frame" FontSize="10" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding StepsPerFrame}" FontSize="10" 
                                             Background="{DynamicResource TertiaryDarkBrush}"/>
                                </Grid>
                                
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="CFG Scale" FontSize="10" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding CFGScale}" FontSize="10" 
                                             Background="{DynamicResource TertiaryDarkBrush}"/>
                                </Grid>
                                
                                <CheckBox Content="Use ControlNet for Consistency" FontSize="10" 
                                          IsChecked="{Binding UseControlNet}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                                <CheckBox Content="Enable VRAM Optimization" FontSize="10" 
                                          IsChecked="{Binding EnableVRAMOptimization}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Generation Controls -->
                        <Button Content="🚀 Transform Video" 
                                Command="{Binding TransformCommand}"
                                Style="{DynamicResource PrimaryButtonStyle}"
                                Padding="0,12" FontSize="12" FontWeight="SemiBold"
                                Margin="0,12,0,8"
                                IsEnabled="{Binding HasSourceVideo}"/>
                        
                        <Button Content="⏹️ Stop Transformation" 
                                Command="{Binding StopTransformationCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" IsEnabled="{Binding IsTransforming}"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>
            
            <!-- Video Comparison and Analysis Panel -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" 
                    Padding="16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="120"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Video Comparison -->
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="8"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Source Video -->
                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4">
                            <Grid>
                                <MediaElement Source="{Binding SourceVideoSource}" 
                                              LoadedBehavior="Manual"
                                              Stretch="Uniform"
                                              Visibility="{Binding HasSourceVideo, Converter={StaticResource BoolToVisibility}}"/>
                                <StackPanel HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"
                                           Visibility="{Binding HasSourceVideo, Converter={StaticResource BoolToVisibility}, ConverterParameter=Inverted}">
                                    <TextBlock Text="📁" FontSize="36" 
                                               HorizontalAlignment="Center" 
                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                    <TextBlock Text="Source Video" 
                                               FontSize="12" 
                                               HorizontalAlignment="Center" 
                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                        
                        <!-- Divider -->
                        <Border Grid.Column="1" Background="{DynamicResource BorderBrush}"/>
                        
                        <!-- Transformed Video -->
                        <Border Grid.Column="2" Background="{DynamicResource TertiaryDarkBrush}" 
                                CornerRadius="4">
                            <Grid>
                                <MediaElement Source="{Binding TransformedVideoSource}" 
                                              LoadedBehavior="Manual"
                                              Stretch="Uniform"
                                              Visibility="{Binding HasTransformedVideo, Converter={StaticResource BoolToVisibility}}"/>
                                <StackPanel HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"
                                           Visibility="{Binding HasTransformedVideo, Converter={StaticResource BoolToVisibility}, ConverterParameter=Inverted}">
                                    <TextBlock Text="✨" FontSize="36" 
                                               HorizontalAlignment="Center" 
                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                    <TextBlock Text="Transformed Video" 
                                               FontSize="12" 
                                               HorizontalAlignment="Center" 
                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                </StackPanel>
                                
                                <!-- Progress Overlay -->
                                <Border Background="{DynamicResource PrimaryDarkBrush}" 
                                        Opacity="0.9" 
                                        CornerRadius="4" 
                                        Visibility="{Binding IsTransforming, Converter={StaticResource BoolToVisibility}}">
                                    <StackPanel HorizontalAlignment="Center" 
                                               VerticalAlignment="Center">
                                        <TextBlock Text="⚙️ Transforming..." 
                                                   FontSize="14" 
                                                   FontWeight="SemiBold" 
                                                   HorizontalAlignment="Center" 
                                                   Margin="0,0,0,8"/>
                                        <ProgressBar Value="{Binding TransformationProgress}" 
                                                     Width="200" Height="6" 
                                                     Margin="0,0,0,8"/>
                                        <TextBlock Text="{Binding TransformationStatus}" 
                                                   FontSize="10" 
                                                   HorizontalAlignment="Center" 
                                                   Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>
                    
                    <!-- Synchronized Playback Controls -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" 
                               HorizontalAlignment="Center" 
                               Margin="0,0,0,8"
                               Visibility="{Binding HasSourceVideo, Converter={StaticResource BoolToVisibility}}">
                        <Button Content="▶️" Command="{Binding SyncPlayCommand}" 
                                Style="{DynamicResource SecondaryButtonStyle}" 
                                Width="40" Height="32" FontSize="12" Margin="0,0,4,0"/>
                        <Button Content="⏸️" Command="{Binding SyncPauseCommand}" 
                                Style="{DynamicResource SecondaryButtonStyle}" 
                                Width="40" Height="32" FontSize="12" Margin="0,0,4,0"/>
                        <Button Content="⏹️" Command="{Binding SyncStopCommand}" 
                                Style="{DynamicResource SecondaryButtonStyle}" 
                                Width="40" Height="32" FontSize="12" Margin="0,0,8,0"/>
                        <CheckBox Content="Sync Playback" FontSize="11" 
                                  IsChecked="{Binding SyncPlayback}" 
                                  Style="{DynamicResource DarkCheckBoxStyle}" 
                                  VerticalAlignment="Center" Margin="8,0,0,0"/>
                    </StackPanel>
                    
                    <!-- Technical Analysis Console -->
                    <Border Grid.Row="2" Background="{DynamicResource SecondaryDarkBrush}" 
                            CornerRadius="4" Padding="8">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <StackPanel>
                                <TextBlock Text="📊 Transformation Analysis" 
                                           FontSize="11" FontWeight="SemiBold" 
                                           Foreground="{DynamicResource AccentRedBrush}" 
                                           Margin="0,0,0,6"/>
                                <TextBlock Text="{Binding TransformationLog}" 
                                           FontSize="10" 
                                           FontFamily="Consolas" 
                                           Foreground="{DynamicResource TextSecondaryBrush}" 
                                           TextWrapping="Wrap"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </Border>
            
            <!-- Transformation History and Export Panel -->
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="0,8,8,0" Padding="12">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- History Header -->
                    <TextBlock Grid.Row="0" Text="🗂️ Transformation History" 
                               Style="{DynamicResource HeadingSmallStyle}"
                               Foreground="{DynamicResource AccentRedBrush}"
                               Margin="0,0,0,12"/>
                    
                    <!-- History List -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <ItemsControl ItemsSource="{Binding TransformationHistory}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                            CornerRadius="4" Padding="8" Margin="0,0,0,8">
                                        <StackPanel>
                                            <TextBlock Text="{Binding Timestamp, StringFormat=HH:mm:ss}" 
                                                       FontSize="10" 
                                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                                            <TextBlock Text="{Binding TransformationPrompt}" 
                                                       FontSize="11" 
                                                       TextTrimming="CharacterEllipsis" 
                                                       MaxHeight="40" 
                                                       TextWrapping="Wrap"/>
                                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                <StackPanel Orientation="Horizontal" Margin="0,0,8,0">
                                                    <TextBlock Text="Strength: " FontSize="10" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="{Binding DenoisingStrength, StringFormat=F2}" FontSize="10" Foreground="{DynamicResource TextMutedBrush}"/>
                                                </StackPanel>
                                                <TextBlock Text="{Binding ProcessingTime}" FontSize="10" 
                                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    
                    <!-- Export Controls -->
                    <StackPanel Grid.Row="2" Margin="0,8,0,0">
                        <Button Content="💾 Export Transformed" 
                                Command="{Binding ExportTransformedCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" 
                                IsEnabled="{Binding HasTransformedVideo}"/>
                        <Button Content="🔄 Compare Side-by-Side" 
                                Command="{Binding CompareVideosCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" Margin="0,4,0,0" 
                                IsEnabled="{Binding HasBothVideos}"/>
                        <Button Content="📋 Copy Settings" 
                                Command="{Binding CopySettingsCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" Margin="0,4,0,0"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </DataTemplate>
<!-- removed stray closing ResourceDictionary -->
    <DataTemplate x:Key="MotionControlTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="380"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>
            
            <!-- Motion Engineering Panel -->
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="8,0,0,8" Padding="12">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="🎥 Motion Control Engine" 
                                   Style="{DynamicResource HeadingSmallStyle}"
                                   Foreground="{DynamicResource AccentRedBrush}"
                                   Margin="0,0,0,12"/>
                        
                        <!-- Camera Motion Controls -->
                        <Expander Header="📷 Camera Motion" IsExpanded="True" FontSize="11" Margin="0,0,0,8">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Motion Type:" FontSize="10" Margin="0,0,0,4"/>
                                <ComboBox Style="{DynamicResource DarkComboBoxStyle}" FontSize="10" Margin="0,0,0,8">
                                    <ComboBoxItem Content="Static Camera"/>
                                    <ComboBoxItem Content="Pan Left/Right" IsSelected="True"/>
                                    <ComboBoxItem Content="Tilt Up/Down"/>
                                    <ComboBoxItem Content="Zoom In/Out"/>
                                    <ComboBoxItem Content="Dolly Track"/>
                                    <ComboBoxItem Content="Orbital Rotation"/>
                                    <ComboBoxItem Content="Handheld Shake"/>
                                    <ComboBoxItem Content="Custom Path"/>
                                </ComboBox>
                                
                                <TextBlock Text="Motion Intensity" FontSize="10" Margin="0,0,0,2"/>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Value="{Binding CameraMotionIntensity}" 
                                            Minimum="0" Maximum="2" 
                                            TickFrequency="0.1" 
                                            TickPlacement="BottomRight"/>
                                    <TextBlock Grid.Column="1" 
                                               Text="{Binding CameraMotionIntensity, StringFormat=F1}" 
                                               FontSize="10" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"/>
                                </Grid>
                                
                                <TextBlock Text="Motion Speed" FontSize="10" Margin="0,0,0,2"/>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Value="{Binding MotionSpeed}" 
                                            Minimum="0.1" Maximum="5" 
                                            TickFrequency="0.1" 
                                            TickPlacement="BottomRight"/>
                                    <TextBlock Grid.Column="1" 
                                               Text="{Binding MotionSpeed, StringFormat=F1}" 
                                               FontSize="10" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"/>
                                </Grid>
                                
                                <CheckBox Content="Motion Blur" FontSize="10" 
                                          IsChecked="{Binding EnableMotionBlur}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                                <CheckBox Content="Smooth Transitions" FontSize="10" 
                                          IsChecked="{Binding SmoothTransitions}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Object Motion Tracking -->
                        <Expander Header="🎯 Object Motion Tracking" IsExpanded="True" FontSize="11" Margin="0,0,0,8">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Motion Description:" FontSize="10" Margin="0,0,0,2"/>
                                <TextBox Text="{Binding ObjectMotionPrompt}" 
                                         Background="{DynamicResource TertiaryDarkBrush}"
                                         Foreground="{DynamicResource TextPrimaryBrush}"
                                         MinHeight="60" TextWrapping="Wrap" AcceptsReturn="True"
                                         FontSize="11" Margin="0,0,0,8"/>
                                
                                <TextBlock Text="Focus Object:" FontSize="10" Margin="0,0,0,2"/>
                                <TextBox Text="{Binding FocusObject}" 
                                         Background="{DynamicResource TertiaryDarkBrush}"
                                         Foreground="{DynamicResource TextPrimaryBrush}"
                                         FontSize="11" Margin="0,0,0,8"
                                         ToolTip="Describe what object to track (person, car, etc)"/>
                                
                                <TextBlock Text="Motion Path Type:" FontSize="10" Margin="0,0,0,4"/>
                                <ComboBox Style="{DynamicResource DarkComboBoxStyle}" FontSize="10" Margin="0,0,0,8">
                                    <ComboBoxItem Content="Linear Movement"/>
                                    <ComboBoxItem Content="Circular Path" IsSelected="True"/>
                                    <ComboBoxItem Content="Pendulum Swing"/>
                                    <ComboBoxItem Content="Spiral Motion"/>
                                    <ComboBoxItem Content="Random Walk"/>
                                    <ComboBoxItem Content="Bezier Curve"/>
                                    <ComboBoxItem Content="Physics Simulation"/>
                                </ComboBox>
                                
                                <CheckBox Content="Auto-Track Primary Object" FontSize="10" 
                                          IsChecked="{Binding AutoTrackPrimaryObject}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                                <CheckBox Content="Maintain Focus" FontSize="10" 
                                          IsChecked="{Binding MaintainFocus}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Advanced Motion Physics -->
                        <Expander Header="⚙️ Motion Physics Engine" IsExpanded="False" FontSize="11" Margin="0,0,0,8">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Gravity Influence" FontSize="10" Margin="0,0,0,2"/>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Value="{Binding GravityInfluence}" 
                                            Minimum="-2" Maximum="2" 
                                            TickFrequency="0.1" 
                                            TickPlacement="BottomRight"/>
                                    <TextBlock Grid.Column="1" 
                                               Text="{Binding GravityInfluence, StringFormat=F1}" 
                                               FontSize="10" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"/>
                                </Grid>
                                
                                <TextBlock Text="Wind/Turbulence" FontSize="10" Margin="0,0,0,2"/>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Value="{Binding TurbulenceStrength}" 
                                            Minimum="0" Maximum="1" 
                                            TickFrequency="0.1" 
                                            TickPlacement="BottomRight"/>
                                    <TextBlock Grid.Column="1" 
                                               Text="{Binding TurbulenceStrength, StringFormat=F1}" 
                                               FontSize="10" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"/>
                                </Grid>
                                
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Physics Timestep (ms)" FontSize="10" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding PhysicsTimestep}" FontSize="10" 
                                             Background="{DynamicResource TertiaryDarkBrush}"/>
                                </Grid>
                                
                                <CheckBox Content="Enable Collision Detection" FontSize="10" 
                                          IsChecked="{Binding EnableCollisionDetection}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                                <CheckBox Content="Apply Motion Dampening" FontSize="10" 
                                          IsChecked="{Binding ApplyMotionDampening}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Generation Controls -->
                        <Button Content="🚀 Generate Motion" 
                                Command="{Binding GenerateMotionCommand}"
                                Style="{DynamicResource PrimaryButtonStyle}"
                                Padding="0,12" FontSize="12" FontWeight="SemiBold"
                                Margin="0,12,0,8"/>
                        
                        <Button Content="📋 Load Motion Preset" 
                                Command="{Binding LoadMotionPresetCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" Margin="0,0,0,4"/>
                                
                        <Button Content="💾 Save Motion Preset" 
                                Command="{Binding SaveMotionPresetCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>
            
            <!-- Motion Path Visualization and Preview -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" 
                    Padding="16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="200"/>
                        <RowDefinition Height="8"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Motion Path Canvas -->
                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="4" Padding="8">
                        <Grid>
                            <Canvas x:Name="MotionPathCanvas" 
                                    Background="{DynamicResource SecondaryDarkBrush}"
                                    AllowDrop="True">
                                <!-- Motion path visualization will be drawn here programmatically -->
                            </Canvas>
                            
                            <StackPanel HorizontalAlignment="Right" 
                                       VerticalAlignment="Top" 
                                       Margin="8" 
                                       Orientation="Horizontal">
                                <TextBlock Text="📍 Motion Path Designer" 
                                           FontSize="11" 
                                           Foreground="{DynamicResource TextSecondaryBrush}" 
                                           Margin="0,0,8,0"/>
                                <Button Content="Clear" 
                                        Command="{Binding ClearMotionPathCommand}"
                                        Style="{DynamicResource SecondaryButtonStyle}"
                                        Padding="8,4" FontSize="10"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- Separator -->
                    <Border Grid.Row="1" Background="{DynamicResource BorderBrush}"/>
                    
                    <!-- Video Preview with Motion Overlay -->
                    <Border Grid.Row="2" Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="4">
                        <Grid>
                            <MediaElement Source="{Binding MotionPreviewSource}" 
                                          LoadedBehavior="Manual"
                                          Stretch="Uniform"
                                          Visibility="{Binding HasMotionPreview, Converter={StaticResource BoolToVisibility}}"/>
                            
                            <StackPanel HorizontalAlignment="Center" 
                                       VerticalAlignment="Center"
                                       Visibility="{Binding HasMotionPreview, Converter={StaticResource BoolToVisibility}, ConverterParameter=Inverted}">
                                <TextBlock Text="🎬" FontSize="48" 
                                           HorizontalAlignment="Center" 
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="Motion Preview" 
                                           FontSize="16" 
                                           HorizontalAlignment="Center" 
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="Visualize your motion paths here" 
                                           FontSize="12" 
                                           HorizontalAlignment="Center" 
                                           Foreground="{DynamicResource TextMutedBrush}" 
                                           Margin="0,4,0,0"/>
                            </StackPanel>
                            
                            <!-- Motion Generation Progress -->
                            <Border Background="{DynamicResource PrimaryDarkBrush}" 
                                    Opacity="0.9" 
                                    CornerRadius="4" 
                                    Visibility="{Binding IsGeneratingMotion, Converter={StaticResource BoolToVisibility}}">
                                <StackPanel HorizontalAlignment="Center" 
                                           VerticalAlignment="Center">
                                    <TextBlock Text="⚙️ Generating Motion..." 
                                               FontSize="18" 
                                               FontWeight="SemiBold" 
                                               HorizontalAlignment="Center" 
                                               Margin="0,0,0,12"/>
                                    <ProgressBar Value="{Binding MotionGenerationProgress}" 
                                                 Width="350" Height="8" 
                                                 Margin="0,0,0,12"/>
                                    <TextBlock Text="{Binding MotionGenerationStatus}" 
                                               FontSize="12" 
                                               HorizontalAlignment="Center" 
                                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Border>
                    
                    <!-- Motion Playback Controls -->
                    <StackPanel Grid.Row="3" Orientation="Horizontal" 
                               HorizontalAlignment="Center" 
                               Margin="0,8,0,0"
                               Visibility="{Binding HasMotionPreview, Converter={StaticResource BoolToVisibility}}">
                        <Button Content="▶️" Command="{Binding PlayMotionCommand}" 
                                Style="{DynamicResource SecondaryButtonStyle}" 
                                Width="40" Height="32" FontSize="12" Margin="0,0,4,0"/>
                        <Button Content="⏸️" Command="{Binding PauseMotionCommand}" 
                                Style="{DynamicResource SecondaryButtonStyle}" 
                                Width="40" Height="32" FontSize="12" Margin="0,0,4,0"/>
                        <Button Content="⏹️" Command="{Binding StopMotionCommand}" 
                                Style="{DynamicResource SecondaryButtonStyle}" 
                                Width="40" Height="32" FontSize="12" Margin="0,0,8,0"/>
                        <CheckBox Content="Loop Motion" FontSize="11" 
                                  IsChecked="{Binding LoopMotion}" 
                                  Style="{DynamicResource DarkCheckBoxStyle}" 
                                  VerticalAlignment="Center" Margin="8,0,8,0"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="Frame: " FontSize="11" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <TextBlock Text="{Binding CurrentMotionFrame}" FontSize="11" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <TextBlock Text="/" FontSize="11" Foreground="{DynamicResource TextSecondaryBrush}" Margin="2,0"/>
                            <TextBlock Text="{Binding TotalMotionFrames}" FontSize="11" Foreground="{DynamicResource TextSecondaryBrush}"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- Motion Presets and Analysis Panel -->
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="0,8,8,0" Padding="12">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="200"/>
                        <RowDefinition Height="8"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Motion Presets Header -->
                    <TextBlock Grid.Row="0" Text="🎨 Motion Presets" 
                               Style="{DynamicResource HeadingSmallStyle}"
                               Foreground="{DynamicResource AccentRedBrush}"
                               Margin="0,0,0,12"/>
                    
                    <!-- Motion Presets List -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <ItemsControl ItemsSource="{Binding MotionPresets}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Button Background="{DynamicResource TertiaryDarkBrush}" 
                                            BorderBrush="{DynamicResource BorderBrush}" 
                                            BorderThickness="1" 
                                            Padding="8" 
                                            Margin="0,0,0,6" 
                                            HorizontalAlignment="Stretch" 
                                            HorizontalContentAlignment="Left"
                                            Command="{Binding DataContext.SelectMotionPresetCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                            CommandParameter="{Binding}">
                                        <StackPanel>
                                            <TextBlock Text="{Binding Name}" 
                                                       FontSize="11" 
                                                       FontWeight="SemiBold" 
                                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                                            <TextBlock Text="{Binding Description}" 
                                                       FontSize="10" 
                                                       Foreground="{DynamicResource TextSecondaryBrush}" 
                                                       TextTrimming="CharacterEllipsis"/>
                                            <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                                <TextBlock Text="Duration: " FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                <TextBlock Text="{Binding Duration}" FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                <TextBlock Text="s | Speed: " FontSize="9" Foreground="{DynamicResource TextMutedBrush}" Margin="2,0"/>
                                                <TextBlock Text="{Binding Speed}" FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                <TextBlock Text="x" FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Button>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    
                    <!-- Separator -->
                    <Border Grid.Row="2" Background="{DynamicResource BorderBrush}"/>
                    
                    <!-- Motion Analysis -->
                    <ScrollViewer Grid.Row="3" VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBlock Text="📊 Motion Analysis" 
                                       Style="{DynamicResource HeadingSmallStyle}"
                                       Foreground="{DynamicResource AccentRedBrush}"
                                       Margin="0,8,0,12"/>
                            
                            <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                    CornerRadius="4" Padding="8" Margin="0,0,0,8">
                                <StackPanel>
                                    <TextBlock Text="Motion Metrics:" FontSize="10" FontWeight="SemiBold" Margin="0,0,0,4"/>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Smoothness: " FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <TextBlock Text="{Binding MotionSmoothness, StringFormat=P0}" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Complexity: " FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <TextBlock Text="{Binding MotionComplexity}" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <TextBlock Text="/10" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Path Length: " FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <TextBlock Text="{Binding PathLength, StringFormat=F1}" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <TextBlock Text=" units" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Avg Speed: " FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <TextBlock Text="{Binding AverageSpeed, StringFormat=F2}" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <TextBlock Text=" u/s" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            
                            <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                    CornerRadius="4" Padding="8">
                                <StackPanel>
                                    <TextBlock Text="Performance Impact:" FontSize="10" FontWeight="SemiBold" Margin="0,0,0,4"/>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="VRAM Usage: " FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <TextBlock Text="{Binding EstimatedVRAMUsage}" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <TextBlock Text="MB" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Render Time: ~" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <TextBlock Text="{Binding EstimatedRenderTime}" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <TextBlock Text="s" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Quality Loss: " FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <TextBlock Text="{Binding QualityLoss, StringFormat=P0}" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                    
                    <!-- Export Controls -->
                    <StackPanel Grid.Row="4" Margin="0,8,0,0">
                        <Button Content="💾 Export Motion Data" 
                                Command="{Binding ExportMotionDataCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" 
                                IsEnabled="{Binding HasMotionPreview}"/>
                        <Button Content="📐 Import Motion Config" 
                                Command="{Binding ImportMotionConfigCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" Margin="0,4,0,0"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </DataTemplate>
<!-- removed stray closing ResourceDictionary -->
    <DataTemplate x:Key="TemporalEffectsTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="380"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>
            
            <!-- Temporal Processing Controls -->
            <Border Grid.Column="0" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="8,0,0,8" Padding="12">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="⏱️ Temporal Effects Engine" 
                                   Style="{DynamicResource HeadingSmallStyle}"
                                   Foreground="{DynamicResource AccentRedBrush}"
                                   Margin="0,0,0,12"/>
                        
                        <!-- Time Manipulation -->
                        <Expander Header="⏳ Time Manipulation" IsExpanded="True" FontSize="11" Margin="0,0,0,8">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Effect Type:" FontSize="10" Margin="0,0,0,4"/>
                                <ComboBox Style="{DynamicResource DarkComboBoxStyle}" FontSize="10" Margin="0,0,0,8">
                                    <ComboBoxItem Content="Speed Ramping" IsSelected="True"/>
                                    <ComboBoxItem Content="Time Freeze"/>
                                    <ComboBoxItem Content="Reverse Motion"/>
                                    <ComboBoxItem Content="Loop Segment"/>
                                    <ComboBoxItem Content="Temporal Echo"/>
                                    <ComboBoxItem Content="Time-lapse"/>
                                    <ComboBoxItem Content="Slow Motion"/>
                                    <ComboBoxItem Content="Variable Speed"/>
                                </ComboBox>
                                
                                <TextBlock Text="Speed Multiplier" FontSize="10" Margin="0,0,0,2"/>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Value="{Binding SpeedMultiplier}" 
                                            Minimum="0.1" Maximum="10" 
                                            TickFrequency="0.1" 
                                            TickPlacement="BottomRight"/>
                                    <TextBlock Grid.Column="1" 
                                               Text="{Binding SpeedMultiplier, StringFormat='F1x'}" 
                                               FontSize="10" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"/>
                                </Grid>
                                
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Transition Duration (s)" FontSize="10" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding TransitionDuration}" FontSize="10" 
                                             Background="{DynamicResource TertiaryDarkBrush}"/>
                                </Grid>
                                
                                <TextBlock Text="Timing Curve:" FontSize="10" Margin="0,0,0,4"/>
                                <ComboBox Style="{DynamicResource DarkComboBoxStyle}" FontSize="10" Margin="0,0,0,8">
                                    <ComboBoxItem Content="Linear"/>
                                    <ComboBoxItem Content="Ease In" IsSelected="True"/>
                                    <ComboBoxItem Content="Ease Out"/>
                                    <ComboBoxItem Content="Ease In-Out"/>
                                    <ComboBoxItem Content="Bounce"/>
                                    <ComboBoxItem Content="Elastic"/>
                                    <ComboBoxItem Content="Custom Bezier"/>
                                </ComboBox>
                                
                                <CheckBox Content="Maintain Audio Sync" FontSize="10" 
                                          IsChecked="{Binding MaintainAudioSync}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                                <CheckBox Content="Frame Interpolation" FontSize="10" 
                                          IsChecked="{Binding EnableFrameInterpolation}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Frame Processing -->
                        <Expander Header="🖼️ Frame Processing" IsExpanded="True" FontSize="11" Margin="0,0,0,8">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Interpolation Method:" FontSize="10" Margin="0,0,0,4"/>
                                <ComboBox Style="{DynamicResource DarkComboBoxStyle}" FontSize="10" Margin="0,0,0,8">
                                    <ComboBoxItem Content="Optical Flow" IsSelected="True"/>
                                    <ComboBoxItem Content="AI Upscaling (RIFE)"/>
                                    <ComboBoxItem Content="Motion Compensated"/>
                                    <ComboBoxItem Content="Pixel-based Blending"/>
                                    <ComboBoxItem Content="Deep Learning (DAIN)"/>
                                    <ComboBoxItem Content="Traditional Blending"/>
                                </ComboBox>
                                
                                <TextBlock Text="Quality vs Speed" FontSize="10" Margin="0,0,0,2"/>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Value="{Binding InterpolationQuality}" 
                                            Minimum="1" Maximum="10" 
                                            TickFrequency="1" 
                                            TickPlacement="BottomRight" 
                                            IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" 
                                               Text="{Binding InterpolationQuality, StringFormat=F0}" 
                                               FontSize="10" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"/>
                                </Grid>
                                
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Motion Threshold" FontSize="10" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding MotionThreshold}" FontSize="10" 
                                             Background="{DynamicResource TertiaryDarkBrush}"/>
                                </Grid>
                                
                                <CheckBox Content="Artifact Reduction" FontSize="10" 
                                          IsChecked="{Binding EnableArtifactReduction}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                                <CheckBox Content="Edge Preservation" FontSize="10" 
                                          IsChecked="{Binding PreserveEdges}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                                <CheckBox Content="Temporal Denoising" FontSize="10" 
                                          IsChecked="{Binding EnableTemporalDenoising}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Stabilization and Correction -->
                        <Expander Header="📷 Stabilization &amp; Correction" IsExpanded="False" FontSize="11" Margin="0,0,0,8">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Stabilization Mode:" FontSize="10" Margin="0,0,0,4"/>
                                <ComboBox Style="{DynamicResource DarkComboBoxStyle}" FontSize="10" Margin="0,0,0,8">
                                    <ComboBoxItem Content="None"/>
                                    <ComboBoxItem Content="Basic Smoothing" IsSelected="True"/>
                                    <ComboBoxItem Content="Advanced Warp"/>
                                    <ComboBoxItem Content="AI-based Stabilization"/>
                                    <ComboBoxItem Content="Multi-point Tracking"/>
                                </ComboBox>
                                
                                <TextBlock Text="Stabilization Strength" FontSize="10" Margin="0,0,0,2"/>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Value="{Binding StabilizationStrength}" 
                                            Minimum="0" Maximum="1" 
                                            TickFrequency="0.1" 
                                            TickPlacement="BottomRight"/>
                                    <TextBlock Grid.Column="1" 
                                               Text="{Binding StabilizationStrength, StringFormat=F1}" 
                                               FontSize="10" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"/>
                                </Grid>
                                
                                <TextBlock Text="Rolling Shutter Correction" FontSize="10" Margin="0,0,0,2"/>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Value="{Binding RollingShutterCorrection}" 
                                            Minimum="0" Maximum="1" 
                                            TickFrequency="0.1" 
                                            TickPlacement="BottomRight"/>
                                    <TextBlock Grid.Column="1" 
                                               Text="{Binding RollingShutterCorrection, StringFormat=F1}" 
                                               FontSize="10" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"/>
                                </Grid>
                                
                                <CheckBox Content="Auto-detect Camera Shake" FontSize="10" 
                                          IsChecked="{Binding AutoDetectCameraShake}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                                <CheckBox Content="Crop to Stable Region" FontSize="10" 
                                          IsChecked="{Binding CropToStableRegion}" 
                                          Style="{DynamicResource DarkCheckBoxStyle}" Margin="0,4,0,0"/>
                            </StackPanel>
                        </Expander>
                        
                        <!-- Processing Controls -->
                        <Button Content="🚀 Apply Effects" 
                                Command="{Binding ApplyEffectsCommand}"
                                Style="{DynamicResource PrimaryButtonStyle}"
                                Padding="0,12" FontSize="12" FontWeight="SemiBold"
                                Margin="0,12,0,8"/>
                        
                        <Button Content="🔄 Preview Effects" 
                                Command="{Binding PreviewEffectsCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" Margin="0,0,0,4"/>
                                
                        <Button Content="⏹️ Stop Processing" 
                                Command="{Binding StopProcessingCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" IsEnabled="{Binding IsProcessing}"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>
            
            <!-- Timeline and Effects Preview -->
            <Border Grid.Column="1" Background="{DynamicResource PrimaryDarkBrush}" 
                    Padding="16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="120"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="80"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Effects Preview -->
                    <Border Background="{DynamicResource TertiaryDarkBrush}" 
                            CornerRadius="4" 
                            Margin="0,0,0,8">
                        <Grid>
                            <MediaElement Source="{Binding EffectsPreviewSource}" 
                                          LoadedBehavior="Manual"
                                          Stretch="Uniform"
                                          Visibility="{Binding HasEffectsPreview, Converter={StaticResource BoolToVisibility}}"/>
                            
                            <StackPanel HorizontalAlignment="Center" 
                                       VerticalAlignment="Center"
                                       Visibility="{Binding HasEffectsPreview, Converter={StaticResource BoolToVisibility}, ConverterParameter=Inverted}">
                                <TextBlock Text="⏱️" FontSize="48" 
                                           HorizontalAlignment="Center" 
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="Temporal Effects Preview" 
                                           FontSize="16" 
                                           HorizontalAlignment="Center" 
                                           Foreground="{DynamicResource TextMutedBrush}"/>
                                <TextBlock Text="Apply effects to see preview" 
                                           FontSize="12" 
                                           HorizontalAlignment="Center" 
                                           Foreground="{DynamicResource TextMutedBrush}" 
                                           Margin="0,4,0,0"/>
                            </StackPanel>
                            
                            <!-- Processing Progress -->
                            <Border Background="{DynamicResource PrimaryDarkBrush}" 
                                    Opacity="0.9" 
                                    CornerRadius="4" 
                                    Visibility="{Binding IsProcessing, Converter={StaticResource BoolToVisibility}}">
                                <StackPanel HorizontalAlignment="Center" 
                                           VerticalAlignment="Center">
                                    <TextBlock Text="⚙️ Processing Effects..." 
                                               FontSize="18" 
                                               FontWeight="SemiBold" 
                                               HorizontalAlignment="Center" 
                                               Margin="0,0,0,12"/>
                                    <ProgressBar Value="{Binding ProcessingProgress}" 
                                                 Width="350" Height="8" 
                                                 Margin="0,0,0,12"/>
                                    <TextBlock Text="{Binding ProcessingStatus}" 
                                               FontSize="12" 
                                               HorizontalAlignment="Center" 
                                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Border>
                    
                    <!-- Timeline Scrubber -->
                    <Border Grid.Row="1" Background="{DynamicResource SecondaryDarkBrush}" 
                            CornerRadius="4" Padding="12" Margin="0,0,0,8">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Text="📉 Timeline Effects" 
                                       FontSize="12" FontWeight="SemiBold" 
                                       Foreground="{DynamicResource AccentRedBrush}" 
                                       Margin="0,0,0,8"/>
                            
                            <!-- Timeline Canvas -->
                            <Canvas Grid.Row="1" x:Name="TimelineCanvas" 
                                    Background="{DynamicResource TertiaryDarkBrush}" 
                                    Height="50">
                                <!-- Timeline effects visualization will be drawn here -->
                            </Canvas>
                            
                            <!-- Timeline Controls -->
                            <StackPanel Grid.Row="2" Orientation="Horizontal" 
                                       Margin="0,8,0,0">
                                <TextBlock Text="Frame: " FontSize="11" 
                                           VerticalAlignment="Center" 
                                           Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <TextBox Text="{Binding CurrentFrame}" 
                                         Width="60" FontSize="11" 
                                         Background="{DynamicResource TertiaryDarkBrush}" 
                                         Margin="0,0,8,0"/>
                                <TextBlock Text="/ {Binding TotalFrames}" FontSize="11" 
                                           VerticalAlignment="Center" 
                                           Foreground="{DynamicResource TextSecondaryBrush}" 
                                           Margin="0,0,16,0"/>
                                
                                <Button Content="◀◀" Command="{Binding FirstFrameCommand}" 
                                        Style="{DynamicResource SecondaryButtonStyle}" 
                                        Width="30" Height="24" FontSize="10" Margin="0,0,2,0"/>
                                <Button Content="◀" Command="{Binding PreviousFrameCommand}" 
                                        Style="{DynamicResource SecondaryButtonStyle}" 
                                        Width="30" Height="24" FontSize="10" Margin="0,0,2,0"/>
                                <Button Content="▶" Command="{Binding NextFrameCommand}" 
                                        Style="{DynamicResource SecondaryButtonStyle}" 
                                        Width="30" Height="24" FontSize="10" Margin="0,0,2,0"/>
                                <Button Content="▶▶" Command="{Binding LastFrameCommand}" 
                                        Style="{DynamicResource SecondaryButtonStyle}" 
                                        Width="30" Height="24" FontSize="10"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- Standard Playback Controls -->
                    <StackPanel Grid.Row="2" Orientation="Horizontal" 
                               HorizontalAlignment="Center" 
                               Margin="0,0,0,8"
                               Visibility="{Binding HasEffectsPreview, Converter={StaticResource BoolToVisibility}}">
                        <Button Content="▶️" Command="{Binding PlayCommand}" 
                                Style="{DynamicResource SecondaryButtonStyle}" 
                                Width="40" Height="32" FontSize="12" Margin="0,0,4,0"/>
                        <Button Content="⏸️" Command="{Binding PauseCommand}" 
                                Style="{DynamicResource SecondaryButtonStyle}" 
                                Width="40" Height="32" FontSize="12" Margin="0,0,4,0"/>
                        <Button Content="⏹️" Command="{Binding StopCommand}" 
                                Style="{DynamicResource SecondaryButtonStyle}" 
                                Width="40" Height="32" FontSize="12" Margin="0,0,8,0"/>
                        <CheckBox Content="Loop" FontSize="11" 
                                  IsChecked="{Binding LoopPlayback}" 
                                  Style="{DynamicResource DarkCheckBoxStyle}" 
                                  VerticalAlignment="Center" Margin="8,0,0,0"/>
                    </StackPanel>
                    
                    <!-- Performance Metrics -->
                    <Border Grid.Row="3" Background="{DynamicResource SecondaryDarkBrush}" 
                            CornerRadius="4" Padding="8">
                        <StackPanel>
                            <TextBlock Text="📊 Performance Metrics" 
                                       FontSize="11" FontWeight="SemiBold" 
                                       Foreground="{DynamicResource AccentRedBrush}" 
                                       Margin="0,0,0,6"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel>
                                    <TextBlock Text="Processing Speed:" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding ProcessingSpeed, StringFormat=F1}" FontSize="11" FontWeight="SemiBold"/>
                                        <TextBlock Text="x" FontSize="11" FontWeight="SemiBold"/>
                                    </StackPanel>
                                </StackPanel>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="VRAM Usage:" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding VRAMUsage}" FontSize="11" FontWeight="SemiBold"/>
                                        <TextBlock Text="MB" FontSize="11" FontWeight="SemiBold"/>
                                    </StackPanel>
                                </StackPanel>
                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="ETA:" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <TextBlock Text="{Binding EstimatedTimeRemaining}" FontSize="11" FontWeight="SemiBold"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>
            
            <!-- Effects Library and Export Panel -->
            <Border Grid.Column="2" Background="{DynamicResource SecondaryDarkBrush}" 
                    CornerRadius="0,8,8,0" Padding="12">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="200"/>
                        <RowDefinition Height="8"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Effects Library Header -->
                    <TextBlock Grid.Row="0" Text="🎨 Effects Library" 
                               Style="{DynamicResource HeadingSmallStyle}"
                               Foreground="{DynamicResource AccentRedBrush}"
                               Margin="0,0,0,12"/>
                    
                    <!-- Effects Presets List -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <ItemsControl ItemsSource="{Binding EffectsPresets}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Button Background="{DynamicResource TertiaryDarkBrush}" 
                                            BorderBrush="{DynamicResource BorderBrush}" 
                                            BorderThickness="1" 
                                            Padding="8" 
                                            Margin="0,0,0,6" 
                                            HorizontalAlignment="Stretch" 
                                            HorizontalContentAlignment="Left"
                                            Command="{Binding DataContext.SelectEffectsPresetCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                            CommandParameter="{Binding}">
                                        <StackPanel>
                                            <TextBlock Text="{Binding Name}" 
                                                       FontSize="11" 
                                                       FontWeight="SemiBold" 
                                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                                            <TextBlock Text="{Binding Description}" 
                                                       FontSize="10" 
                                                       Foreground="{DynamicResource TextSecondaryBrush}" 
                                                       TextTrimming="CharacterEllipsis"/>
                                            <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                                <TextBlock Text="{Binding EffectType}" FontSize="9" 
                                                           Foreground="{DynamicResource TextMutedBrush}" 
                                                           Margin="0,0,8,0"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,8,0">
                                                    <TextBlock Text="CPU: " FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="{Binding CPUIntensity}" FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="/5" FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="GPU: " FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="{Binding GPUIntensity}" FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                    <TextBlock Text="/5" FontSize="9" Foreground="{DynamicResource TextMutedBrush}"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </StackPanel>
                                    </Button>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    
                    <!-- Separator -->
                    <Border Grid.Row="2" Background="{DynamicResource BorderBrush}"/>
                    
                    <!-- Processing Queue and History -->
                    <ScrollViewer Grid.Row="3" VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBlock Text="🗂️ Processing History" 
                                       Style="{DynamicResource HeadingSmallStyle}"
                                       Foreground="{DynamicResource AccentRedBrush}"
                                       Margin="0,8,0,12"/>
                            
                            <ItemsControl ItemsSource="{Binding ProcessingHistory}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{DynamicResource TertiaryDarkBrush}" 
                                                CornerRadius="4" Padding="8" Margin="0,0,0,8">
                                            <StackPanel>
                                                <TextBlock Text="{Binding Timestamp, StringFormat=HH:mm:ss}" 
                                                           FontSize="10" 
                                                           Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                <TextBlock Text="{Binding EffectName}" 
                                                           FontSize="11" 
                                                           FontWeight="SemiBold"/>
                                                <TextBlock Text="{Binding Settings}" 
                                                           FontSize="10" 
                                                           Foreground="{DynamicResource TextSecondaryBrush}" 
                                                           TextTrimming="CharacterEllipsis" 
                                                           MaxHeight="30" 
                                                           TextWrapping="Wrap"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                    <TextBlock Text="Time: {Binding ProcessingTime}" FontSize="10" 
                                                               Foreground="{DynamicResource TextMutedBrush}" 
                                                               Margin="0,0,8,0"/>
                                                    <TextBlock Text="Frames: {Binding FrameCount}" FontSize="10" 
                                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </ScrollViewer>
                    
                    <!-- Export Controls -->
                    <StackPanel Grid.Row="4" Margin="0,8,0,0">
                        <Button Content="💾 Export Processed Video" 
                                Command="{Binding ExportProcessedVideoCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" 
                                IsEnabled="{Binding HasProcessedVideo}"/>
                        <Button Content="📋 Copy Effect Settings" 
                                Command="{Binding CopyEffectSettingsCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" Margin="0,4,0,0"/>
                        <Button Content="🔄 Apply to New Video" 
                                Command="{Binding ApplyToNewVideoCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" Margin="0,4,0,0"/>
                        <Button Content="🗑️ Clear History" 
                                Command="{Binding ClearHistoryCommand}"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="0,8" FontSize="11" Margin="0,4,0,0"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </DataTemplate>
<!-- removed stray closing ResourceDictionary -->
<DataTemplate x:Key="DeveloperDashboardViewModelTemplate">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/> <!-- Main Dashboard -->
            <ColumnDefinition Width="1*"/> <!-- Debug Panel -->
        </Grid.ColumnDefinitions>
        
        <!-- Main Dashboard Column -->
        <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto" Margin="0,0,8,0">
            <Grid Margin="16">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/> <!-- Performance Metrics -->
                    <RowDefinition Height="Auto"/> <!-- System Telemetry -->
                    <RowDefinition Height="Auto"/> <!-- All Quick Actions -->
                    <RowDefinition Height="*"/>    <!-- Activity Grid -->
                </Grid.RowDefinitions>

                <!-- Real-time Performance Metrics -->
                <Border Grid.Row="0" Style="{StaticResource DarkCardStyle}" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="⚡ Real-time Performance" Style="{StaticResource HeadingMediumStyle}" Margin="0,0,0,12"/>
                        <UniformGrid Columns="4">
                            <!-- GPU Utilization -->
                            <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,8,0">
                                <StackPanel>
                                    <TextBlock Text="🎮 GPU" Style="{StaticResource CaptionTextStyle}" HorizontalAlignment="Center"/>
                                    <TextBlock Text="{Binding GpuUtilization}" Style="{StaticResource HeadingLargeStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                    <ProgressBar Value="{Binding GpuUtilizationValue}" Maximum="100" Height="4" Margin="0,8,0,0"/>
                                </StackPanel>
                            </Border>
                            <!-- VRAM Usage -->
                            <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12" Margin="4,0">
                                <StackPanel>
                                    <TextBlock Text="🧠 VRAM" Style="{StaticResource CaptionTextStyle}" HorizontalAlignment="Center"/>
                                    <TextBlock Text="{Binding VramUsage}" Style="{StaticResource HeadingLargeStyle}" Foreground="{DynamicResource AccentRedBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                    <ProgressBar Value="{Binding VramPercentage}" Maximum="100" Height="4" Margin="0,8,0,0"/>
                                </StackPanel>
                            </Border>
                            <!-- Token Speed -->
                            <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12" Margin="4,0">
                                <StackPanel>
                                    <TextBlock Text="⚡ Speed" Style="{StaticResource CaptionTextStyle}" HorizontalAlignment="Center"/>
                                    <TextBlock Text="{Binding TokensPerSecondDisplay}" Style="{StaticResource HeadingLargeStyle}" Foreground="{DynamicResource SuccessBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                    <TextBlock Text="↗️ Real-time" Style="{StaticResource CaptionTextStyle}" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <!-- Temperature -->
                            <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12" Margin="8,0,0,0">
                                <StackPanel>
                                    <TextBlock Text="🌡️ Temp" Style="{StaticResource CaptionTextStyle}" HorizontalAlignment="Center"/>
                                    <TextBlock Text="{Binding GpuTemperature}" Style="{StaticResource HeadingLargeStyle}" Foreground="{DynamicResource WarningBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                    <TextBlock Text="Normal" Style="{StaticResource CaptionTextStyle}" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                        </UniformGrid>
                    </StackPanel>
                </Border>

                <!-- System Telemetry -->
                <Border Grid.Row="1" Style="{StaticResource DarkCardStyle}" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="📊 System Telemetry" Style="{StaticResource HeadingMediumStyle}" Margin="0,0,0,12"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*"/>
                                <ColumnDefinition Width="1*"/>
                                <ColumnDefinition Width="1*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Left: Model Info -->
                            <StackPanel Grid.Column="0" Margin="0,0,12,0">
                                <TextBlock Text="Current Model" Style="{StaticResource CaptionTextStyle}" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding CurrentModelDisplay}" Style="{StaticResource CodeTextStyle}" Margin="0,4,0,0"/>
                                <TextBlock Text="Real-time model information" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                                <Separator Margin="0,8" Background="{DynamicResource BorderBrush}"/>
                                <TextBlock Text="Runner Status" Style="{StaticResource CaptionTextStyle}" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding CurrentRunnerDisplay}" Style="{StaticResource CodeTextStyle}" Margin="0,4,0,0"/>
                                <TextBlock Text="{Binding SystemStatus}" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            
                            <!-- Center: Memory Details -->
                            <StackPanel Grid.Column="1" Margin="6,0">
                                <TextBlock Text="Memory Allocation" Style="{StaticResource CaptionTextStyle}" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding VramUsage}" Style="{StaticResource BodyTextStyle}" Margin="0,4,0,0"/>
                                <TextBlock Text="Context: Dynamic" Style="{StaticResource BodyTextStyle}" Margin="0,2,0,0"/>
                                <TextBlock Text="KV Cache: Active" Style="{StaticResource BodyTextStyle}" Margin="0,2,0,0"/>
                                <TextBlock Text="System: Real-time" Style="{StaticResource BodyTextStyle}" Margin="0,2,0,0"/>
                                <Separator Margin="0,8" Background="{DynamicResource BorderBrush}"/>
                                <TextBlock Text="Network Status" Style="{StaticResource CaptionTextStyle}" FontWeight="SemiBold"/>
                                <TextBlock Text="API: http://localhost:11711" Style="{StaticResource CodeTextStyle}" Margin="0,4,0,0"/>
                                <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                    <TextBlock Text="Health: " Style="{StaticResource CaptionTextStyle}"/>
                                    <Ellipse Width="8" Height="8" Fill="{Binding SystemStatusColor}" Margin="4,0"/>
                                    <TextBlock Text="{Binding SystemStatus}" Style="{StaticResource CaptionTextStyle}" Margin="4,0,0,0"/>
                                </StackPanel>
                            </StackPanel>
                            
                            <!-- Right: Performance Stats -->
                            <StackPanel Grid.Column="2" Margin="12,0,0,0">
                                <TextBlock Text="Performance Metrics" Style="{StaticResource CaptionTextStyle}" FontWeight="SemiBold"/>
                                <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                    <TextBlock Text="Current: " Style="{StaticResource BodyTextStyle}"/>
                                    <TextBlock Text="{Binding TokensPerSecondDisplay}" Style="{StaticResource BodyTextStyle}" FontWeight="SemiBold"/>
                                </StackPanel>
                                <TextBlock Text="Queue Status:" Style="{StaticResource BodyTextStyle}" Margin="0,2,0,0"/>
                                <TextBlock Text="{Binding QueueStatus}" Style="{StaticResource BodyTextStyle}" Margin="8,2,0,0"/>
                                <TextBlock Text="Live Performance" Style="{StaticResource BodyTextStyle}" Margin="0,2,0,0"/>
                                <Separator Margin="0,8" Background="{DynamicResource BorderBrush}"/>
                                <TextBlock Text="System Health" Style="{StaticResource CaptionTextStyle}" FontWeight="SemiBold"/>
                                <TextBlock Text="CPU: 23% (8 cores)" Style="{StaticResource BodyTextStyle}" Margin="0,4,0,0"/>
                                <TextBlock Text="RAM: 12.4GB / 32GB" Style="{StaticResource BodyTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- All Quick Actions -->
                <Border Grid.Row="2" Style="{StaticResource DarkCardStyle}" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="🚀 Developer Actions" Style="{StaticResource HeadingMediumStyle}" Margin="0,0,0,12"/>
                        <!-- 8 Actions in 4x2 grid -->
                        <UniformGrid Columns="4" Rows="2">
                            <Button Content="💬 Chat" Style="{StaticResource PrimaryButtonStyle}" Margin="0,0,4,4" Padding="16,12"/>
                            <Button Content="🧠 Models" Style="{StaticResource SecondaryButtonStyle}" Margin="2,0,2,4" Padding="16,12"/>
                            <Button Content="🖼️ Images" Style="{StaticResource SecondaryButtonStyle}" Margin="2,0,2,4" Padding="16,12"/>
                            <Button Content="🎬 Video" Style="{StaticResource SecondaryButtonStyle}" Margin="4,0,0,4" Padding="16,12"/>
                            <Button Content="⏳ Jobs" Style="{StaticResource SecondaryButtonStyle}" Margin="0,2,4,0" Padding="16,12"/>
                            <Button Content="📊 Data" Style="{StaticResource SecondaryButtonStyle}" Margin="2,2,2,0" Padding="16,12"/>
                            <Button Content="🔧 Debug" Style="{StaticResource SecondaryButtonStyle}" Margin="2,2,2,0" Padding="16,12"/>
                            <Button Content="📈 Metrics" Style="{StaticResource SecondaryButtonStyle}" Margin="4,2,0,0" Padding="16,12"/>
                        </UniformGrid>
                    </StackPanel>
                </Border>

                <!-- Activity Timeline -->
                <Border Grid.Row="3" Style="{StaticResource DarkCardStyle}">
                    <StackPanel>
                        <TextBlock Text="📈 Activity Timeline" Style="{StaticResource HeadingMediumStyle}" Margin="0,0,0,16"/>
                        <!-- Timeline entries from RecentActivities binding -->
                        <ItemsControl ItemsSource="{Binding RecentActivities}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12,8" Margin="0,0,0,8">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" Text="{Binding Icon}" FontSize="16" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="{Binding Title}" Style="{StaticResource BodyTextStyle}" FontWeight="SemiBold"/>
                                                <TextBlock Text="{Binding Description}" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                                            </StackPanel>
                                            <TextBlock Grid.Column="2" Text="{Binding Timestamp, StringFormat='HH:mm'}" Style="{StaticResource CaptionTextStyle}" VerticalAlignment="Center"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </Border>
            </Grid>
        </ScrollViewer>
        
        <!-- Debug Panel Column -->
        <Border Grid.Column="1" Style="{StaticResource DarkCardStyle}" Margin="8,0,0,0">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="16">
                    <TextBlock Text="🔧 Debug Console" Style="{StaticResource HeadingMediumStyle}" Margin="0,0,0,16"/>
                    
                    <!-- Live Logs -->
                    <Border Background="{DynamicResource PrimaryDarkBrush}" 
                            BorderBrush="{DynamicResource BorderBrush}" 
                            BorderThickness="1" 
                            CornerRadius="4" 
                            Padding="12" 
                            Height="200" 
                            Margin="0,0,0,16">
                        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                            <TextBlock Style="{StaticResource CodeTextStyle}" FontSize="9">
                                <Run Text="[15:23:42] INFO: Received chat completion request" Foreground="{DynamicResource SuccessBrush}"/>
                                <LineBreak/>
                                <Run Text="[15:23:42] DEBUG: tokens=1247, temperature=0.7" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <LineBreak/>
                                <Run Text="[15:23:41] INFO: Model inference completed (38.4s)" Foreground="{DynamicResource SuccessBrush}"/>
                                <LineBreak/>
                                <Run Text="[15:22:03] WARN: High GPU temperature (67°C)" Foreground="{DynamicResource WarningBrush}"/>
                                <LineBreak/>
                                <Run Text="[15:20:15] INFO: Health check passed" Foreground="{DynamicResource SuccessBrush}"/>
                            </TextBlock>
                        </ScrollViewer>
                    </Border>
                    
                    <!-- API Endpoint Testing -->
                    <StackPanel Margin="0,0,0,16">
                        <TextBlock Text="🌐 API Testing" Style="{StaticResource HeadingSmallStyle}" Margin="0,0,0,8"/>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox Grid.Row="0" Grid.Column="0" Text="/v1/chat/completions" Style="{StaticResource DarkTextBoxStyle}" Margin="0,0,8,4"/>
                            <Button Grid.Row="0" Grid.Column="1" Content="TEST" Style="{StaticResource SecondaryButtonStyle}" Padding="12,4"/>
                            <TextBox Grid.Row="1" Grid.ColumnSpan="2" Text="/v1/models" Style="{StaticResource DarkTextBoxStyle}" Margin="0,4,0,0"/>
                        </Grid>
                    </StackPanel>
                    
                    <!-- Process Monitor -->
                    <StackPanel>
                        <TextBlock Text="⚙️ Process Monitor" Style="{StaticResource HeadingSmallStyle}" Margin="0,0,0,8"/>
                        <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="4" Padding="8">
                            <StackPanel>
                                <TextBlock Text="llama-server.exe" Style="{StaticResource CodeTextStyle}" FontWeight="SemiBold"/>
                                <TextBlock Text="PID: 15432" Style="{StaticResource CaptionTextStyle}"/>
                                <TextBlock Text="CPU: 23.4%" Style="{StaticResource CaptionTextStyle}"/>
                                <TextBlock Text="Memory: 4.2GB" Style="{StaticResource CaptionTextStyle}"/>
                                <TextBlock Text="Uptime: 2h 34m" Style="{StaticResource CaptionTextStyle}"/>
                                <UniformGrid Columns="2" Margin="0,8,0,0">
                                    <Button Content="Restart" Style="{StaticResource PrimaryButtonStyle}" Padding="8,4" Margin="0,0,4,0"/>
                                    <Button Content="Kill" Style="{StaticResource DangerButtonStyle}" Padding="8,4" Margin="4,0,0,0"/>
                                </UniformGrid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</DataTemplate>

<!-- Developer Chat Toolbar Template -->
<DataTemplate x:Key="ChatToolbarTemplate">
    <DockPanel LastChildFill="True" Margin="0,0,0,8">
        <StackPanel Orientation="Horizontal" DockPanel.Dock="Left">
            <TextBlock Text="Conversations" Style="{StaticResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" VerticalAlignment="Center"/>
        </StackPanel>
        <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
            <TextBlock Text="Endpoint" Style="{StaticResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" VerticalAlignment="Center"/>
            <TextBox Width="260" Margin="6,0,12,0" Style="{StaticResource DarkTextBoxStyle}" Text="http://localhost:11711/v1/chat"/>
            <TextBlock Text="Headers" Style="{StaticResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" VerticalAlignment="Center"/>
            <Button Content="Edit" Style="{StaticResource SecondaryButtonStyle}" Margin="6,0,0,0"/>
            <TextBlock Text="Logs" Style="{StaticResource CaptionTextStyle}" Foreground="{DynamicResource TextMutedBrush}" VerticalAlignment="Center" Margin="12,0,0,0"/>
            <Button Content="Open" Style="{StaticResource SecondaryButtonStyle}" Margin="6,0,0,0"/>
        </StackPanel>
    </DockPanel>
</DataTemplate>

<!-- Developer Chat Input Template -->
<DataTemplate x:Key="ChatInputTemplate">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <!-- Request Builder -->
        <Expander Grid.Row="0" Header="Request Payload (JSON)" Background="{DynamicResource SecondaryDarkBrush}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,8">
            <TextBox Text="{Binding UserInput, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkTextBoxMultilineStyle}" MinHeight="80" TextWrapping="Wrap" AcceptsReturn="True"/>
        </Expander>
        <!-- Input/Controls -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <TextBox Grid.Column="0"
                     Text="{Binding UserInput, UpdateSourceTrigger=PropertyChanged}"
                     Style="{StaticResource DarkTextBoxMultilineStyle}"
                     MinHeight="60"
                     MaxHeight="220"
                     TextWrapping="Wrap"
                     AcceptsReturn="True"
                     Margin="0,0,8,0"/>
            <Button Grid.Column="1"
                    Content="Send"
                    Command="{Binding SendCommand}"
                    Style="{StaticResource PrimaryButtonStyle}"
                    IsEnabled="{Binding CanSend}"/>
            <Button Grid.Column="2"
                    Content="Stop"
                    Command="{Binding StopCommand}"
                    Style="{StaticResource SecondaryButtonStyle}"
                    Margin="8,0,0,0"
                    IsEnabled="{Binding IsStreaming}"/>
        </Grid>
    </Grid>
</DataTemplate>

<!-- DEVELOPER RUNNER MANAGER: Full runner management + logs + process control + health monitoring -->
<DataTemplate x:Key="DeveloperRunnerManagerViewModelTemplate">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/> <!-- Main Runner Manager -->
            <ColumnDefinition Width="1*"/> <!-- Advanced Controls & Logs -->
        </Grid.ColumnDefinitions>
        
        <!-- Main Runner Manager Column -->
        <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto" Margin="0,0,8,0">
            <Grid Margin="16">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/> <!-- Header + Status -->
                    <RowDefinition Height="Auto"/> <!-- Control Bar -->
                    <RowDefinition Height="*"/>    <!-- Runner List -->
                </Grid.RowDefinitions>

                <!-- Header + Advanced Status Bar -->
                <StackPanel Grid.Row="0" Margin="0,0,0,16">
                    <!-- Header -->
                    <StackPanel Margin="0,0,0,16">
                        <TextBlock Text="🏃‍♂️ Runner Manager - Developer Mode"
                                   Style="{StaticResource HeadingLargeStyle}"
                                   Foreground="{DynamicResource AccentRedBrush}"/>
                        <TextBlock Text="Full control and monitoring of LLM backend processes"
                                   Style="{StaticResource BodyTextStyle}"
                                   Foreground="{DynamicResource TextSecondaryBrush}"
                                   Margin="0,6,0,0"/>
                    </StackPanel>

                    <!-- Advanced Status Dashboard -->
                    <Border Style="{StaticResource DarkCardStyle}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Health + Process Info -->
                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                <Ellipse Width="20" Height="20" Fill="{DynamicResource SuccessBrush}" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                <StackPanel>
                                    <TextBlock Text="{Binding ActiveRunnerName, StringFormat=Active: {0}}" Style="{StaticResource HeadingSmallStyle}" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                    <TextBlock Text="{Binding ActiveRunnerStatus}" Style="{StaticResource CaptionTextStyle}" Foreground="{DynamicResource TextSecondaryBrush}" FontFamily="Consolas" Margin="0,4,0,0"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- Performance Metrics -->
                            <StackPanel Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock Text="32 t/s" Style="{StaticResource HeadingSmallStyle}" Foreground="{DynamicResource SuccessBrush}" Margin="0,0,16,0"/>
                                    <TextBlock Text="4.2GB VRAM" Style="{StaticResource BodyTextStyle}" Margin="0,0,16,0"/>
                                    <TextBlock Text="CPU: 23%" Style="{StaticResource BodyTextStyle}"/>
                                </StackPanel>
                                <TextBlock Text="Uptime: 2h 34m • Healthy" Style="{StaticResource CaptionTextStyle}" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                            </StackPanel>

                            <!-- Network Status -->
                            <StackPanel Grid.Column="2" VerticalAlignment="Center" Margin="0,0,16,0">
                                <TextBlock Text="API Endpoint" Style="{StaticResource CaptionTextStyle}"/>
                                <TextBlock Text="localhost:8080" Style="{StaticResource CodeTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>

                            <!-- Emergency Controls -->
                            <StackPanel Grid.Column="3" Orientation="Horizontal">
                                <Button Content="🔄" Style="{StaticResource SecondaryButtonStyle}" ToolTip="Restart Runner" Width="32" Height="32" Margin="0,0,4,0"/>
                                <Button Content="🛑" Style="{StaticResource DangerButtonStyle}" ToolTip="Kill Process" Width="32" Height="32" Margin="4,0,4,0"/>
                                <Button Content="📊" Style="{StaticResource GhostButtonStyle}" ToolTip="Health Check" Width="32" Height="32" Margin="4,0,0,0"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </StackPanel>

                <!-- Advanced Control Bar -->
                <Border Grid.Row="1" Style="{StaticResource DarkCardStyle}" Margin="0,0,0,16">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Primary Controls -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <Button Content="🔄 Switch Runner" Style="{StaticResource PrimaryButtonStyle}" Margin="0,0,8,0"/>
                            <Button Content="🚀 Start" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,8,0"/>
                            <Button Content="🛑 Stop" Style="{StaticResource DangerButtonStyle}" Margin="0,0,8,0"/>
                            <Button Content="⚙️ Configure" Style="{StaticResource GhostButtonStyle}"/>
                        </StackPanel>
                        
                        <!-- Status Indicator -->
                        <StackPanel Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock Text="Ready for requests" Style="{StaticResource CaptionTextStyle}" HorizontalAlignment="Center"/>
                        </StackPanel>
                        
                        <!-- Advanced Controls -->
                        <StackPanel Grid.Column="2" Orientation="Horizontal">
                            <Button Content="📋 Logs" Style="{StaticResource GhostButtonStyle}" Margin="0,0,8,0"/>
                            <Button Content="🔧 Debug" Style="{StaticResource GhostButtonStyle}" Margin="0,0,8,0"/>
                            <Button Content="📊 Monitor" Style="{StaticResource GhostButtonStyle}"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Comprehensive Runner List -->
                <Border Grid.Row="2" Style="{StaticResource DarkCardStyle}">
                    <StackPanel>
                        <TextBlock Text="🏃‍♂️ Available Runners" Style="{StaticResource HeadingMediumStyle}" Margin="0,0,0,16"/>
                        
                        <!-- Runner List with Advanced Details (bound) -->
                        <ItemsControl ItemsSource="{Binding AvailableRunners}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="8" Padding="16,12" Margin="0,0,0,4">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Header Row -->
                                    <Grid Grid.Row="0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                                <TextBlock Grid.Column="0" Text="{Binding Icon}" FontSize="24" VerticalAlignment="Center" Margin="0,0,16,0"/>
                                        <StackPanel Grid.Column="1">
                                                    <TextBlock Text="{Binding Name}" Style="{StaticResource HeadingSmallStyle}"/>
                                                    <TextBlock Text="{Binding Description}" Style="{StaticResource BodyTextStyle}" Margin="0,4,0,0"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="2" HorizontalAlignment="Right">
                                                    <TextBlock Text="{Binding Status}" Style="{StaticResource CaptionTextStyle}" HorizontalAlignment="Right"/>
                                        </StackPanel>
                                    </Grid>
                                    
                                    <!-- Details Row -->
                                    <Grid Grid.Row="1" Margin="40,8,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="1*"/>
                                            <ColumnDefinition Width="1*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Process" Style="{StaticResource CaptionTextStyle}" FontWeight="SemiBold"/>
                                                    <TextBlock Text="PID: —" Style="{StaticResource CaptionTextStyle}" FontFamily="Consolas"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="Memory" Style="{StaticResource CaptionTextStyle}" FontWeight="SemiBold"/>
                                                    <TextBlock Text="VRAM: —" Style="{StaticResource CaptionTextStyle}"/>
                                        </StackPanel>
                                                <Button Grid.Column="2" Content="Activate" Command="{Binding DataContext.SwitchRunnerCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" Style="{StaticResource PrimaryButtonStyle}"/>
                                    </Grid>
                                </Grid>
                            </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                                        </StackPanel>
                </Border>
            </Grid>
        </ScrollViewer>
        
        <!-- Advanced Controls & Logs Column -->
        <Border Grid.Column="1" Style="{StaticResource DarkCardStyle}" Margin="8,0,0,0">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="16">
                    <TextBlock Text="🔧 Advanced Controls" Style="{StaticResource HeadingMediumStyle}" Margin="0,0,0,16"/>
                    
                    <!-- Process Monitor -->
                    <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="Process Monitor" Style="{StaticResource CaptionTextStyle}" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <TextBlock Text="llama-server.exe" Style="{StaticResource CodeTextStyle}" FontWeight="SemiBold"/>
                            <Grid Margin="0,4,0,4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="PID:" Style="{StaticResource CaptionTextStyle}" MinWidth="40"/>
                                <TextBlock Grid.Column="1" Text="15432" Style="{StaticResource CaptionTextStyle}"/>
                            </Grid>
                            <Grid Margin="0,0,0,4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="CPU:" Style="{StaticResource CaptionTextStyle}" MinWidth="40"/>
                                <TextBlock Grid.Column="1" Text="23.4%" Style="{StaticResource CaptionTextStyle}"/>
                            </Grid>
                            <Grid Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Mem:" Style="{StaticResource CaptionTextStyle}" MinWidth="40"/>
                                <TextBlock Grid.Column="1" Text="1.8GB" Style="{StaticResource CaptionTextStyle}"/>
                            </Grid>
                            <UniformGrid Columns="2">
                                <Button Content="🔄 Restart" Style="{StaticResource SecondaryButtonStyle}" Padding="6,4" Margin="0,0,4,0"/>
                                <Button Content="🛑 Kill" Style="{StaticResource DangerButtonStyle}" Padding="6,4" Margin="4,0,0,0"/>
                            </UniformGrid>
                        </StackPanel>
                    </Border>
                    
                    <!-- Live Logs -->
                    <Border Background="{DynamicResource PrimaryDarkBrush}" 
                            BorderBrush="{DynamicResource BorderBrush}" 
                            BorderThickness="1" 
                            CornerRadius="4" 
                            Padding="8" 
                            Height="200" 
                            Margin="0,0,0,16">
                        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                            <TextBlock Style="{StaticResource CodeTextStyle}" FontSize="9">
                                <Run Text="[15:23:45] INFO: Server listening on 0.0.0.0:8080" Foreground="{DynamicResource SuccessBrush}"/>
                                <LineBreak/>
                                <Run Text="[15:23:44] DEBUG: Model loaded: Qwen-2.5-32B-Q4_K_M.gguf" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <LineBreak/>
                                <Run Text="[15:23:43] INFO: GPU acceleration enabled (CUDA)" Foreground="{DynamicResource SuccessBrush}"/>
                                <LineBreak/>
                                <Run Text="[15:23:42] WARN: High VRAM usage detected (4.2GB/8GB)" Foreground="{DynamicResource WarningBrush}"/>
                                <LineBreak/>
                                <Run Text="[15:23:41] INFO: Context size set to 32768 tokens" Foreground="{DynamicResource SuccessBrush}"/>
                                <LineBreak/>
                                <Run Text="[15:23:40] DEBUG: Threads: 8, Batch: 512" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </TextBlock>
                        </ScrollViewer>
                    </Border>
                    
                    <!-- Network Diagnostics -->
                    <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="Network Diagnostics" Style="{StaticResource CaptionTextStyle}" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <TextBlock Text="Endpoint: http://localhost:8080" Style="{StaticResource CodeTextStyle}" Margin="0,0,0,4"/>
                            <TextBlock Text="Status: ✅ Healthy" Style="{StaticResource CaptionTextStyle}" Margin="0,0,0,4"/>
                            <TextBlock Text="Latency: 2ms" Style="{StaticResource CaptionTextStyle}" Margin="0,0,0,4"/>
                            <TextBlock Text="Requests: 147 total" Style="{StaticResource CaptionTextStyle}" Margin="0,0,0,8"/>
                            <Button Content="🌐 Test Connection" Style="{StaticResource GhostButtonStyle}" Padding="8,4"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Performance Tuning -->
                    <Border Background="{DynamicResource TertiaryDarkBrush}" CornerRadius="6" Padding="12">
                        <StackPanel>
                            <TextBlock Text="Performance Tuning" Style="{StaticResource CaptionTextStyle}" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <CheckBox Content="Enable GPU acceleration" IsChecked="True" Style="{StaticResource DarkCheckBoxStyle}" Margin="0,0,0,4"/>
                            <CheckBox Content="Use memory mapping" IsChecked="True" Style="{StaticResource DarkCheckBoxStyle}" Margin="0,0,0,4"/>
                            <CheckBox Content="Optimize for latency" IsChecked="False" Style="{StaticResource DarkCheckBoxStyle}" Margin="0,0,0,8"/>
                            <Slider Minimum="1" Maximum="16" Value="8" Margin="0,0,0,4"/>
                            <TextBlock Text="Threads: 8" Style="{StaticResource CaptionTextStyle}" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</DataTemplate>

<!-- Ensure file ends with closing tag -->
</ResourceDictionary>