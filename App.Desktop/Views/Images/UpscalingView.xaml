<UserControl x:Class="Lazarus.Desktop.Views.Images.UpscalingView"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 mc:Ignorable="d"
			 Background="{StaticResource PrimaryDarkBrush}">
	<Grid>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="300" MinWidth="200"/>
			<ColumnDefinition Width="*"/>
			<ColumnDefinition Width="300" MinWidth="200"/>
		</Grid.ColumnDefinitions>

		<!-- Left Panel: Upscaling Controls -->
		<Border Grid.Column="0"
				Background="{StaticResource SecondaryDarkBrush}"
				CornerRadius="8,0,0,8"
				Margin="8,8,4,8">
			<ScrollViewer VerticalScrollBarVisibility="Auto">
				<StackPanel Margin="12">
					<TextBlock Text="Upscaling"
							   Foreground="{StaticResource TextPrimaryBrush}"
							   FontSize="18"
							   FontWeight="Bold"
							   Margin="0,0,0,16"/>

					<!-- Source Image -->
					<TextBlock Text="Source Image:"
							   Foreground="{StaticResource TextPrimaryBrush}"
							   Margin="0,0,0,4"/>
					<Button Content="Load Image"
							Command="{Binding LoadImageCommand}"
							Style="{StaticResource SecondaryButtonStyle}"
							Height="32"
							Margin="0,0,0,8"/>
					
					<Border Background="{StaticResource TertiaryDarkBrush}"
							Height="150"
							CornerRadius="4"
							Margin="0,0,0,12">
						<Image Source="{Binding SourceImageSource}"
							   Stretch="Uniform"
							   Margin="4"/>
					</Border>

					<!-- Upscale Factor -->
					<TextBlock Text="Upscale Factor:"
							   Foreground="{StaticResource TextPrimaryBrush}"
							   Margin="0,0,0,4"/>
					<ComboBox SelectedValue="{Binding UpscaleFactor}"
							  Background="{StaticResource TertiaryDarkBrush}"
							  Foreground="{StaticResource TextPrimaryBrush}"
							  BorderBrush="{StaticResource BorderBrush}"
							  Margin="0,0,0,12">
						<ComboBoxItem Content="2x" Tag="2"/>
						<ComboBoxItem Content="4x" Tag="4"/>
						<ComboBoxItem Content="6x" Tag="6"/>
						<ComboBoxItem Content="8x" Tag="8"/>
					</ComboBox>

					<!-- Upscaler Model -->
					<TextBlock Text="Upscaler Model:"
							   Foreground="{StaticResource TextPrimaryBrush}"
							   Margin="0,0,0,4"/>
					<ComboBox SelectedValue="{Binding UpscalerModel}"
							  Background="{StaticResource TertiaryDarkBrush}"
							  Foreground="{StaticResource TextPrimaryBrush}"
							  BorderBrush="{StaticResource BorderBrush}"
							  Margin="0,0,0,12">
						<ComboBoxItem Content="Real-ESRGAN x4" Tag="RealESRGAN_x4plus"/>
						<ComboBoxItem Content="Real-ESRGAN x2" Tag="RealESRGAN_x2plus"/>
						<ComboBoxItem Content="ESRGAN x4" Tag="ESRGAN_4x"/>
						<ComboBoxItem Content="SwinIR x4" Tag="SwinIR_4x"/>
					</ComboBox>

					<!-- Face Enhancement -->
					<CheckBox Content="Face Enhancement"
							  IsChecked="{Binding FaceEnhancement}"
							  Foreground="{StaticResource TextPrimaryBrush}"
							  Margin="0,0,0,12"/>

					<!-- Generate Button -->
					<Button Content="Upscale"
							Command="{Binding UpscaleCommand}"
							Style="{StaticResource PrimaryButtonStyle}"
							Height="40"
							Margin="0,0,0,16"/>

					<!-- Progress -->
					<ProgressBar Value="{Binding UpscaleProgress}"
								 Minimum="0"
								 Maximum="100"
								 Height="4"
								 Background="{StaticResource TertiaryDarkBrush}"
								 Foreground="{StaticResource AccentPurpleBrush}"
								 Visibility="{Binding IsUpscaling, Converter={StaticResource BooleanToVisibilityConverter}}"/>
				</StackPanel>
			</ScrollViewer>
		</Border>

		<!-- Left Splitter -->
		<GridSplitter Grid.Column="0"
					  Width="4"
					  Background="{StaticResource BorderBrush}"
					  HorizontalAlignment="Right"
					  VerticalAlignment="Stretch"/>

		<!-- Center: Result Display -->
		<Border Grid.Column="1"
				Background="{StaticResource TertiaryDarkBrush}"
				Margin="0,8">
			<Grid>
				<TextBlock Text="Upscaled image will appear here"
						   Foreground="{StaticResource TextPrimaryBrush}"
						   HorizontalAlignment="Center"
						   VerticalAlignment="Center"
						   Visibility="{Binding HasUpscaledImage, Converter={StaticResource InverseBooleanToVisibilityConverter}}"/>
				
				<ScrollViewer HorizontalScrollBarVisibility="Auto"
							  VerticalScrollBarVisibility="Auto"
							  Visibility="{Binding HasUpscaledImage, Converter={StaticResource BooleanToVisibilityConverter}}">
					<Image Source="{Binding UpscaledImageSource}"
						   Stretch="None"/>
				</ScrollViewer>
			</Grid>
		</Border>

		<!-- Right Splitter -->
		<GridSplitter Grid.Column="1"
					  Width="4"
					  Background="{StaticResource BorderBrush}"
					  HorizontalAlignment="Right"
					  VerticalAlignment="Stretch"/>

		<!-- Right Panel: Upscaling History -->
		<Border Grid.Column="2"
				Background="{StaticResource SecondaryDarkBrush}"
				CornerRadius="0,8,8,0"
				Margin="4,8,8,8">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="*"/>
				</Grid.RowDefinitions>

				<TextBlock Grid.Row="0"
						   Text="Upscaling History"
						   Foreground="{StaticResource TextPrimaryBrush}"
						   FontSize="14"
						   FontWeight="Bold"
						   Margin="12,12,12,8"/>

				<ListBox Grid.Row="1"
						 ItemsSource="{Binding UpscalingHistory}"
						 Background="Transparent"
						 BorderThickness="0"
						 Margin="12,0">
					<ListBox.ItemTemplate>
						<DataTemplate>
							<Border Background="{StaticResource TertiaryDarkBrush}"
									CornerRadius="4"
									Margin="0,2"
									Padding="8">
								<StackPanel>
									<TextBlock Text="{Binding UpscalerModel}"
											   Foreground="{StaticResource TextPrimaryBrush}"
											   FontWeight="Bold"
											   FontSize="12"/>
									<TextBlock Text="{Binding FactorText}"
											   Foreground="{StaticResource TextPrimaryBrush}"
											   FontSize="11"/>
									<TextBlock Text="{Binding Timestamp}"
											   Foreground="{StaticResource TextSecondaryBrush}"
											   FontSize="10"
											   Margin="0,4,0,0"/>
								</StackPanel>
							</Border>
						</DataTemplate>
					</ListBox.ItemTemplate>
				</ListBox>
			</Grid>
		</Border>
	</Grid>
</UserControl>