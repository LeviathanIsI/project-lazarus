<UserControl x:Class="Lazarus.Desktop.Views.Video.MotionControlView"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 mc:Ignorable="d"
			 Background="{StaticResource PrimaryDarkBrush}">
	<Grid>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="300" MinWidth="200"/>
			<ColumnDefinition Width="*"/>
			<ColumnDefinition Width="300" MinWidth="200"/>
		</Grid.ColumnDefinitions>

		<!-- Left Panel: Motion Controls -->
		<Border Grid.Column="0"
				Background="{StaticResource SecondaryDarkBrush}"
				CornerRadius="8,0,0,8"
				Margin="8,8,4,8">
			<ScrollViewer VerticalScrollBarVisibility="Auto">
				<StackPanel Margin="12">
					<TextBlock Text="Motion Control"
							   Foreground="{StaticResource TextPrimaryBrush}"
							   FontSize="18"
							   FontWeight="Bold"
							   Margin="0,0,0,16"/>

					<!-- Camera Controls -->
					<TextBlock Text="Camera Movement"
							   Foreground="{StaticResource TextPrimaryBrush}"
							   FontSize="14"
							   FontWeight="Bold"
							   Margin="0,0,0,8"/>

					<!-- Pan X -->
					<StackPanel Orientation="Horizontal" Margin="0,0,0,12">
						<TextBlock Text="Pan X:"
								   Foreground="{StaticResource TextPrimaryBrush}"
								   Width="70"
								   VerticalAlignment="Center"/>
						<Slider Value="{Binding PanX}"
								Minimum="-1"
								Maximum="1"
								Width="150"
								VerticalAlignment="Center"
								Margin="8,0,8,0"/>
						<TextBlock Text="{Binding PanX, StringFormat=F2}"
								   Foreground="{StaticResource TextPrimaryBrush}"
								   Width="50"
								   VerticalAlignment="Center"/>
					</StackPanel>

					<!-- Pan Y -->
					<StackPanel Orientation="Horizontal" Margin="0,0,0,12">
						<TextBlock Text="Pan Y:"
								   Foreground="{StaticResource TextPrimaryBrush}"
								   Width="70"
								   VerticalAlignment="Center"/>
						<Slider Value="{Binding PanY}"
								Minimum="-1"
								Maximum="1"
								Width="150"
								VerticalAlignment="Center"
								Margin="8,0,8,0"/>
						<TextBlock Text="{Binding PanY, StringFormat=F2}"
								   Foreground="{StaticResource TextPrimaryBrush}"
								   Width="50"
								   VerticalAlignment="Center"/>
					</StackPanel>

					<!-- Zoom -->
					<StackPanel Orientation="Horizontal" Margin="0,0,0,12">
						<TextBlock Text="Zoom:"
								   Foreground="{StaticResource TextPrimaryBrush}"
								   Width="70"
								   VerticalAlignment="Center"/>
						<Slider Value="{Binding Zoom}"
								Minimum="0.5"
								Maximum="2.0"
								Width="150"
								VerticalAlignment="Center"
								Margin="8,0,8,0"/>
						<TextBlock Text="{Binding Zoom, StringFormat='F2x'}"
								   Foreground="{StaticResource TextPrimaryBrush}"
								   Width="50"
								   VerticalAlignment="Center"/>
					</StackPanel>

					<!-- Rotation -->
					<StackPanel Orientation="Horizontal" Margin="0,0,0,16">
						<TextBlock Text="Rotate:"
								   Foreground="{StaticResource TextPrimaryBrush}"
								   Width="70"
								   VerticalAlignment="Center"/>
						<Slider Value="{Binding Rotation}"
								Minimum="-180"
								Maximum="180"
								Width="150"
								VerticalAlignment="Center"
								Margin="8,0,8,0"/>
						<TextBlock Text="{Binding Rotation, StringFormat='F0°'}"
								   Foreground="{StaticResource TextPrimaryBrush}"
								   Width="50"
								   VerticalAlignment="Center"/>
					</StackPanel>

					<!-- Object Tracking -->
					<TextBlock Text="Object Tracking"
							   Foreground="{StaticResource TextPrimaryBrush}"
							   FontSize="14"
							   FontWeight="Bold"
							   Margin="0,0,0,8"/>

					<CheckBox Content="Enable Object Tracking"
							  IsChecked="{Binding EnableObjectTracking}"
							  Foreground="{StaticResource TextPrimaryBrush}"
							  Margin="0,0,0,10"/>

					<TextBox Text="{Binding TrackingPrompt}"
							 Height="60"
							 TextWrapping="Wrap"
							 AcceptsReturn="True"
							 Background="{StaticResource TertiaryDarkBrush}"
							 Foreground="{StaticResource TextPrimaryBrush}"
							 BorderBrush="{StaticResource BorderBrush}"
							 Margin="0,0,0,16"
							 IsEnabled="{Binding EnableObjectTracking}"/>

					<!-- Motion Smoothing -->
					<TextBlock Text="Motion Smoothing"
							   Foreground="{StaticResource TextPrimaryBrush}"
							   FontSize="14"
							   FontWeight="Bold"
							   Margin="0,0,0,8"/>

					<StackPanel Orientation="Horizontal" Margin="0,0,0,12">
						<TextBlock Text="Smoothing:"
								   Foreground="{StaticResource TextPrimaryBrush}"
								   Width="80"
								   VerticalAlignment="Center"/>
						<Slider Value="{Binding MotionSmoothing}"
								Minimum="0"
								Maximum="1"
								Width="140"
								VerticalAlignment="Center"
								Margin="8,0,8,0"/>
						<TextBlock Text="{Binding MotionSmoothing, StringFormat=F2}"
								   Foreground="{StaticResource TextPrimaryBrush}"
								   Width="50"
								   VerticalAlignment="Center"/>
					</StackPanel>

					<!-- Generate Button -->
					<Button Content="Apply Motion"
							Command="{Binding ApplyMotionCommand}"
							Style="{StaticResource PrimaryButtonStyle}"
							Height="40"
							Margin="0,16,0,0"/>
				</StackPanel>
			</ScrollViewer>
		</Border>

		<!-- Left Splitter -->
		<GridSplitter Grid.Column="0"
					  Width="4"
					  Background="{StaticResource BorderBrush}"
					  HorizontalAlignment="Right"
					  VerticalAlignment="Stretch"/>

		<!-- Center: Motion Preview -->
		<Border Grid.Column="1"
				Background="{StaticResource TertiaryDarkBrush}"
				Margin="0,8">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="*"/>
					<RowDefinition Height="Auto"/>
				</Grid.RowDefinitions>

				<TextBlock Grid.Row="0"
						   Text="Motion Preview"
						   Foreground="{StaticResource TextPrimaryBrush}"
						   FontSize="16"
						   FontWeight="Bold"
						   HorizontalAlignment="Center"
						   Margin="0,12,0,12"/>

				<!-- Motion Visualization -->
				<Border Grid.Row="1"
						Background="#2a2a2a"
						Margin="20"
						CornerRadius="8">
					<Canvas x:Name="MotionCanvas"
							Background="Transparent">
						<!-- Motion Path Visualization -->
						<Path Stroke="#4f46e5"
							  StrokeThickness="2"
							  Data="{Binding MotionPath}"
							  Visibility="{Binding HasMotionPath, Converter={StaticResource BooleanToVisibilityConverter}}"/>
						
						<!-- Center Point -->
						<Ellipse Fill="#ef4444"
								 Width="8"
								 Height="8"
								 Canvas.Left="200"
								 Canvas.Top="150"/>
						
						<TextBlock Text="Motion visualization will appear here"
								   Foreground="{StaticResource TextSecondaryBrush}"
								   HorizontalAlignment="Center"
								   VerticalAlignment="Center"
								   Canvas.Left="100"
								   Canvas.Top="150"
								   Visibility="{Binding HasMotionPath, Converter={StaticResource InverseBooleanToVisibilityConverter}}"/>
					</Canvas>
				</Border>

				<!-- Timeline Controls -->
				<StackPanel Grid.Row="2"
							Orientation="Horizontal"
							HorizontalAlignment="Center"
							Margin="0,0,0,12">
					<TextBlock Text="Timeline:"
							   Foreground="{StaticResource TextPrimaryBrush}"
							   VerticalAlignment="Center"
							   Margin="0,0,8,0"/>
					<Slider Value="{Binding TimelinePosition}"
							Minimum="0"
							Maximum="100"
							Width="300"
							VerticalAlignment="Center"/>
					<Button Content="▶"
							Command="{Binding PreviewMotionCommand}"
							Style="{StaticResource SecondaryButtonStyle}"
							Width="32"
							Height="28"
							Margin="8,0,0,0"/>
				</StackPanel>

				<!-- Progress -->
				<StackPanel HorizontalAlignment="Center"
							VerticalAlignment="Bottom"
							Margin="0,0,0,60"
							Visibility="{Binding IsProcessing, Converter={StaticResource BooleanToVisibilityConverter}}">
					<ProgressBar IsIndeterminate="True"
								 Height="4"
								 Width="300"/>
					<TextBlock Text="{Binding ProcessingStatus}"
							   Foreground="{StaticResource TextPrimaryBrush}"
							   HorizontalAlignment="Center"
							   Margin="0,8,0,0"/>
				</StackPanel>
			</Grid>
		</Border>

		<!-- Right Splitter -->
		<GridSplitter Grid.Column="1"
					  Width="4"
					  Background="{StaticResource BorderBrush}"
					  HorizontalAlignment="Right"
					  VerticalAlignment="Stretch"/>

		<!-- Right Panel: Motion Presets -->
		<Border Grid.Column="2"
				Background="{StaticResource SecondaryDarkBrush}"
				CornerRadius="0,8,8,0"
				Margin="4,8,8,8">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="*"/>
				</Grid.RowDefinitions>

				<TextBlock Grid.Row="0"
						   Text="Motion Presets"
						   Foreground="{StaticResource TextPrimaryBrush}"
						   FontSize="14"
						   FontWeight="Bold"
						   Margin="12,12,12,8"/>

				<ListBox Grid.Row="1"
						 ItemsSource="{Binding MotionPresets}"
						 Background="Transparent"
						 BorderThickness="0"
						 Margin="12,0">
					<ListBox.ItemTemplate>
						<DataTemplate>
							<Border Background="{StaticResource TertiaryDarkBrush}"
									CornerRadius="4"
									Margin="0,2"
									Padding="8">
								<StackPanel>
									<TextBlock Text="{Binding Name}"
											   Foreground="{StaticResource TextPrimaryBrush}"
											   FontSize="12"
											   FontWeight="Bold"/>
									<TextBlock Text="{Binding Description}"
											   Foreground="{StaticResource TextSecondaryBrush}"
											   TextWrapping="Wrap"
											   FontSize="10"
											   Margin="0,2,0,0"/>
									<Button Content="Apply"
											Command="{Binding DataContext.ApplyPresetCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
											CommandParameter="{Binding}"
											Style="{StaticResource SecondaryButtonStyle}"
											Height="25"
											Margin="0,4,0,0"/>
								</StackPanel>
							</Border>
						</DataTemplate>
					</ListBox.ItemTemplate>
				</ListBox>
			</Grid>
		</Border>
	</Grid>
</UserControl>