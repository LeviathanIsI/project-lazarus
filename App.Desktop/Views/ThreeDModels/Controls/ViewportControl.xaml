<UserControl x:Class="Lazarus.Desktop.Views.ThreeDModels.Controls.ViewportControl"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 mc:Ignorable="d"
			 Background="{DynamicResource SecondaryDarkBrush}">

	<Grid>
		<!-- Native WPF 3D Viewport -->
		<Viewport3D x:Name="MainViewport">
			<!-- Camera -->
			<Viewport3D.Camera>
				<PerspectiveCamera x:Name="Camera"
								   Position="{Binding CameraPosition}"
								   LookDirection="{Binding CameraLookDirection}"
								   UpDirection="0,1,0"
								   FieldOfView="45"/>
			</Viewport3D.Camera>

			<!-- Lighting -->
			<ModelVisual3D>
				<ModelVisual3D.Content>
					<Model3DGroup>
						<!-- Main directional light -->
						<DirectionalLight Color="White"
										  Direction="-1,-1,-1"/>
						<!-- Fill light -->
						<DirectionalLight Color="#666666"
										  Direction="1,1,1"/>
						<!-- Ambient -->
						<AmbientLight Color="#333333"/>
					</Model3DGroup>
				</ModelVisual3D.Content>
			</ModelVisual3D>

			<!-- Model Container -->
			<ModelVisual3D x:Name="ModelContainer">
				<ModelVisual3D.Content>
					<Model3DGroup x:Name="ModelGroup"/>
				</ModelVisual3D.Content>
			</ModelVisual3D>

			<!-- Grid Floor -->
			<ModelVisual3D x:Name="GridVisual">
				<ModelVisual3D.Content>
					<GeometryModel3D x:Name="GridModel">
						<GeometryModel3D.Material>
							<DiffuseMaterial Brush="#444444"/>
						</GeometryModel3D.Material>
						<GeometryModel3D.Geometry>
							<MeshGeometry3D x:Name="GridGeometry"/>
						</GeometryModel3D.Geometry>
					</GeometryModel3D>
				</ModelVisual3D.Content>
			</ModelVisual3D>
		</Viewport3D>

		<!-- Mouse interaction overlay -->
		<Border x:Name="InteractionSurface"
				Background="Transparent"
				MouseLeftButtonDown="OnMouseLeftButtonDown"
				MouseMove="OnMouseMove"
				MouseLeftButtonUp="OnMouseLeftButtonUp"
				MouseRightButtonDown="OnMouseRightButtonDown"
				MouseRightButtonUp="OnMouseRightButtonUp"
				MouseWheel="OnMouseWheel"/>

		<!-- Viewport Controls -->
		<Grid>
			<!-- Top-left: View controls -->
			<StackPanel Orientation="Horizontal"
						HorizontalAlignment="Left"
						VerticalAlignment="Top"
						Margin="12">
				<StackPanel.Resources>
					<Style TargetType="Button"
						   BasedOn="{StaticResource GhostButtonStyle}">
						<Setter Property="Padding"
								Value="8,4"/>
						<Setter Property="Margin"
								Value="2"/>
						<Setter Property="FontSize"
								Value="11"/>
						<Setter Property="Background"
								Value="{DynamicResource TertiaryDarkBrush}"/>
						<Setter Property="Opacity"
								Value="0.8"/>
						<Style.Triggers>
							<Trigger Property="IsMouseOver"
									 Value="True">
								<Setter Property="Opacity"
										Value="1.0"/>
							</Trigger>
						</Style.Triggers>
					</Style>
				</StackPanel.Resources>

				<Button Content="Wireframe"
						Command="{Binding SetRenderModeCommand}"
						CommandParameter="Wireframe"/>
				<Button Content="Solid"
						Command="{Binding SetRenderModeCommand}"
						CommandParameter="Solid"/>
				<Button Content="Reset View"
						Command="{Binding ResetCameraCommand}"/>
			</StackPanel>

			<!-- Top-right: Settings -->
			<StackPanel Orientation="Horizontal"
						HorizontalAlignment="Right"
						VerticalAlignment="Top"
						Margin="12">
				<StackPanel.Resources>
					<Style TargetType="Button"
						   BasedOn="{StaticResource GhostButtonStyle}">
						<Setter Property="Padding"
								Value="8,4"/>
						<Setter Property="Margin"
								Value="2"/>
						<Setter Property="FontSize"
								Value="11"/>
						<Setter Property="Background"
								Value="{DynamicResource TertiaryDarkBrush}"/>
						<Setter Property="Opacity"
								Value="0.8"/>
						<Style.Triggers>
							<Trigger Property="IsMouseOver"
									 Value="True">
								<Setter Property="Opacity"
										Value="1.0"/>
							</Trigger>
						</Style.Triggers>
					</Style>
				</StackPanel.Resources>

				<Button Content="Grid"
						Command="{Binding ToggleGridCommand}"/>
			</StackPanel>

			<!-- Bottom-left: Controls help -->
			<Border HorizontalAlignment="Left"
					VerticalAlignment="Bottom"
					Margin="12"
					Background="{DynamicResource TertiaryDarkBrush}"
					Padding="8,4"
					CornerRadius="4"
					Opacity="0.7">
				<TextBlock Foreground="{DynamicResource TextPrimaryBrush}"
						   FontSize="10"
						   Text="Left: Orbit | Right: Pan | Wheel: Zoom"/>
			</Border>

			<!-- Center: Empty state -->
			<StackPanel HorizontalAlignment="Center"
						VerticalAlignment="Center"
						Visibility="{Binding HasModel, Converter={StaticResource InvertBool}}">
				<TextBlock Text="ðŸŽ¯"
						   FontSize="48"
						   HorizontalAlignment="Center"
						   Foreground="{DynamicResource TextMutedBrush}"
						   TextAlignment="Center"/>
				<TextBlock Text="No Model Selected"
						   Style="{StaticResource HeadingMediumStyle}"
						   HorizontalAlignment="Center"
						   Foreground="{DynamicResource TextMutedBrush}"
						   Margin="0,12,0,4"
						   TextAlignment="Center"/>
				<TextBlock Text="Select a model from the library to preview"
						   Style="{StaticResource CaptionTextStyle}"
						   HorizontalAlignment="Center"
						   Foreground="{DynamicResource TextMutedBrush}"
						   TextAlignment="Center"/>
			</StackPanel>
		</Grid>
	</Grid>
</UserControl>